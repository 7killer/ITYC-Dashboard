{"version":3,"file":"background.js","sources":["../../node_modules/.pnpm/property-expr@2.0.6/node_modules/property-expr/index.js","../../node_modules/.pnpm/tiny-case@1.0.3/node_modules/tiny-case/index.js","../../node_modules/.pnpm/toposort@2.0.2/node_modules/toposort/index.js","../../node_modules/.pnpm/yup@1.7.0/node_modules/yup/index.esm.js","../../src/background/data/ingesterModels/accountDetails.js","../../src/background/data/ingesterModels/getLegList.js","../../src/background/data/ingesterModels/datasModel.js","../../src/background/data/ingesterModels/getEndLegPrep.js","../../src/background/data/ingesterModels/getBoatInfos.js","../../src/background/data/ingesterModels/getGameSettings.js","../../src/background/data/ingesterModels/boatAction.js","../../src/background/data/ingesterModels/getFleet.js","../../src/background/data/ingesterModels/polar.js","../../src/background/data/msgIngestDef.js","../../src/polar/utils.js","../../src/background/iteRun.js","../../src/dashboard/ui/embeddedToolbar.js","../../src/background/dashState.js","../../src/background/worker.js"],"sourcesContent":["/**\n * Based on Kendo UI Core expression code <https://github.com/telerik/kendo-ui-core#license-information>\n */\n'use strict'\n\nfunction Cache(maxSize) {\n  this._maxSize = maxSize\n  this.clear()\n}\nCache.prototype.clear = function () {\n  this._size = 0\n  this._values = Object.create(null)\n}\nCache.prototype.get = function (key) {\n  return this._values[key]\n}\nCache.prototype.set = function (key, value) {\n  this._size >= this._maxSize && this.clear()\n  if (!(key in this._values)) this._size++\n\n  return (this._values[key] = value)\n}\n\nvar SPLIT_REGEX = /[^.^\\]^[]+|(?=\\[\\]|\\.\\.)/g,\n  DIGIT_REGEX = /^\\d+$/,\n  LEAD_DIGIT_REGEX = /^\\d/,\n  SPEC_CHAR_REGEX = /[~`!#$%\\^&*+=\\-\\[\\]\\\\';,/{}|\\\\\":<>\\?]/g,\n  CLEAN_QUOTES_REGEX = /^\\s*(['\"]?)(.*?)(\\1)\\s*$/,\n  MAX_CACHE_SIZE = 512\n\nvar pathCache = new Cache(MAX_CACHE_SIZE),\n  setCache = new Cache(MAX_CACHE_SIZE),\n  getCache = new Cache(MAX_CACHE_SIZE)\n\nvar config\n\nmodule.exports = {\n  Cache: Cache,\n\n  split: split,\n\n  normalizePath: normalizePath,\n\n  setter: function (path) {\n    var parts = normalizePath(path)\n\n    return (\n      setCache.get(path) ||\n      setCache.set(path, function setter(obj, value) {\n        var index = 0\n        var len = parts.length\n        var data = obj\n\n        while (index < len - 1) {\n          var part = parts[index]\n          if (\n            part === '__proto__' ||\n            part === 'constructor' ||\n            part === 'prototype'\n          ) {\n            return obj\n          }\n\n          data = data[parts[index++]]\n        }\n        data[parts[index]] = value\n      })\n    )\n  },\n\n  getter: function (path, safe) {\n    var parts = normalizePath(path)\n    return (\n      getCache.get(path) ||\n      getCache.set(path, function getter(data) {\n        var index = 0,\n          len = parts.length\n        while (index < len) {\n          if (data != null || !safe) data = data[parts[index++]]\n          else return\n        }\n        return data\n      })\n    )\n  },\n\n  join: function (segments) {\n    return segments.reduce(function (path, part) {\n      return (\n        path +\n        (isQuoted(part) || DIGIT_REGEX.test(part)\n          ? '[' + part + ']'\n          : (path ? '.' : '') + part)\n      )\n    }, '')\n  },\n\n  forEach: function (path, cb, thisArg) {\n    forEach(Array.isArray(path) ? path : split(path), cb, thisArg)\n  },\n}\n\nfunction normalizePath(path) {\n  return (\n    pathCache.get(path) ||\n    pathCache.set(\n      path,\n      split(path).map(function (part) {\n        return part.replace(CLEAN_QUOTES_REGEX, '$2')\n      })\n    )\n  )\n}\n\nfunction split(path) {\n  return path.match(SPLIT_REGEX) || ['']\n}\n\nfunction forEach(parts, iter, thisArg) {\n  var len = parts.length,\n    part,\n    idx,\n    isArray,\n    isBracket\n\n  for (idx = 0; idx < len; idx++) {\n    part = parts[idx]\n\n    if (part) {\n      if (shouldBeQuoted(part)) {\n        part = '\"' + part + '\"'\n      }\n\n      isBracket = isQuoted(part)\n      isArray = !isBracket && /^\\d+$/.test(part)\n\n      iter.call(thisArg, part, isBracket, isArray, idx, parts)\n    }\n  }\n}\n\nfunction isQuoted(str) {\n  return (\n    typeof str === 'string' && str && [\"'\", '\"'].indexOf(str.charAt(0)) !== -1\n  )\n}\n\nfunction hasLeadingNumber(part) {\n  return part.match(LEAD_DIGIT_REGEX) && !part.match(DIGIT_REGEX)\n}\n\nfunction hasSpecialChars(part) {\n  return SPEC_CHAR_REGEX.test(part)\n}\n\nfunction shouldBeQuoted(part) {\n  return !isQuoted(part) && (hasLeadingNumber(part) || hasSpecialChars(part))\n}\n","const reWords = /[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde]|$)|(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde](?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])|$)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?(?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])|\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])|\\d+|(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?)*/g\n\nconst words = (str) => str.match(reWords) || []\n\nconst upperFirst = (str) => str[0].toUpperCase() + str.slice(1)\n\nconst join = (str, d) => words(str).join(d).toLowerCase()\n\nconst camelCase = (str) =>\n  words(str).reduce(\n    (acc, next) =>\n      `${acc}${\n        !acc\n          ? next.toLowerCase()\n          : next[0].toUpperCase() + next.slice(1).toLowerCase()\n      }`,\n    '',\n  )\n\nconst pascalCase = (str) => upperFirst(camelCase(str))\n\nconst snakeCase = (str) => join(str, '_')\n\nconst kebabCase = (str) => join(str, '-')\n\nconst sentenceCase = (str) => upperFirst(join(str, ' '))\n\nconst titleCase = (str) => words(str).map(upperFirst).join(' ')\n\nmodule.exports = {\n  words,\n  upperFirst,\n  camelCase,\n  pascalCase,\n  snakeCase,\n  kebabCase,\n  sentenceCase,\n  titleCase,\n}\n","\n/**\n * Topological sorting function\n *\n * @param {Array} edges\n * @returns {Array}\n */\n\nmodule.exports = function(edges) {\n  return toposort(uniqueNodes(edges), edges)\n}\n\nmodule.exports.array = toposort\n\nfunction toposort(nodes, edges) {\n  var cursor = nodes.length\n    , sorted = new Array(cursor)\n    , visited = {}\n    , i = cursor\n    // Better data structures make algorithm much faster.\n    , outgoingEdges = makeOutgoingEdges(edges)\n    , nodesHash = makeNodesHash(nodes)\n\n  // check for unknown nodes\n  edges.forEach(function(edge) {\n    if (!nodesHash.has(edge[0]) || !nodesHash.has(edge[1])) {\n      throw new Error('Unknown node. There is an unknown node in the supplied edges.')\n    }\n  })\n\n  while (i--) {\n    if (!visited[i]) visit(nodes[i], i, new Set())\n  }\n\n  return sorted\n\n  function visit(node, i, predecessors) {\n    if(predecessors.has(node)) {\n      var nodeRep\n      try {\n        nodeRep = \", node was:\" + JSON.stringify(node)\n      } catch(e) {\n        nodeRep = \"\"\n      }\n      throw new Error('Cyclic dependency' + nodeRep)\n    }\n\n    if (!nodesHash.has(node)) {\n      throw new Error('Found unknown node. Make sure to provided all involved nodes. Unknown node: '+JSON.stringify(node))\n    }\n\n    if (visited[i]) return;\n    visited[i] = true\n\n    var outgoing = outgoingEdges.get(node) || new Set()\n    outgoing = Array.from(outgoing)\n\n    if (i = outgoing.length) {\n      predecessors.add(node)\n      do {\n        var child = outgoing[--i]\n        visit(child, nodesHash.get(child), predecessors)\n      } while (i)\n      predecessors.delete(node)\n    }\n\n    sorted[--cursor] = node\n  }\n}\n\nfunction uniqueNodes(arr){\n  var res = new Set()\n  for (var i = 0, len = arr.length; i < len; i++) {\n    var edge = arr[i]\n    res.add(edge[0])\n    res.add(edge[1])\n  }\n  return Array.from(res)\n}\n\nfunction makeOutgoingEdges(arr){\n  var edges = new Map()\n  for (var i = 0, len = arr.length; i < len; i++) {\n    var edge = arr[i]\n    if (!edges.has(edge[0])) edges.set(edge[0], new Set())\n    if (!edges.has(edge[1])) edges.set(edge[1], new Set())\n    edges.get(edge[0]).add(edge[1])\n  }\n  return edges\n}\n\nfunction makeNodesHash(arr){\n  var res = new Map()\n  for (var i = 0, len = arr.length; i < len; i++) {\n    res.set(arr[i], i)\n  }\n  return res\n}\n","import { getter, forEach, split, normalizePath, join } from 'property-expr';\nimport { camelCase, snakeCase } from 'tiny-case';\nimport toposort from 'toposort';\n\nconst toString = Object.prototype.toString;\nconst errorToString = Error.prototype.toString;\nconst regExpToString = RegExp.prototype.toString;\nconst symbolToString = typeof Symbol !== 'undefined' ? Symbol.prototype.toString : () => '';\nconst SYMBOL_REGEXP = /^Symbol\\((.*)\\)(.*)$/;\nfunction printNumber(val) {\n  if (val != +val) return 'NaN';\n  const isNegativeZero = val === 0 && 1 / val < 0;\n  return isNegativeZero ? '-0' : '' + val;\n}\nfunction printSimpleValue(val, quoteStrings = false) {\n  if (val == null || val === true || val === false) return '' + val;\n  const typeOf = typeof val;\n  if (typeOf === 'number') return printNumber(val);\n  if (typeOf === 'string') return quoteStrings ? `\"${val}\"` : val;\n  if (typeOf === 'function') return '[Function ' + (val.name || 'anonymous') + ']';\n  if (typeOf === 'symbol') return symbolToString.call(val).replace(SYMBOL_REGEXP, 'Symbol($1)');\n  const tag = toString.call(val).slice(8, -1);\n  if (tag === 'Date') return isNaN(val.getTime()) ? '' + val : val.toISOString(val);\n  if (tag === 'Error' || val instanceof Error) return '[' + errorToString.call(val) + ']';\n  if (tag === 'RegExp') return regExpToString.call(val);\n  return null;\n}\nfunction printValue(value, quoteStrings) {\n  let result = printSimpleValue(value, quoteStrings);\n  if (result !== null) return result;\n  return JSON.stringify(value, function (key, value) {\n    let result = printSimpleValue(this[key], quoteStrings);\n    if (result !== null) return result;\n    return value;\n  }, 2);\n}\n\nfunction toArray(value) {\n  return value == null ? [] : [].concat(value);\n}\n\nlet _Symbol$toStringTag, _Symbol$hasInstance, _Symbol$toStringTag2;\nlet strReg = /\\$\\{\\s*(\\w+)\\s*\\}/g;\n_Symbol$toStringTag = Symbol.toStringTag;\nclass ValidationErrorNoStack {\n  constructor(errorOrErrors, value, field, type) {\n    this.name = void 0;\n    this.message = void 0;\n    this.value = void 0;\n    this.path = void 0;\n    this.type = void 0;\n    this.params = void 0;\n    this.errors = void 0;\n    this.inner = void 0;\n    this[_Symbol$toStringTag] = 'Error';\n    this.name = 'ValidationError';\n    this.value = value;\n    this.path = field;\n    this.type = type;\n    this.errors = [];\n    this.inner = [];\n    toArray(errorOrErrors).forEach(err => {\n      if (ValidationError.isError(err)) {\n        this.errors.push(...err.errors);\n        const innerErrors = err.inner.length ? err.inner : [err];\n        this.inner.push(...innerErrors);\n      } else {\n        this.errors.push(err);\n      }\n    });\n    this.message = this.errors.length > 1 ? `${this.errors.length} errors occurred` : this.errors[0];\n  }\n}\n_Symbol$hasInstance = Symbol.hasInstance;\n_Symbol$toStringTag2 = Symbol.toStringTag;\nclass ValidationError extends Error {\n  static formatError(message, params) {\n    // Attempt to make the path more friendly for error message interpolation.\n    const path = params.label || params.path || 'this';\n    // Store the original path under `originalPath` so it isn't lost to custom\n    // message functions; e.g., ones provided in `setLocale()` calls.\n    params = Object.assign({}, params, {\n      path,\n      originalPath: params.path\n    });\n    if (typeof message === 'string') return message.replace(strReg, (_, key) => printValue(params[key]));\n    if (typeof message === 'function') return message(params);\n    return message;\n  }\n  static isError(err) {\n    return err && err.name === 'ValidationError';\n  }\n  constructor(errorOrErrors, value, field, type, disableStack) {\n    const errorNoStack = new ValidationErrorNoStack(errorOrErrors, value, field, type);\n    if (disableStack) {\n      return errorNoStack;\n    }\n    super();\n    this.value = void 0;\n    this.path = void 0;\n    this.type = void 0;\n    this.params = void 0;\n    this.errors = [];\n    this.inner = [];\n    this[_Symbol$toStringTag2] = 'Error';\n    this.name = errorNoStack.name;\n    this.message = errorNoStack.message;\n    this.type = errorNoStack.type;\n    this.value = errorNoStack.value;\n    this.path = errorNoStack.path;\n    this.errors = errorNoStack.errors;\n    this.inner = errorNoStack.inner;\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ValidationError);\n    }\n  }\n  static [_Symbol$hasInstance](inst) {\n    return ValidationErrorNoStack[Symbol.hasInstance](inst) || super[Symbol.hasInstance](inst);\n  }\n}\n\nlet mixed = {\n  default: '${path} is invalid',\n  required: '${path} is a required field',\n  defined: '${path} must be defined',\n  notNull: '${path} cannot be null',\n  oneOf: '${path} must be one of the following values: ${values}',\n  notOneOf: '${path} must not be one of the following values: ${values}',\n  notType: ({\n    path,\n    type,\n    value,\n    originalValue\n  }) => {\n    const castMsg = originalValue != null && originalValue !== value ? ` (cast from the value \\`${printValue(originalValue, true)}\\`).` : '.';\n    return type !== 'mixed' ? `${path} must be a \\`${type}\\` type, ` + `but the final value was: \\`${printValue(value, true)}\\`` + castMsg : `${path} must match the configured type. ` + `The validated value was: \\`${printValue(value, true)}\\`` + castMsg;\n  }\n};\nlet string = {\n  length: '${path} must be exactly ${length} characters',\n  min: '${path} must be at least ${min} characters',\n  max: '${path} must be at most ${max} characters',\n  matches: '${path} must match the following: \"${regex}\"',\n  email: '${path} must be a valid email',\n  url: '${path} must be a valid URL',\n  uuid: '${path} must be a valid UUID',\n  datetime: '${path} must be a valid ISO date-time',\n  datetime_precision: '${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits',\n  datetime_offset: '${path} must be a valid ISO date-time with UTC \"Z\" timezone',\n  trim: '${path} must be a trimmed string',\n  lowercase: '${path} must be a lowercase string',\n  uppercase: '${path} must be a upper case string'\n};\nlet number = {\n  min: '${path} must be greater than or equal to ${min}',\n  max: '${path} must be less than or equal to ${max}',\n  lessThan: '${path} must be less than ${less}',\n  moreThan: '${path} must be greater than ${more}',\n  positive: '${path} must be a positive number',\n  negative: '${path} must be a negative number',\n  integer: '${path} must be an integer'\n};\nlet date = {\n  min: '${path} field must be later than ${min}',\n  max: '${path} field must be at earlier than ${max}'\n};\nlet boolean = {\n  isValue: '${path} field must be ${value}'\n};\nlet object = {\n  noUnknown: '${path} field has unspecified keys: ${unknown}',\n  exact: '${path} object contains unknown properties: ${properties}'\n};\nlet array = {\n  min: '${path} field must have at least ${min} items',\n  max: '${path} field must have less than or equal to ${max} items',\n  length: '${path} must have ${length} items'\n};\nlet tuple = {\n  notType: params => {\n    const {\n      path,\n      value,\n      spec\n    } = params;\n    const typeLen = spec.types.length;\n    if (Array.isArray(value)) {\n      if (value.length < typeLen) return `${path} tuple value has too few items, expected a length of ${typeLen} but got ${value.length} for value: \\`${printValue(value, true)}\\``;\n      if (value.length > typeLen) return `${path} tuple value has too many items, expected a length of ${typeLen} but got ${value.length} for value: \\`${printValue(value, true)}\\``;\n    }\n    return ValidationError.formatError(mixed.notType, params);\n  }\n};\nvar locale = Object.assign(Object.create(null), {\n  mixed,\n  string,\n  number,\n  date,\n  object,\n  array,\n  boolean,\n  tuple\n});\n\nconst isSchema = obj => obj && obj.__isYupSchema__;\n\nclass Condition {\n  static fromOptions(refs, config) {\n    if (!config.then && !config.otherwise) throw new TypeError('either `then:` or `otherwise:` is required for `when()` conditions');\n    let {\n      is,\n      then,\n      otherwise\n    } = config;\n    let check = typeof is === 'function' ? is : (...values) => values.every(value => value === is);\n    return new Condition(refs, (values, schema) => {\n      var _branch;\n      let branch = check(...values) ? then : otherwise;\n      return (_branch = branch == null ? void 0 : branch(schema)) != null ? _branch : schema;\n    });\n  }\n  constructor(refs, builder) {\n    this.fn = void 0;\n    this.refs = refs;\n    this.refs = refs;\n    this.fn = builder;\n  }\n  resolve(base, options) {\n    let values = this.refs.map(ref =>\n    // TODO: ? operator here?\n    ref.getValue(options == null ? void 0 : options.value, options == null ? void 0 : options.parent, options == null ? void 0 : options.context));\n    let schema = this.fn(values, base, options);\n    if (schema === undefined ||\n    // @ts-ignore this can be base\n    schema === base) {\n      return base;\n    }\n    if (!isSchema(schema)) throw new TypeError('conditions must return a schema object');\n    return schema.resolve(options);\n  }\n}\n\nconst prefixes = {\n  context: '$',\n  value: '.'\n};\nfunction create$9(key, options) {\n  return new Reference(key, options);\n}\nclass Reference {\n  constructor(key, options = {}) {\n    this.key = void 0;\n    this.isContext = void 0;\n    this.isValue = void 0;\n    this.isSibling = void 0;\n    this.path = void 0;\n    this.getter = void 0;\n    this.map = void 0;\n    if (typeof key !== 'string') throw new TypeError('ref must be a string, got: ' + key);\n    this.key = key.trim();\n    if (key === '') throw new TypeError('ref must be a non-empty string');\n    this.isContext = this.key[0] === prefixes.context;\n    this.isValue = this.key[0] === prefixes.value;\n    this.isSibling = !this.isContext && !this.isValue;\n    let prefix = this.isContext ? prefixes.context : this.isValue ? prefixes.value : '';\n    this.path = this.key.slice(prefix.length);\n    this.getter = this.path && getter(this.path, true);\n    this.map = options.map;\n  }\n  getValue(value, parent, context) {\n    let result = this.isContext ? context : this.isValue ? value : parent;\n    if (this.getter) result = this.getter(result || {});\n    if (this.map) result = this.map(result);\n    return result;\n  }\n\n  /**\n   *\n   * @param {*} value\n   * @param {Object} options\n   * @param {Object=} options.context\n   * @param {Object=} options.parent\n   */\n  cast(value, options) {\n    return this.getValue(value, options == null ? void 0 : options.parent, options == null ? void 0 : options.context);\n  }\n  resolve() {\n    return this;\n  }\n  describe() {\n    return {\n      type: 'ref',\n      key: this.key\n    };\n  }\n  toString() {\n    return `Ref(${this.key})`;\n  }\n  static isRef(value) {\n    return value && value.__isYupRef;\n  }\n}\n\n// @ts-ignore\nReference.prototype.__isYupRef = true;\n\nconst isAbsent = value => value == null;\n\nfunction createValidation(config) {\n  function validate({\n    value,\n    path = '',\n    options,\n    originalValue,\n    schema\n  }, panic, next) {\n    const {\n      name,\n      test,\n      params,\n      message,\n      skipAbsent\n    } = config;\n    let {\n      parent,\n      context,\n      abortEarly = schema.spec.abortEarly,\n      disableStackTrace = schema.spec.disableStackTrace\n    } = options;\n    const resolveOptions = {\n      value,\n      parent,\n      context\n    };\n    function createError(overrides = {}) {\n      const nextParams = resolveParams(Object.assign({\n        value,\n        originalValue,\n        label: schema.spec.label,\n        path: overrides.path || path,\n        spec: schema.spec,\n        disableStackTrace: overrides.disableStackTrace || disableStackTrace\n      }, params, overrides.params), resolveOptions);\n      const error = new ValidationError(ValidationError.formatError(overrides.message || message, nextParams), value, nextParams.path, overrides.type || name, nextParams.disableStackTrace);\n      error.params = nextParams;\n      return error;\n    }\n    const invalid = abortEarly ? panic : next;\n    let ctx = {\n      path,\n      parent,\n      type: name,\n      from: options.from,\n      createError,\n      resolve(item) {\n        return resolveMaybeRef(item, resolveOptions);\n      },\n      options,\n      originalValue,\n      schema\n    };\n    const handleResult = validOrError => {\n      if (ValidationError.isError(validOrError)) invalid(validOrError);else if (!validOrError) invalid(createError());else next(null);\n    };\n    const handleError = err => {\n      if (ValidationError.isError(err)) invalid(err);else panic(err);\n    };\n    const shouldSkip = skipAbsent && isAbsent(value);\n    if (shouldSkip) {\n      return handleResult(true);\n    }\n    let result;\n    try {\n      var _result;\n      result = test.call(ctx, value, ctx);\n      if (typeof ((_result = result) == null ? void 0 : _result.then) === 'function') {\n        if (options.sync) {\n          throw new Error(`Validation test of type: \"${ctx.type}\" returned a Promise during a synchronous validate. ` + `This test will finish after the validate call has returned`);\n        }\n        return Promise.resolve(result).then(handleResult, handleError);\n      }\n    } catch (err) {\n      handleError(err);\n      return;\n    }\n    handleResult(result);\n  }\n  validate.OPTIONS = config;\n  return validate;\n}\n\n// Warning: mutates the input\nfunction resolveParams(params, options) {\n  if (!params) return params;\n  for (const key of Object.keys(params)) {\n    params[key] = resolveMaybeRef(params[key], options);\n  }\n  return params;\n}\nfunction resolveMaybeRef(item, options) {\n  return Reference.isRef(item) ? item.getValue(options.value, options.parent, options.context) : item;\n}\n\nfunction getIn(schema, path, value, context = value) {\n  let parent, lastPart, lastPartDebug;\n\n  // root path: ''\n  if (!path) return {\n    parent,\n    parentPath: path,\n    schema\n  };\n  forEach(path, (_part, isBracket, isArray) => {\n    let part = isBracket ? _part.slice(1, _part.length - 1) : _part;\n    schema = schema.resolve({\n      context,\n      parent,\n      value\n    });\n    let isTuple = schema.type === 'tuple';\n    let idx = isArray ? parseInt(part, 10) : 0;\n    if (schema.innerType || isTuple) {\n      if (isTuple && !isArray) throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part \"${lastPartDebug}\" must contain an index to the tuple element, e.g. \"${lastPartDebug}[0]\"`);\n      if (value && idx >= value.length) {\n        throw new Error(`Yup.reach cannot resolve an array item at index: ${_part}, in the path: ${path}. ` + `because there is no value at that index. `);\n      }\n      parent = value;\n      value = value && value[idx];\n      schema = isTuple ? schema.spec.types[idx] : schema.innerType;\n    }\n\n    // sometimes the array index part of a path doesn't exist: \"nested.arr.child\"\n    // in these cases the current part is the next schema and should be processed\n    // in this iteration. For cases where the index signature is included this\n    // check will fail and we'll handle the `child` part on the next iteration like normal\n    if (!isArray) {\n      if (!schema.fields || !schema.fields[part]) throw new Error(`The schema does not contain the path: ${path}. ` + `(failed at: ${lastPartDebug} which is a type: \"${schema.type}\")`);\n      parent = value;\n      value = value && value[part];\n      schema = schema.fields[part];\n    }\n    lastPart = part;\n    lastPartDebug = isBracket ? '[' + _part + ']' : '.' + _part;\n  });\n  return {\n    schema,\n    parent,\n    parentPath: lastPart\n  };\n}\nfunction reach(obj, path, value, context) {\n  return getIn(obj, path, value, context).schema;\n}\n\nclass ReferenceSet extends Set {\n  describe() {\n    const description = [];\n    for (const item of this.values()) {\n      description.push(Reference.isRef(item) ? item.describe() : item);\n    }\n    return description;\n  }\n  resolveAll(resolve) {\n    let result = [];\n    for (const item of this.values()) {\n      result.push(resolve(item));\n    }\n    return result;\n  }\n  clone() {\n    return new ReferenceSet(this.values());\n  }\n  merge(newItems, removeItems) {\n    const next = this.clone();\n    newItems.forEach(value => next.add(value));\n    removeItems.forEach(value => next.delete(value));\n    return next;\n  }\n}\n\n// tweaked from https://github.com/Kelin2025/nanoclone/blob/0abeb7635bda9b68ef2277093f76dbe3bf3948e1/src/index.js\nfunction clone(src, seen = new Map()) {\n  if (isSchema(src) || !src || typeof src !== 'object') return src;\n  if (seen.has(src)) return seen.get(src);\n  let copy;\n  if (src instanceof Date) {\n    // Date\n    copy = new Date(src.getTime());\n    seen.set(src, copy);\n  } else if (src instanceof RegExp) {\n    // RegExp\n    copy = new RegExp(src);\n    seen.set(src, copy);\n  } else if (Array.isArray(src)) {\n    // Array\n    copy = new Array(src.length);\n    seen.set(src, copy);\n    for (let i = 0; i < src.length; i++) copy[i] = clone(src[i], seen);\n  } else if (src instanceof Map) {\n    // Map\n    copy = new Map();\n    seen.set(src, copy);\n    for (const [k, v] of src.entries()) copy.set(k, clone(v, seen));\n  } else if (src instanceof Set) {\n    // Set\n    copy = new Set();\n    seen.set(src, copy);\n    for (const v of src) copy.add(clone(v, seen));\n  } else if (src instanceof Object) {\n    // Object\n    copy = {};\n    seen.set(src, copy);\n    for (const [k, v] of Object.entries(src)) copy[k] = clone(v, seen);\n  } else {\n    throw Error(`Unable to clone ${src}`);\n  }\n  return copy;\n}\n\n/**\n * Copied from @standard-schema/spec to avoid having a dependency on it.\n * https://github.com/standard-schema/standard-schema/blob/main/packages/spec/src/index.ts\n */\n\nfunction createStandardPath(path) {\n  if (!(path != null && path.length)) {\n    return undefined;\n  }\n\n  // Array to store the final path segments\n  const segments = [];\n  // Buffer for building the current segment\n  let currentSegment = '';\n  // Track if we're inside square brackets (array/property access)\n  let inBrackets = false;\n  // Track if we're inside quotes (for property names with special chars)\n  let inQuotes = false;\n  for (let i = 0; i < path.length; i++) {\n    const char = path[i];\n    if (char === '[' && !inQuotes) {\n      // When entering brackets, push any accumulated segment after splitting on dots\n      if (currentSegment) {\n        segments.push(...currentSegment.split('.').filter(Boolean));\n        currentSegment = '';\n      }\n      inBrackets = true;\n      continue;\n    }\n    if (char === ']' && !inQuotes) {\n      if (currentSegment) {\n        // Handle numeric indices (e.g. arr[0])\n        if (/^\\d+$/.test(currentSegment)) {\n          segments.push(currentSegment);\n        } else {\n          // Handle quoted property names (e.g. obj[\"foo.bar\"])\n          segments.push(currentSegment.replace(/^\"|\"$/g, ''));\n        }\n        currentSegment = '';\n      }\n      inBrackets = false;\n      continue;\n    }\n    if (char === '\"') {\n      // Toggle quote state for handling quoted property names\n      inQuotes = !inQuotes;\n      continue;\n    }\n    if (char === '.' && !inBrackets && !inQuotes) {\n      // On dots outside brackets/quotes, push current segment\n      if (currentSegment) {\n        segments.push(currentSegment);\n        currentSegment = '';\n      }\n      continue;\n    }\n    currentSegment += char;\n  }\n\n  // Push any remaining segment after splitting on dots\n  if (currentSegment) {\n    segments.push(...currentSegment.split('.').filter(Boolean));\n  }\n  return segments;\n}\nfunction createStandardIssues(error, parentPath) {\n  const path = parentPath ? `${parentPath}.${error.path}` : error.path;\n  return error.errors.map(err => ({\n    message: err,\n    path: createStandardPath(path)\n  }));\n}\nfunction issuesFromValidationError(error, parentPath) {\n  var _error$inner;\n  if (!((_error$inner = error.inner) != null && _error$inner.length) && error.errors.length) {\n    return createStandardIssues(error, parentPath);\n  }\n  const path = parentPath ? `${parentPath}.${error.path}` : error.path;\n  return error.inner.flatMap(err => issuesFromValidationError(err, path));\n}\n\n// If `CustomSchemaMeta` isn't extended with any keys, we'll fall back to a\n// loose Record definition allowing free form usage.\nclass Schema {\n  constructor(options) {\n    this.type = void 0;\n    this.deps = [];\n    this.tests = void 0;\n    this.transforms = void 0;\n    this.conditions = [];\n    this._mutate = void 0;\n    this.internalTests = {};\n    this._whitelist = new ReferenceSet();\n    this._blacklist = new ReferenceSet();\n    this.exclusiveTests = Object.create(null);\n    this._typeCheck = void 0;\n    this.spec = void 0;\n    this.tests = [];\n    this.transforms = [];\n    this.withMutation(() => {\n      this.typeError(mixed.notType);\n    });\n    this.type = options.type;\n    this._typeCheck = options.check;\n    this.spec = Object.assign({\n      strip: false,\n      strict: false,\n      abortEarly: true,\n      recursive: true,\n      disableStackTrace: false,\n      nullable: false,\n      optional: true,\n      coerce: true\n    }, options == null ? void 0 : options.spec);\n    this.withMutation(s => {\n      s.nonNullable();\n    });\n  }\n\n  // TODO: remove\n  get _type() {\n    return this.type;\n  }\n  clone(spec) {\n    if (this._mutate) {\n      if (spec) Object.assign(this.spec, spec);\n      return this;\n    }\n\n    // if the nested value is a schema we can skip cloning, since\n    // they are already immutable\n    const next = Object.create(Object.getPrototypeOf(this));\n\n    // @ts-expect-error this is readonly\n    next.type = this.type;\n    next._typeCheck = this._typeCheck;\n    next._whitelist = this._whitelist.clone();\n    next._blacklist = this._blacklist.clone();\n    next.internalTests = Object.assign({}, this.internalTests);\n    next.exclusiveTests = Object.assign({}, this.exclusiveTests);\n\n    // @ts-expect-error this is readonly\n    next.deps = [...this.deps];\n    next.conditions = [...this.conditions];\n    next.tests = [...this.tests];\n    next.transforms = [...this.transforms];\n    next.spec = clone(Object.assign({}, this.spec, spec));\n    return next;\n  }\n  label(label) {\n    let next = this.clone();\n    next.spec.label = label;\n    return next;\n  }\n  meta(...args) {\n    if (args.length === 0) return this.spec.meta;\n    let next = this.clone();\n    next.spec.meta = Object.assign(next.spec.meta || {}, args[0]);\n    return next;\n  }\n  withMutation(fn) {\n    let before = this._mutate;\n    this._mutate = true;\n    let result = fn(this);\n    this._mutate = before;\n    return result;\n  }\n  concat(schema) {\n    if (!schema || schema === this) return this;\n    if (schema.type !== this.type && this.type !== 'mixed') throw new TypeError(`You cannot \\`concat()\\` schema's of different types: ${this.type} and ${schema.type}`);\n    let base = this;\n    let combined = schema.clone();\n    const mergedSpec = Object.assign({}, base.spec, combined.spec);\n    combined.spec = mergedSpec;\n    combined.internalTests = Object.assign({}, base.internalTests, combined.internalTests);\n\n    // manually merge the blacklist/whitelist (the other `schema` takes\n    // precedence in case of conflicts)\n    combined._whitelist = base._whitelist.merge(schema._whitelist, schema._blacklist);\n    combined._blacklist = base._blacklist.merge(schema._blacklist, schema._whitelist);\n\n    // start with the current tests\n    combined.tests = base.tests;\n    combined.exclusiveTests = base.exclusiveTests;\n\n    // manually add the new tests to ensure\n    // the deduping logic is consistent\n    combined.withMutation(next => {\n      schema.tests.forEach(fn => {\n        next.test(fn.OPTIONS);\n      });\n    });\n    combined.transforms = [...base.transforms, ...combined.transforms];\n    return combined;\n  }\n  isType(v) {\n    if (v == null) {\n      if (this.spec.nullable && v === null) return true;\n      if (this.spec.optional && v === undefined) return true;\n      return false;\n    }\n    return this._typeCheck(v);\n  }\n  resolve(options) {\n    let schema = this;\n    if (schema.conditions.length) {\n      let conditions = schema.conditions;\n      schema = schema.clone();\n      schema.conditions = [];\n      schema = conditions.reduce((prevSchema, condition) => condition.resolve(prevSchema, options), schema);\n      schema = schema.resolve(options);\n    }\n    return schema;\n  }\n  resolveOptions(options) {\n    var _options$strict, _options$abortEarly, _options$recursive, _options$disableStack;\n    return Object.assign({}, options, {\n      from: options.from || [],\n      strict: (_options$strict = options.strict) != null ? _options$strict : this.spec.strict,\n      abortEarly: (_options$abortEarly = options.abortEarly) != null ? _options$abortEarly : this.spec.abortEarly,\n      recursive: (_options$recursive = options.recursive) != null ? _options$recursive : this.spec.recursive,\n      disableStackTrace: (_options$disableStack = options.disableStackTrace) != null ? _options$disableStack : this.spec.disableStackTrace\n    });\n  }\n\n  /**\n   * Run the configured transform pipeline over an input value.\n   */\n\n  cast(value, options = {}) {\n    let resolvedSchema = this.resolve(Object.assign({\n      value\n    }, options));\n    let allowOptionality = options.assert === 'ignore-optionality';\n    let result = resolvedSchema._cast(value, options);\n    if (options.assert !== false && !resolvedSchema.isType(result)) {\n      if (allowOptionality && isAbsent(result)) {\n        return result;\n      }\n      let formattedValue = printValue(value);\n      let formattedResult = printValue(result);\n      throw new TypeError(`The value of ${options.path || 'field'} could not be cast to a value ` + `that satisfies the schema type: \"${resolvedSchema.type}\". \\n\\n` + `attempted value: ${formattedValue} \\n` + (formattedResult !== formattedValue ? `result of cast: ${formattedResult}` : ''));\n    }\n    return result;\n  }\n  _cast(rawValue, options) {\n    let value = rawValue === undefined ? rawValue : this.transforms.reduce((prevValue, fn) => fn.call(this, prevValue, rawValue, this), rawValue);\n    if (value === undefined) {\n      value = this.getDefault(options);\n    }\n    return value;\n  }\n  _validate(_value, options = {}, panic, next) {\n    let {\n      path,\n      originalValue = _value,\n      strict = this.spec.strict\n    } = options;\n    let value = _value;\n    if (!strict) {\n      value = this._cast(value, Object.assign({\n        assert: false\n      }, options));\n    }\n    let initialTests = [];\n    for (let test of Object.values(this.internalTests)) {\n      if (test) initialTests.push(test);\n    }\n    this.runTests({\n      path,\n      value,\n      originalValue,\n      options,\n      tests: initialTests\n    }, panic, initialErrors => {\n      // even if we aren't ending early we can't proceed further if the types aren't correct\n      if (initialErrors.length) {\n        return next(initialErrors, value);\n      }\n      this.runTests({\n        path,\n        value,\n        originalValue,\n        options,\n        tests: this.tests\n      }, panic, next);\n    });\n  }\n\n  /**\n   * Executes a set of validations, either schema, produced Tests or a nested\n   * schema validate result.\n   */\n  runTests(runOptions, panic, next) {\n    let fired = false;\n    let {\n      tests,\n      value,\n      originalValue,\n      path,\n      options\n    } = runOptions;\n    let panicOnce = arg => {\n      if (fired) return;\n      fired = true;\n      panic(arg, value);\n    };\n    let nextOnce = arg => {\n      if (fired) return;\n      fired = true;\n      next(arg, value);\n    };\n    let count = tests.length;\n    let nestedErrors = [];\n    if (!count) return nextOnce([]);\n    let args = {\n      value,\n      originalValue,\n      path,\n      options,\n      schema: this\n    };\n    for (let i = 0; i < tests.length; i++) {\n      const test = tests[i];\n      test(args, panicOnce, function finishTestRun(err) {\n        if (err) {\n          Array.isArray(err) ? nestedErrors.push(...err) : nestedErrors.push(err);\n        }\n        if (--count <= 0) {\n          nextOnce(nestedErrors);\n        }\n      });\n    }\n  }\n  asNestedTest({\n    key,\n    index,\n    parent,\n    parentPath,\n    originalParent,\n    options\n  }) {\n    const k = key != null ? key : index;\n    if (k == null) {\n      throw TypeError('Must include `key` or `index` for nested validations');\n    }\n    const isIndex = typeof k === 'number';\n    let value = parent[k];\n    const testOptions = Object.assign({}, options, {\n      // Nested validations fields are always strict:\n      //    1. parent isn't strict so the casting will also have cast inner values\n      //    2. parent is strict in which case the nested values weren't cast either\n      strict: true,\n      parent,\n      value,\n      originalValue: originalParent[k],\n      // FIXME: tests depend on `index` being passed around deeply,\n      //   we should not let the options.key/index bleed through\n      key: undefined,\n      // index: undefined,\n      [isIndex ? 'index' : 'key']: k,\n      path: isIndex || k.includes('.') ? `${parentPath || ''}[${isIndex ? k : `\"${k}\"`}]` : (parentPath ? `${parentPath}.` : '') + key\n    });\n    return (_, panic, next) => this.resolve(testOptions)._validate(value, testOptions, panic, next);\n  }\n  validate(value, options) {\n    var _options$disableStack2;\n    let schema = this.resolve(Object.assign({}, options, {\n      value\n    }));\n    let disableStackTrace = (_options$disableStack2 = options == null ? void 0 : options.disableStackTrace) != null ? _options$disableStack2 : schema.spec.disableStackTrace;\n    return new Promise((resolve, reject) => schema._validate(value, options, (error, parsed) => {\n      if (ValidationError.isError(error)) error.value = parsed;\n      reject(error);\n    }, (errors, validated) => {\n      if (errors.length) reject(new ValidationError(errors, validated, undefined, undefined, disableStackTrace));else resolve(validated);\n    }));\n  }\n  validateSync(value, options) {\n    var _options$disableStack3;\n    let schema = this.resolve(Object.assign({}, options, {\n      value\n    }));\n    let result;\n    let disableStackTrace = (_options$disableStack3 = options == null ? void 0 : options.disableStackTrace) != null ? _options$disableStack3 : schema.spec.disableStackTrace;\n    schema._validate(value, Object.assign({}, options, {\n      sync: true\n    }), (error, parsed) => {\n      if (ValidationError.isError(error)) error.value = parsed;\n      throw error;\n    }, (errors, validated) => {\n      if (errors.length) throw new ValidationError(errors, value, undefined, undefined, disableStackTrace);\n      result = validated;\n    });\n    return result;\n  }\n  isValid(value, options) {\n    return this.validate(value, options).then(() => true, err => {\n      if (ValidationError.isError(err)) return false;\n      throw err;\n    });\n  }\n  isValidSync(value, options) {\n    try {\n      this.validateSync(value, options);\n      return true;\n    } catch (err) {\n      if (ValidationError.isError(err)) return false;\n      throw err;\n    }\n  }\n  _getDefault(options) {\n    let defaultValue = this.spec.default;\n    if (defaultValue == null) {\n      return defaultValue;\n    }\n    return typeof defaultValue === 'function' ? defaultValue.call(this, options) : clone(defaultValue);\n  }\n  getDefault(options\n  // If schema is defaulted we know it's at least not undefined\n  ) {\n    let schema = this.resolve(options || {});\n    return schema._getDefault(options);\n  }\n  default(def) {\n    if (arguments.length === 0) {\n      return this._getDefault();\n    }\n    let next = this.clone({\n      default: def\n    });\n    return next;\n  }\n  strict(isStrict = true) {\n    return this.clone({\n      strict: isStrict\n    });\n  }\n  nullability(nullable, message) {\n    const next = this.clone({\n      nullable\n    });\n    next.internalTests.nullable = createValidation({\n      message,\n      name: 'nullable',\n      test(value) {\n        return value === null ? this.schema.spec.nullable : true;\n      }\n    });\n    return next;\n  }\n  optionality(optional, message) {\n    const next = this.clone({\n      optional\n    });\n    next.internalTests.optionality = createValidation({\n      message,\n      name: 'optionality',\n      test(value) {\n        return value === undefined ? this.schema.spec.optional : true;\n      }\n    });\n    return next;\n  }\n  optional() {\n    return this.optionality(true);\n  }\n  defined(message = mixed.defined) {\n    return this.optionality(false, message);\n  }\n  nullable() {\n    return this.nullability(true);\n  }\n  nonNullable(message = mixed.notNull) {\n    return this.nullability(false, message);\n  }\n  required(message = mixed.required) {\n    return this.clone().withMutation(next => next.nonNullable(message).defined(message));\n  }\n  notRequired() {\n    return this.clone().withMutation(next => next.nullable().optional());\n  }\n  transform(fn) {\n    let next = this.clone();\n    next.transforms.push(fn);\n    return next;\n  }\n\n  /**\n   * Adds a test function to the schema's queue of tests.\n   * tests can be exclusive or non-exclusive.\n   *\n   * - exclusive tests, will replace any existing tests of the same name.\n   * - non-exclusive: can be stacked\n   *\n   * If a non-exclusive test is added to a schema with an exclusive test of the same name\n   * the exclusive test is removed and further tests of the same name will be stacked.\n   *\n   * If an exclusive test is added to a schema with non-exclusive tests of the same name\n   * the previous tests are removed and further tests of the same name will replace each other.\n   */\n\n  test(...args) {\n    let opts;\n    if (args.length === 1) {\n      if (typeof args[0] === 'function') {\n        opts = {\n          test: args[0]\n        };\n      } else {\n        opts = args[0];\n      }\n    } else if (args.length === 2) {\n      opts = {\n        name: args[0],\n        test: args[1]\n      };\n    } else {\n      opts = {\n        name: args[0],\n        message: args[1],\n        test: args[2]\n      };\n    }\n    if (opts.message === undefined) opts.message = mixed.default;\n    if (typeof opts.test !== 'function') throw new TypeError('`test` is a required parameters');\n    let next = this.clone();\n    let validate = createValidation(opts);\n    let isExclusive = opts.exclusive || opts.name && next.exclusiveTests[opts.name] === true;\n    if (opts.exclusive) {\n      if (!opts.name) throw new TypeError('Exclusive tests must provide a unique `name` identifying the test');\n    }\n    if (opts.name) next.exclusiveTests[opts.name] = !!opts.exclusive;\n    next.tests = next.tests.filter(fn => {\n      if (fn.OPTIONS.name === opts.name) {\n        if (isExclusive) return false;\n        if (fn.OPTIONS.test === validate.OPTIONS.test) return false;\n      }\n      return true;\n    });\n    next.tests.push(validate);\n    return next;\n  }\n  when(keys, options) {\n    if (!Array.isArray(keys) && typeof keys !== 'string') {\n      options = keys;\n      keys = '.';\n    }\n    let next = this.clone();\n    let deps = toArray(keys).map(key => new Reference(key));\n    deps.forEach(dep => {\n      // @ts-ignore readonly array\n      if (dep.isSibling) next.deps.push(dep.key);\n    });\n    next.conditions.push(typeof options === 'function' ? new Condition(deps, options) : Condition.fromOptions(deps, options));\n    return next;\n  }\n  typeError(message) {\n    let next = this.clone();\n    next.internalTests.typeError = createValidation({\n      message,\n      name: 'typeError',\n      skipAbsent: true,\n      test(value) {\n        if (!this.schema._typeCheck(value)) return this.createError({\n          params: {\n            type: this.schema.type\n          }\n        });\n        return true;\n      }\n    });\n    return next;\n  }\n  oneOf(enums, message = mixed.oneOf) {\n    let next = this.clone();\n    enums.forEach(val => {\n      next._whitelist.add(val);\n      next._blacklist.delete(val);\n    });\n    next.internalTests.whiteList = createValidation({\n      message,\n      name: 'oneOf',\n      skipAbsent: true,\n      test(value) {\n        let valids = this.schema._whitelist;\n        let resolved = valids.resolveAll(this.resolve);\n        return resolved.includes(value) ? true : this.createError({\n          params: {\n            values: Array.from(valids).join(', '),\n            resolved\n          }\n        });\n      }\n    });\n    return next;\n  }\n  notOneOf(enums, message = mixed.notOneOf) {\n    let next = this.clone();\n    enums.forEach(val => {\n      next._blacklist.add(val);\n      next._whitelist.delete(val);\n    });\n    next.internalTests.blacklist = createValidation({\n      message,\n      name: 'notOneOf',\n      test(value) {\n        let invalids = this.schema._blacklist;\n        let resolved = invalids.resolveAll(this.resolve);\n        if (resolved.includes(value)) return this.createError({\n          params: {\n            values: Array.from(invalids).join(', '),\n            resolved\n          }\n        });\n        return true;\n      }\n    });\n    return next;\n  }\n  strip(strip = true) {\n    let next = this.clone();\n    next.spec.strip = strip;\n    return next;\n  }\n\n  /**\n   * Return a serialized description of the schema including validations, flags, types etc.\n   *\n   * @param options Provide any needed context for resolving runtime schema alterations (lazy, when conditions, etc).\n   */\n  describe(options) {\n    const next = (options ? this.resolve(options) : this).clone();\n    const {\n      label,\n      meta,\n      optional,\n      nullable\n    } = next.spec;\n    const description = {\n      meta,\n      label,\n      optional,\n      nullable,\n      default: next.getDefault(options),\n      type: next.type,\n      oneOf: next._whitelist.describe(),\n      notOneOf: next._blacklist.describe(),\n      tests: next.tests.filter((n, idx, list) => list.findIndex(c => c.OPTIONS.name === n.OPTIONS.name) === idx).map(fn => {\n        const params = fn.OPTIONS.params && options ? resolveParams(Object.assign({}, fn.OPTIONS.params), options) : fn.OPTIONS.params;\n        return {\n          name: fn.OPTIONS.name,\n          params\n        };\n      })\n    };\n    return description;\n  }\n  get ['~standard']() {\n    const schema = this;\n    const standard = {\n      version: 1,\n      vendor: 'yup',\n      async validate(value) {\n        try {\n          const result = await schema.validate(value, {\n            abortEarly: false\n          });\n          return {\n            value: result\n          };\n        } catch (err) {\n          if (err instanceof ValidationError) {\n            return {\n              issues: issuesFromValidationError(err)\n            };\n          }\n          throw err;\n        }\n      }\n    };\n    return standard;\n  }\n}\n// @ts-expect-error\nSchema.prototype.__isYupSchema__ = true;\nfor (const method of ['validate', 'validateSync']) Schema.prototype[`${method}At`] = function (path, value, options = {}) {\n  const {\n    parent,\n    parentPath,\n    schema\n  } = getIn(this, path, value, options.context);\n  return schema[method](parent && parent[parentPath], Object.assign({}, options, {\n    parent,\n    path\n  }));\n};\nfor (const alias of ['equals', 'is']) Schema.prototype[alias] = Schema.prototype.oneOf;\nfor (const alias of ['not', 'nope']) Schema.prototype[alias] = Schema.prototype.notOneOf;\n\nconst returnsTrue = () => true;\nfunction create$8(spec) {\n  return new MixedSchema(spec);\n}\nclass MixedSchema extends Schema {\n  constructor(spec) {\n    super(typeof spec === 'function' ? {\n      type: 'mixed',\n      check: spec\n    } : Object.assign({\n      type: 'mixed',\n      check: returnsTrue\n    }, spec));\n  }\n}\ncreate$8.prototype = MixedSchema.prototype;\n\nfunction create$7() {\n  return new BooleanSchema();\n}\nclass BooleanSchema extends Schema {\n  constructor() {\n    super({\n      type: 'boolean',\n      check(v) {\n        if (v instanceof Boolean) v = v.valueOf();\n        return typeof v === 'boolean';\n      }\n    });\n    this.withMutation(() => {\n      this.transform((value, _raw, ctx) => {\n        if (ctx.spec.coerce && !ctx.isType(value)) {\n          if (/^(true|1)$/i.test(String(value))) return true;\n          if (/^(false|0)$/i.test(String(value))) return false;\n        }\n        return value;\n      });\n    });\n  }\n  isTrue(message = boolean.isValue) {\n    return this.test({\n      message,\n      name: 'is-value',\n      exclusive: true,\n      params: {\n        value: 'true'\n      },\n      test(value) {\n        return isAbsent(value) || value === true;\n      }\n    });\n  }\n  isFalse(message = boolean.isValue) {\n    return this.test({\n      message,\n      name: 'is-value',\n      exclusive: true,\n      params: {\n        value: 'false'\n      },\n      test(value) {\n        return isAbsent(value) || value === false;\n      }\n    });\n  }\n  default(def) {\n    return super.default(def);\n  }\n  defined(msg) {\n    return super.defined(msg);\n  }\n  optional() {\n    return super.optional();\n  }\n  required(msg) {\n    return super.required(msg);\n  }\n  notRequired() {\n    return super.notRequired();\n  }\n  nullable() {\n    return super.nullable();\n  }\n  nonNullable(msg) {\n    return super.nonNullable(msg);\n  }\n  strip(v) {\n    return super.strip(v);\n  }\n}\ncreate$7.prototype = BooleanSchema.prototype;\n\n/**\n * This file is a modified version of the file from the following repository:\n * Date.parse with progressive enhancement for ISO 8601 <https://github.com/csnover/js-iso8601>\n * NON-CONFORMANT EDITION.\n * © 2011 Colin Snover <http://zetafleet.com>\n * Released under MIT license.\n */\n\n// prettier-ignore\n//                1 YYYY                2 MM        3 DD              4 HH     5 mm        6 ss           7 msec         8 Z 9 ±   10 tzHH    11 tzmm\nconst isoReg = /^(\\d{4}|[+-]\\d{6})(?:-?(\\d{2})(?:-?(\\d{2}))?)?(?:[ T]?(\\d{2}):?(\\d{2})(?::?(\\d{2})(?:[,.](\\d{1,}))?)?(?:(Z)|([+-])(\\d{2})(?::?(\\d{2}))?)?)?$/;\nfunction parseIsoDate(date) {\n  const struct = parseDateStruct(date);\n  if (!struct) return Date.parse ? Date.parse(date) : Number.NaN;\n\n  // timestamps without timezone identifiers should be considered local time\n  if (struct.z === undefined && struct.plusMinus === undefined) {\n    return new Date(struct.year, struct.month, struct.day, struct.hour, struct.minute, struct.second, struct.millisecond).valueOf();\n  }\n  let totalMinutesOffset = 0;\n  if (struct.z !== 'Z' && struct.plusMinus !== undefined) {\n    totalMinutesOffset = struct.hourOffset * 60 + struct.minuteOffset;\n    if (struct.plusMinus === '+') totalMinutesOffset = 0 - totalMinutesOffset;\n  }\n  return Date.UTC(struct.year, struct.month, struct.day, struct.hour, struct.minute + totalMinutesOffset, struct.second, struct.millisecond);\n}\nfunction parseDateStruct(date) {\n  var _regexResult$7$length, _regexResult$;\n  const regexResult = isoReg.exec(date);\n  if (!regexResult) return null;\n\n  // use of toNumber() avoids NaN timestamps caused by “undefined”\n  // values being passed to Date constructor\n  return {\n    year: toNumber(regexResult[1]),\n    month: toNumber(regexResult[2], 1) - 1,\n    day: toNumber(regexResult[3], 1),\n    hour: toNumber(regexResult[4]),\n    minute: toNumber(regexResult[5]),\n    second: toNumber(regexResult[6]),\n    millisecond: regexResult[7] ?\n    // allow arbitrary sub-second precision beyond milliseconds\n    toNumber(regexResult[7].substring(0, 3)) : 0,\n    precision: (_regexResult$7$length = (_regexResult$ = regexResult[7]) == null ? void 0 : _regexResult$.length) != null ? _regexResult$7$length : undefined,\n    z: regexResult[8] || undefined,\n    plusMinus: regexResult[9] || undefined,\n    hourOffset: toNumber(regexResult[10]),\n    minuteOffset: toNumber(regexResult[11])\n  };\n}\nfunction toNumber(str, defaultValue = 0) {\n  return Number(str) || defaultValue;\n}\n\n// Taken from HTML spec: https://html.spec.whatwg.org/multipage/input.html#valid-e-mail-address\nlet rEmail =\n// eslint-disable-next-line\n/^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\nlet rUrl =\n// eslint-disable-next-line\n/^((https?|ftp):)?\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:)*@)?(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5]))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(\\#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i;\n\n// eslint-disable-next-line\nlet rUUID = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;\nlet yearMonthDay = '^\\\\d{4}-\\\\d{2}-\\\\d{2}';\nlet hourMinuteSecond = '\\\\d{2}:\\\\d{2}:\\\\d{2}';\nlet zOrOffset = '(([+-]\\\\d{2}(:?\\\\d{2})?)|Z)';\nlet rIsoDateTime = new RegExp(`${yearMonthDay}T${hourMinuteSecond}(\\\\.\\\\d+)?${zOrOffset}$`);\nlet isTrimmed = value => isAbsent(value) || value === value.trim();\nlet objStringTag = {}.toString();\nfunction create$6() {\n  return new StringSchema();\n}\nclass StringSchema extends Schema {\n  constructor() {\n    super({\n      type: 'string',\n      check(value) {\n        if (value instanceof String) value = value.valueOf();\n        return typeof value === 'string';\n      }\n    });\n    this.withMutation(() => {\n      this.transform((value, _raw, ctx) => {\n        if (!ctx.spec.coerce || ctx.isType(value)) return value;\n\n        // don't ever convert arrays\n        if (Array.isArray(value)) return value;\n        const strValue = value != null && value.toString ? value.toString() : value;\n\n        // no one wants plain objects converted to [Object object]\n        if (strValue === objStringTag) return value;\n        return strValue;\n      });\n    });\n  }\n  required(message) {\n    return super.required(message).withMutation(schema => schema.test({\n      message: message || mixed.required,\n      name: 'required',\n      skipAbsent: true,\n      test: value => !!value.length\n    }));\n  }\n  notRequired() {\n    return super.notRequired().withMutation(schema => {\n      schema.tests = schema.tests.filter(t => t.OPTIONS.name !== 'required');\n      return schema;\n    });\n  }\n  length(length, message = string.length) {\n    return this.test({\n      message,\n      name: 'length',\n      exclusive: true,\n      params: {\n        length\n      },\n      skipAbsent: true,\n      test(value) {\n        return value.length === this.resolve(length);\n      }\n    });\n  }\n  min(min, message = string.min) {\n    return this.test({\n      message,\n      name: 'min',\n      exclusive: true,\n      params: {\n        min\n      },\n      skipAbsent: true,\n      test(value) {\n        return value.length >= this.resolve(min);\n      }\n    });\n  }\n  max(max, message = string.max) {\n    return this.test({\n      name: 'max',\n      exclusive: true,\n      message,\n      params: {\n        max\n      },\n      skipAbsent: true,\n      test(value) {\n        return value.length <= this.resolve(max);\n      }\n    });\n  }\n  matches(regex, options) {\n    let excludeEmptyString = false;\n    let message;\n    let name;\n    if (options) {\n      if (typeof options === 'object') {\n        ({\n          excludeEmptyString = false,\n          message,\n          name\n        } = options);\n      } else {\n        message = options;\n      }\n    }\n    return this.test({\n      name: name || 'matches',\n      message: message || string.matches,\n      params: {\n        regex\n      },\n      skipAbsent: true,\n      test: value => value === '' && excludeEmptyString || value.search(regex) !== -1\n    });\n  }\n  email(message = string.email) {\n    return this.matches(rEmail, {\n      name: 'email',\n      message,\n      excludeEmptyString: true\n    });\n  }\n  url(message = string.url) {\n    return this.matches(rUrl, {\n      name: 'url',\n      message,\n      excludeEmptyString: true\n    });\n  }\n  uuid(message = string.uuid) {\n    return this.matches(rUUID, {\n      name: 'uuid',\n      message,\n      excludeEmptyString: false\n    });\n  }\n  datetime(options) {\n    let message = '';\n    let allowOffset;\n    let precision;\n    if (options) {\n      if (typeof options === 'object') {\n        ({\n          message = '',\n          allowOffset = false,\n          precision = undefined\n        } = options);\n      } else {\n        message = options;\n      }\n    }\n    return this.matches(rIsoDateTime, {\n      name: 'datetime',\n      message: message || string.datetime,\n      excludeEmptyString: true\n    }).test({\n      name: 'datetime_offset',\n      message: message || string.datetime_offset,\n      params: {\n        allowOffset\n      },\n      skipAbsent: true,\n      test: value => {\n        if (!value || allowOffset) return true;\n        const struct = parseDateStruct(value);\n        if (!struct) return false;\n        return !!struct.z;\n      }\n    }).test({\n      name: 'datetime_precision',\n      message: message || string.datetime_precision,\n      params: {\n        precision\n      },\n      skipAbsent: true,\n      test: value => {\n        if (!value || precision == undefined) return true;\n        const struct = parseDateStruct(value);\n        if (!struct) return false;\n        return struct.precision === precision;\n      }\n    });\n  }\n\n  //-- transforms --\n  ensure() {\n    return this.default('').transform(val => val === null ? '' : val);\n  }\n  trim(message = string.trim) {\n    return this.transform(val => val != null ? val.trim() : val).test({\n      message,\n      name: 'trim',\n      test: isTrimmed\n    });\n  }\n  lowercase(message = string.lowercase) {\n    return this.transform(value => !isAbsent(value) ? value.toLowerCase() : value).test({\n      message,\n      name: 'string_case',\n      exclusive: true,\n      skipAbsent: true,\n      test: value => isAbsent(value) || value === value.toLowerCase()\n    });\n  }\n  uppercase(message = string.uppercase) {\n    return this.transform(value => !isAbsent(value) ? value.toUpperCase() : value).test({\n      message,\n      name: 'string_case',\n      exclusive: true,\n      skipAbsent: true,\n      test: value => isAbsent(value) || value === value.toUpperCase()\n    });\n  }\n}\ncreate$6.prototype = StringSchema.prototype;\n\n//\n// String Interfaces\n//\n\nlet isNaN$1 = value => value != +value;\nfunction create$5() {\n  return new NumberSchema();\n}\nclass NumberSchema extends Schema {\n  constructor() {\n    super({\n      type: 'number',\n      check(value) {\n        if (value instanceof Number) value = value.valueOf();\n        return typeof value === 'number' && !isNaN$1(value);\n      }\n    });\n    this.withMutation(() => {\n      this.transform((value, _raw, ctx) => {\n        if (!ctx.spec.coerce) return value;\n        let parsed = value;\n        if (typeof parsed === 'string') {\n          parsed = parsed.replace(/\\s/g, '');\n          if (parsed === '') return NaN;\n          // don't use parseFloat to avoid positives on alpha-numeric strings\n          parsed = +parsed;\n        }\n\n        // null -> NaN isn't useful; treat all nulls as null and let it fail on\n        // nullability check vs TypeErrors\n        if (ctx.isType(parsed) || parsed === null) return parsed;\n        return parseFloat(parsed);\n      });\n    });\n  }\n  min(min, message = number.min) {\n    return this.test({\n      message,\n      name: 'min',\n      exclusive: true,\n      params: {\n        min\n      },\n      skipAbsent: true,\n      test(value) {\n        return value >= this.resolve(min);\n      }\n    });\n  }\n  max(max, message = number.max) {\n    return this.test({\n      message,\n      name: 'max',\n      exclusive: true,\n      params: {\n        max\n      },\n      skipAbsent: true,\n      test(value) {\n        return value <= this.resolve(max);\n      }\n    });\n  }\n  lessThan(less, message = number.lessThan) {\n    return this.test({\n      message,\n      name: 'max',\n      exclusive: true,\n      params: {\n        less\n      },\n      skipAbsent: true,\n      test(value) {\n        return value < this.resolve(less);\n      }\n    });\n  }\n  moreThan(more, message = number.moreThan) {\n    return this.test({\n      message,\n      name: 'min',\n      exclusive: true,\n      params: {\n        more\n      },\n      skipAbsent: true,\n      test(value) {\n        return value > this.resolve(more);\n      }\n    });\n  }\n  positive(msg = number.positive) {\n    return this.moreThan(0, msg);\n  }\n  negative(msg = number.negative) {\n    return this.lessThan(0, msg);\n  }\n  integer(message = number.integer) {\n    return this.test({\n      name: 'integer',\n      message,\n      skipAbsent: true,\n      test: val => Number.isInteger(val)\n    });\n  }\n  truncate() {\n    return this.transform(value => !isAbsent(value) ? value | 0 : value);\n  }\n  round(method) {\n    var _method;\n    let avail = ['ceil', 'floor', 'round', 'trunc'];\n    method = ((_method = method) == null ? void 0 : _method.toLowerCase()) || 'round';\n\n    // this exists for symemtry with the new Math.trunc\n    if (method === 'trunc') return this.truncate();\n    if (avail.indexOf(method.toLowerCase()) === -1) throw new TypeError('Only valid options for round() are: ' + avail.join(', '));\n    return this.transform(value => !isAbsent(value) ? Math[method](value) : value);\n  }\n}\ncreate$5.prototype = NumberSchema.prototype;\n\n//\n// Number Interfaces\n//\n\nlet invalidDate = new Date('');\nlet isDate = obj => Object.prototype.toString.call(obj) === '[object Date]';\nfunction create$4() {\n  return new DateSchema();\n}\nclass DateSchema extends Schema {\n  constructor() {\n    super({\n      type: 'date',\n      check(v) {\n        return isDate(v) && !isNaN(v.getTime());\n      }\n    });\n    this.withMutation(() => {\n      this.transform((value, _raw, ctx) => {\n        // null -> InvalidDate isn't useful; treat all nulls as null and let it fail on\n        // nullability check vs TypeErrors\n        if (!ctx.spec.coerce || ctx.isType(value) || value === null) return value;\n        value = parseIsoDate(value);\n\n        // 0 is a valid timestamp equivalent to 1970-01-01T00:00:00Z(unix epoch) or before.\n        return !isNaN(value) ? new Date(value) : DateSchema.INVALID_DATE;\n      });\n    });\n  }\n  prepareParam(ref, name) {\n    let param;\n    if (!Reference.isRef(ref)) {\n      let cast = this.cast(ref);\n      if (!this._typeCheck(cast)) throw new TypeError(`\\`${name}\\` must be a Date or a value that can be \\`cast()\\` to a Date`);\n      param = cast;\n    } else {\n      param = ref;\n    }\n    return param;\n  }\n  min(min, message = date.min) {\n    let limit = this.prepareParam(min, 'min');\n    return this.test({\n      message,\n      name: 'min',\n      exclusive: true,\n      params: {\n        min\n      },\n      skipAbsent: true,\n      test(value) {\n        return value >= this.resolve(limit);\n      }\n    });\n  }\n  max(max, message = date.max) {\n    let limit = this.prepareParam(max, 'max');\n    return this.test({\n      message,\n      name: 'max',\n      exclusive: true,\n      params: {\n        max\n      },\n      skipAbsent: true,\n      test(value) {\n        return value <= this.resolve(limit);\n      }\n    });\n  }\n}\nDateSchema.INVALID_DATE = invalidDate;\ncreate$4.prototype = DateSchema.prototype;\ncreate$4.INVALID_DATE = invalidDate;\n\n// @ts-expect-error\nfunction sortFields(fields, excludedEdges = []) {\n  let edges = [];\n  let nodes = new Set();\n  let excludes = new Set(excludedEdges.map(([a, b]) => `${a}-${b}`));\n  function addNode(depPath, key) {\n    let node = split(depPath)[0];\n    nodes.add(node);\n    if (!excludes.has(`${key}-${node}`)) edges.push([key, node]);\n  }\n  for (const key of Object.keys(fields)) {\n    let value = fields[key];\n    nodes.add(key);\n    if (Reference.isRef(value) && value.isSibling) addNode(value.path, key);else if (isSchema(value) && 'deps' in value) value.deps.forEach(path => addNode(path, key));\n  }\n  return toposort.array(Array.from(nodes), edges).reverse();\n}\n\nfunction findIndex(arr, err) {\n  let idx = Infinity;\n  arr.some((key, ii) => {\n    var _err$path;\n    if ((_err$path = err.path) != null && _err$path.includes(key)) {\n      idx = ii;\n      return true;\n    }\n  });\n  return idx;\n}\nfunction sortByKeyOrder(keys) {\n  return (a, b) => {\n    return findIndex(keys, a) - findIndex(keys, b);\n  };\n}\n\nconst parseJson = (value, _, ctx) => {\n  if (typeof value !== 'string') {\n    return value;\n  }\n  let parsed = value;\n  try {\n    parsed = JSON.parse(value);\n  } catch (err) {\n    /* */\n  }\n  return ctx.isType(parsed) ? parsed : value;\n};\n\n// @ts-ignore\nfunction deepPartial(schema) {\n  if ('fields' in schema) {\n    const partial = {};\n    for (const [key, fieldSchema] of Object.entries(schema.fields)) {\n      partial[key] = deepPartial(fieldSchema);\n    }\n    return schema.setFields(partial);\n  }\n  if (schema.type === 'array') {\n    const nextArray = schema.optional();\n    if (nextArray.innerType) nextArray.innerType = deepPartial(nextArray.innerType);\n    return nextArray;\n  }\n  if (schema.type === 'tuple') {\n    return schema.optional().clone({\n      types: schema.spec.types.map(deepPartial)\n    });\n  }\n  if ('optional' in schema) {\n    return schema.optional();\n  }\n  return schema;\n}\nconst deepHas = (obj, p) => {\n  const path = [...normalizePath(p)];\n  if (path.length === 1) return path[0] in obj;\n  let last = path.pop();\n  let parent = getter(join(path), true)(obj);\n  return !!(parent && last in parent);\n};\nlet isObject = obj => Object.prototype.toString.call(obj) === '[object Object]';\nfunction unknown(ctx, value) {\n  let known = Object.keys(ctx.fields);\n  return Object.keys(value).filter(key => known.indexOf(key) === -1);\n}\nconst defaultSort = sortByKeyOrder([]);\nfunction create$3(spec) {\n  return new ObjectSchema(spec);\n}\nclass ObjectSchema extends Schema {\n  constructor(spec) {\n    super({\n      type: 'object',\n      check(value) {\n        return isObject(value) || typeof value === 'function';\n      }\n    });\n    this.fields = Object.create(null);\n    this._sortErrors = defaultSort;\n    this._nodes = [];\n    this._excludedEdges = [];\n    this.withMutation(() => {\n      if (spec) {\n        this.shape(spec);\n      }\n    });\n  }\n  _cast(_value, options = {}) {\n    var _options$stripUnknown;\n    let value = super._cast(_value, options);\n\n    //should ignore nulls here\n    if (value === undefined) return this.getDefault(options);\n    if (!this._typeCheck(value)) return value;\n    let fields = this.fields;\n    let strip = (_options$stripUnknown = options.stripUnknown) != null ? _options$stripUnknown : this.spec.noUnknown;\n    let props = [].concat(this._nodes, Object.keys(value).filter(v => !this._nodes.includes(v)));\n    let intermediateValue = {}; // is filled during the transform below\n    let innerOptions = Object.assign({}, options, {\n      parent: intermediateValue,\n      __validating: options.__validating || false\n    });\n    let isChanged = false;\n    for (const prop of props) {\n      let field = fields[prop];\n      let exists = (prop in value);\n      if (field) {\n        let fieldValue;\n        let inputValue = value[prop];\n\n        // safe to mutate since this is fired in sequence\n        innerOptions.path = (options.path ? `${options.path}.` : '') + prop;\n        field = field.resolve({\n          value: inputValue,\n          context: options.context,\n          parent: intermediateValue\n        });\n        let fieldSpec = field instanceof Schema ? field.spec : undefined;\n        let strict = fieldSpec == null ? void 0 : fieldSpec.strict;\n        if (fieldSpec != null && fieldSpec.strip) {\n          isChanged = isChanged || prop in value;\n          continue;\n        }\n        fieldValue = !options.__validating || !strict ?\n        // TODO: use _cast, this is double resolving\n        field.cast(value[prop], innerOptions) : value[prop];\n        if (fieldValue !== undefined) {\n          intermediateValue[prop] = fieldValue;\n        }\n      } else if (exists && !strip) {\n        intermediateValue[prop] = value[prop];\n      }\n      if (exists !== prop in intermediateValue || intermediateValue[prop] !== value[prop]) {\n        isChanged = true;\n      }\n    }\n    return isChanged ? intermediateValue : value;\n  }\n  _validate(_value, options = {}, panic, next) {\n    let {\n      from = [],\n      originalValue = _value,\n      recursive = this.spec.recursive\n    } = options;\n    options.from = [{\n      schema: this,\n      value: originalValue\n    }, ...from];\n    // this flag is needed for handling `strict` correctly in the context of\n    // validation vs just casting. e.g strict() on a field is only used when validating\n    options.__validating = true;\n    options.originalValue = originalValue;\n    super._validate(_value, options, panic, (objectErrors, value) => {\n      if (!recursive || !isObject(value)) {\n        next(objectErrors, value);\n        return;\n      }\n      originalValue = originalValue || value;\n      let tests = [];\n      for (let key of this._nodes) {\n        let field = this.fields[key];\n        if (!field || Reference.isRef(field)) {\n          continue;\n        }\n        tests.push(field.asNestedTest({\n          options,\n          key,\n          parent: value,\n          parentPath: options.path,\n          originalParent: originalValue\n        }));\n      }\n      this.runTests({\n        tests,\n        value,\n        originalValue,\n        options\n      }, panic, fieldErrors => {\n        next(fieldErrors.sort(this._sortErrors).concat(objectErrors), value);\n      });\n    });\n  }\n  clone(spec) {\n    const next = super.clone(spec);\n    next.fields = Object.assign({}, this.fields);\n    next._nodes = this._nodes;\n    next._excludedEdges = this._excludedEdges;\n    next._sortErrors = this._sortErrors;\n    return next;\n  }\n  concat(schema) {\n    let next = super.concat(schema);\n    let nextFields = next.fields;\n    for (let [field, schemaOrRef] of Object.entries(this.fields)) {\n      const target = nextFields[field];\n      nextFields[field] = target === undefined ? schemaOrRef : target;\n    }\n    return next.withMutation(s =>\n    // XXX: excludes here is wrong\n    s.setFields(nextFields, [...this._excludedEdges, ...schema._excludedEdges]));\n  }\n  _getDefault(options) {\n    if ('default' in this.spec) {\n      return super._getDefault(options);\n    }\n\n    // if there is no default set invent one\n    if (!this._nodes.length) {\n      return undefined;\n    }\n    let dft = {};\n    this._nodes.forEach(key => {\n      var _innerOptions;\n      const field = this.fields[key];\n      let innerOptions = options;\n      if ((_innerOptions = innerOptions) != null && _innerOptions.value) {\n        innerOptions = Object.assign({}, innerOptions, {\n          parent: innerOptions.value,\n          value: innerOptions.value[key]\n        });\n      }\n      dft[key] = field && 'getDefault' in field ? field.getDefault(innerOptions) : undefined;\n    });\n    return dft;\n  }\n  setFields(shape, excludedEdges) {\n    let next = this.clone();\n    next.fields = shape;\n    next._nodes = sortFields(shape, excludedEdges);\n    next._sortErrors = sortByKeyOrder(Object.keys(shape));\n    // XXX: this carries over edges which may not be what you want\n    if (excludedEdges) next._excludedEdges = excludedEdges;\n    return next;\n  }\n  shape(additions, excludes = []) {\n    return this.clone().withMutation(next => {\n      let edges = next._excludedEdges;\n      if (excludes.length) {\n        if (!Array.isArray(excludes[0])) excludes = [excludes];\n        edges = [...next._excludedEdges, ...excludes];\n      }\n\n      // XXX: excludes here is wrong\n      return next.setFields(Object.assign(next.fields, additions), edges);\n    });\n  }\n  partial() {\n    const partial = {};\n    for (const [key, schema] of Object.entries(this.fields)) {\n      partial[key] = 'optional' in schema && schema.optional instanceof Function ? schema.optional() : schema;\n    }\n    return this.setFields(partial);\n  }\n  deepPartial() {\n    const next = deepPartial(this);\n    return next;\n  }\n  pick(keys) {\n    const picked = {};\n    for (const key of keys) {\n      if (this.fields[key]) picked[key] = this.fields[key];\n    }\n    return this.setFields(picked, this._excludedEdges.filter(([a, b]) => keys.includes(a) && keys.includes(b)));\n  }\n  omit(keys) {\n    const remaining = [];\n    for (const key of Object.keys(this.fields)) {\n      if (keys.includes(key)) continue;\n      remaining.push(key);\n    }\n    return this.pick(remaining);\n  }\n  from(from, to, alias) {\n    let fromGetter = getter(from, true);\n    return this.transform(obj => {\n      if (!obj) return obj;\n      let newObj = obj;\n      if (deepHas(obj, from)) {\n        newObj = Object.assign({}, obj);\n        if (!alias) delete newObj[from];\n        newObj[to] = fromGetter(obj);\n      }\n      return newObj;\n    });\n  }\n\n  /** Parse an input JSON string to an object */\n  json() {\n    return this.transform(parseJson);\n  }\n\n  /**\n   * Similar to `noUnknown` but only validates that an object is the right shape without stripping the unknown keys\n   */\n  exact(message) {\n    return this.test({\n      name: 'exact',\n      exclusive: true,\n      message: message || object.exact,\n      test(value) {\n        if (value == null) return true;\n        const unknownKeys = unknown(this.schema, value);\n        return unknownKeys.length === 0 || this.createError({\n          params: {\n            properties: unknownKeys.join(', ')\n          }\n        });\n      }\n    });\n  }\n  stripUnknown() {\n    return this.clone({\n      noUnknown: true\n    });\n  }\n  noUnknown(noAllow = true, message = object.noUnknown) {\n    if (typeof noAllow !== 'boolean') {\n      message = noAllow;\n      noAllow = true;\n    }\n    let next = this.test({\n      name: 'noUnknown',\n      exclusive: true,\n      message: message,\n      test(value) {\n        if (value == null) return true;\n        const unknownKeys = unknown(this.schema, value);\n        return !noAllow || unknownKeys.length === 0 || this.createError({\n          params: {\n            unknown: unknownKeys.join(', ')\n          }\n        });\n      }\n    });\n    next.spec.noUnknown = noAllow;\n    return next;\n  }\n  unknown(allow = true, message = object.noUnknown) {\n    return this.noUnknown(!allow, message);\n  }\n  transformKeys(fn) {\n    return this.transform(obj => {\n      if (!obj) return obj;\n      const result = {};\n      for (const key of Object.keys(obj)) result[fn(key)] = obj[key];\n      return result;\n    });\n  }\n  camelCase() {\n    return this.transformKeys(camelCase);\n  }\n  snakeCase() {\n    return this.transformKeys(snakeCase);\n  }\n  constantCase() {\n    return this.transformKeys(key => snakeCase(key).toUpperCase());\n  }\n  describe(options) {\n    const next = (options ? this.resolve(options) : this).clone();\n    const base = super.describe(options);\n    base.fields = {};\n    for (const [key, value] of Object.entries(next.fields)) {\n      var _innerOptions2;\n      let innerOptions = options;\n      if ((_innerOptions2 = innerOptions) != null && _innerOptions2.value) {\n        innerOptions = Object.assign({}, innerOptions, {\n          parent: innerOptions.value,\n          value: innerOptions.value[key]\n        });\n      }\n      base.fields[key] = value.describe(innerOptions);\n    }\n    return base;\n  }\n}\ncreate$3.prototype = ObjectSchema.prototype;\n\nfunction create$2(type) {\n  return new ArraySchema(type);\n}\nclass ArraySchema extends Schema {\n  constructor(type) {\n    super({\n      type: 'array',\n      spec: {\n        types: type\n      },\n      check(v) {\n        return Array.isArray(v);\n      }\n    });\n\n    // `undefined` specifically means uninitialized, as opposed to \"no subtype\"\n    this.innerType = void 0;\n    this.innerType = type;\n  }\n  _cast(_value, _opts) {\n    const value = super._cast(_value, _opts);\n\n    // should ignore nulls here\n    if (!this._typeCheck(value) || !this.innerType) {\n      return value;\n    }\n    let isChanged = false;\n    const castArray = value.map((v, idx) => {\n      const castElement = this.innerType.cast(v, Object.assign({}, _opts, {\n        path: `${_opts.path || ''}[${idx}]`\n      }));\n      if (castElement !== v) {\n        isChanged = true;\n      }\n      return castElement;\n    });\n    return isChanged ? castArray : value;\n  }\n  _validate(_value, options = {}, panic, next) {\n    var _options$recursive;\n    // let sync = options.sync;\n    // let path = options.path;\n    let innerType = this.innerType;\n    // let endEarly = options.abortEarly ?? this.spec.abortEarly;\n    let recursive = (_options$recursive = options.recursive) != null ? _options$recursive : this.spec.recursive;\n    options.originalValue != null ? options.originalValue : _value;\n    super._validate(_value, options, panic, (arrayErrors, value) => {\n      var _options$originalValu2;\n      if (!recursive || !innerType || !this._typeCheck(value)) {\n        next(arrayErrors, value);\n        return;\n      }\n\n      // #950 Ensure that sparse array empty slots are validated\n      let tests = new Array(value.length);\n      for (let index = 0; index < value.length; index++) {\n        var _options$originalValu;\n        tests[index] = innerType.asNestedTest({\n          options,\n          index,\n          parent: value,\n          parentPath: options.path,\n          originalParent: (_options$originalValu = options.originalValue) != null ? _options$originalValu : _value\n        });\n      }\n      this.runTests({\n        value,\n        tests,\n        originalValue: (_options$originalValu2 = options.originalValue) != null ? _options$originalValu2 : _value,\n        options\n      }, panic, innerTypeErrors => next(innerTypeErrors.concat(arrayErrors), value));\n    });\n  }\n  clone(spec) {\n    const next = super.clone(spec);\n    // @ts-expect-error readonly\n    next.innerType = this.innerType;\n    return next;\n  }\n\n  /** Parse an input JSON string to an object */\n  json() {\n    return this.transform(parseJson);\n  }\n  concat(schema) {\n    let next = super.concat(schema);\n\n    // @ts-expect-error readonly\n    next.innerType = this.innerType;\n    if (schema.innerType)\n      // @ts-expect-error readonly\n      next.innerType = next.innerType ?\n      // @ts-expect-error Lazy doesn't have concat and will break\n      next.innerType.concat(schema.innerType) : schema.innerType;\n    return next;\n  }\n  of(schema) {\n    // FIXME: this should return a new instance of array without the default to be\n    let next = this.clone();\n    if (!isSchema(schema)) throw new TypeError('`array.of()` sub-schema must be a valid yup schema not: ' + printValue(schema));\n\n    // @ts-expect-error readonly\n    next.innerType = schema;\n    next.spec = Object.assign({}, next.spec, {\n      types: schema\n    });\n    return next;\n  }\n  length(length, message = array.length) {\n    return this.test({\n      message,\n      name: 'length',\n      exclusive: true,\n      params: {\n        length\n      },\n      skipAbsent: true,\n      test(value) {\n        return value.length === this.resolve(length);\n      }\n    });\n  }\n  min(min, message) {\n    message = message || array.min;\n    return this.test({\n      message,\n      name: 'min',\n      exclusive: true,\n      params: {\n        min\n      },\n      skipAbsent: true,\n      // FIXME(ts): Array<typeof T>\n      test(value) {\n        return value.length >= this.resolve(min);\n      }\n    });\n  }\n  max(max, message) {\n    message = message || array.max;\n    return this.test({\n      message,\n      name: 'max',\n      exclusive: true,\n      params: {\n        max\n      },\n      skipAbsent: true,\n      test(value) {\n        return value.length <= this.resolve(max);\n      }\n    });\n  }\n  ensure() {\n    return this.default(() => []).transform((val, original) => {\n      // We don't want to return `null` for nullable schema\n      if (this._typeCheck(val)) return val;\n      return original == null ? [] : [].concat(original);\n    });\n  }\n  compact(rejector) {\n    let reject = !rejector ? v => !!v : (v, i, a) => !rejector(v, i, a);\n    return this.transform(values => values != null ? values.filter(reject) : values);\n  }\n  describe(options) {\n    const next = (options ? this.resolve(options) : this).clone();\n    const base = super.describe(options);\n    if (next.innerType) {\n      var _innerOptions;\n      let innerOptions = options;\n      if ((_innerOptions = innerOptions) != null && _innerOptions.value) {\n        innerOptions = Object.assign({}, innerOptions, {\n          parent: innerOptions.value,\n          value: innerOptions.value[0]\n        });\n      }\n      base.innerType = next.innerType.describe(innerOptions);\n    }\n    return base;\n  }\n}\ncreate$2.prototype = ArraySchema.prototype;\n\n// @ts-ignore\nfunction create$1(schemas) {\n  return new TupleSchema(schemas);\n}\nclass TupleSchema extends Schema {\n  constructor(schemas) {\n    super({\n      type: 'tuple',\n      spec: {\n        types: schemas\n      },\n      check(v) {\n        const types = this.spec.types;\n        return Array.isArray(v) && v.length === types.length;\n      }\n    });\n    this.withMutation(() => {\n      this.typeError(tuple.notType);\n    });\n  }\n  _cast(inputValue, options) {\n    const {\n      types\n    } = this.spec;\n    const value = super._cast(inputValue, options);\n    if (!this._typeCheck(value)) {\n      return value;\n    }\n    let isChanged = false;\n    const castArray = types.map((type, idx) => {\n      const castElement = type.cast(value[idx], Object.assign({}, options, {\n        path: `${options.path || ''}[${idx}]`\n      }));\n      if (castElement !== value[idx]) isChanged = true;\n      return castElement;\n    });\n    return isChanged ? castArray : value;\n  }\n  _validate(_value, options = {}, panic, next) {\n    let itemTypes = this.spec.types;\n    super._validate(_value, options, panic, (tupleErrors, value) => {\n      var _options$originalValu2;\n      // intentionally not respecting recursive\n      if (!this._typeCheck(value)) {\n        next(tupleErrors, value);\n        return;\n      }\n      let tests = [];\n      for (let [index, itemSchema] of itemTypes.entries()) {\n        var _options$originalValu;\n        tests[index] = itemSchema.asNestedTest({\n          options,\n          index,\n          parent: value,\n          parentPath: options.path,\n          originalParent: (_options$originalValu = options.originalValue) != null ? _options$originalValu : _value\n        });\n      }\n      this.runTests({\n        value,\n        tests,\n        originalValue: (_options$originalValu2 = options.originalValue) != null ? _options$originalValu2 : _value,\n        options\n      }, panic, innerTypeErrors => next(innerTypeErrors.concat(tupleErrors), value));\n    });\n  }\n  describe(options) {\n    const next = (options ? this.resolve(options) : this).clone();\n    const base = super.describe(options);\n    base.innerType = next.spec.types.map((schema, index) => {\n      var _innerOptions;\n      let innerOptions = options;\n      if ((_innerOptions = innerOptions) != null && _innerOptions.value) {\n        innerOptions = Object.assign({}, innerOptions, {\n          parent: innerOptions.value,\n          value: innerOptions.value[index]\n        });\n      }\n      return schema.describe(innerOptions);\n    });\n    return base;\n  }\n}\ncreate$1.prototype = TupleSchema.prototype;\n\nfunction create(builder) {\n  return new Lazy(builder);\n}\nfunction catchValidationError(fn) {\n  try {\n    return fn();\n  } catch (err) {\n    if (ValidationError.isError(err)) return Promise.reject(err);\n    throw err;\n  }\n}\nclass Lazy {\n  constructor(builder) {\n    this.type = 'lazy';\n    this.__isYupSchema__ = true;\n    this.spec = void 0;\n    this._resolve = (value, options = {}) => {\n      let schema = this.builder(value, options);\n      if (!isSchema(schema)) throw new TypeError('lazy() functions must return a valid schema');\n      if (this.spec.optional) schema = schema.optional();\n      return schema.resolve(options);\n    };\n    this.builder = builder;\n    this.spec = {\n      meta: undefined,\n      optional: false\n    };\n  }\n  clone(spec) {\n    const next = new Lazy(this.builder);\n    next.spec = Object.assign({}, this.spec, spec);\n    return next;\n  }\n  optionality(optional) {\n    const next = this.clone({\n      optional\n    });\n    return next;\n  }\n  optional() {\n    return this.optionality(true);\n  }\n  resolve(options) {\n    return this._resolve(options.value, options);\n  }\n  cast(value, options) {\n    return this._resolve(value, options).cast(value, options);\n  }\n  asNestedTest(config) {\n    let {\n      key,\n      index,\n      parent,\n      options\n    } = config;\n    let value = parent[index != null ? index : key];\n    return this._resolve(value, Object.assign({}, options, {\n      value,\n      parent\n    })).asNestedTest(config);\n  }\n  validate(value, options) {\n    return catchValidationError(() => this._resolve(value, options).validate(value, options));\n  }\n  validateSync(value, options) {\n    return this._resolve(value, options).validateSync(value, options);\n  }\n  validateAt(path, value, options) {\n    return catchValidationError(() => this._resolve(value, options).validateAt(path, value, options));\n  }\n  validateSyncAt(path, value, options) {\n    return this._resolve(value, options).validateSyncAt(path, value, options);\n  }\n  isValid(value, options) {\n    try {\n      return this._resolve(value, options).isValid(value, options);\n    } catch (err) {\n      if (ValidationError.isError(err)) {\n        return Promise.resolve(false);\n      }\n      throw err;\n    }\n  }\n  isValidSync(value, options) {\n    return this._resolve(value, options).isValidSync(value, options);\n  }\n  describe(options) {\n    return options ? this.resolve(options).describe(options) : {\n      type: 'lazy',\n      meta: this.spec.meta,\n      label: undefined\n    };\n  }\n  meta(...args) {\n    if (args.length === 0) return this.spec.meta;\n    let next = this.clone();\n    next.spec.meta = Object.assign(next.spec.meta || {}, args[0]);\n    return next;\n  }\n  get ['~standard']() {\n    const schema = this;\n    const standard = {\n      version: 1,\n      vendor: 'yup',\n      async validate(value) {\n        try {\n          const result = await schema.validate(value, {\n            abortEarly: false\n          });\n          return {\n            value: result\n          };\n        } catch (err) {\n          if (ValidationError.isError(err)) {\n            return {\n              issues: issuesFromValidationError(err)\n            };\n          }\n          throw err;\n        }\n      }\n    };\n    return standard;\n  }\n}\n\nfunction setLocale(custom) {\n  Object.keys(custom).forEach(type => {\n    // @ts-ignore\n    Object.keys(custom[type]).forEach(method => {\n      // @ts-ignore\n      locale[type][method] = custom[type][method];\n    });\n  });\n}\n\nfunction addMethod(schemaType, name, fn) {\n  if (!schemaType || !isSchema(schemaType.prototype)) throw new TypeError('You must provide a yup schema constructor function');\n  if (typeof name !== 'string') throw new TypeError('A Method name must be provided');\n  if (typeof fn !== 'function') throw new TypeError('Method function must be provided');\n  schemaType.prototype[name] = fn;\n}\n\nexport { ArraySchema, BooleanSchema, DateSchema, Lazy as LazySchema, MixedSchema, NumberSchema, ObjectSchema, Schema, StringSchema, TupleSchema, ValidationError, addMethod, create$2 as array, create$7 as bool, create$7 as boolean, create$4 as date, locale as defaultLocale, getIn, isSchema, create as lazy, create$8 as mixed, create$5 as number, create$3 as object, printValue, reach, create$9 as ref, setLocale, create$6 as string, create$1 as tuple };\n","import * as Yup from 'yup';\r\n\r\n\r\nexport const accountDetailsDataModel = Yup.object({\r\n  displayName: Yup.string().required(),\r\n  userId: Yup.string().required(),\r\n  currency1: Yup.number().required(),\r\n  scriptData: Yup.object({\r\n    isGuest: Yup.boolean().required(),\r\n    isVIP: Yup.boolean().required(), \r\n    userSettings : Yup.object({\r\n      noAds: Yup.boolean().required()\r\n    }).required(),\r\n    currentLegs: Yup\r\n      .array().of(\r\n        Yup.object({\r\n          raceId: Yup.number().required(),\r\n          legNum: Yup.number().required(),\r\n        }),\r\n      )\r\n      .nullable()\r\n      .notRequired(),\r\n    team: Yup\r\n      .object({\r\n        coach: Yup.boolean().notRequired().nullable(),\r\n        name: Yup.string().notRequired().nullable(),\r\n        id: Yup.string().notRequired().nullable(),\r\n      })\r\n      .nullable()\r\n      .notRequired(),\r\n    vsr2: Yup.object({\r\n      rank: Yup.number().required().notRequired().nullable(),\r\n    }),\r\n  }),\r\n});\r\n","import * as Yup from 'yup';\r\n\r\nconst locationSchema = Yup.object({\r\n  date: Yup.number().required(),\r\n  heading: Yup.number().optional(),\r\n  lat: Yup.number().required(),\r\n  lon: Yup.number().required(),\r\n  name: Yup.string().required(),\r\n  countryFlag: Yup.string().required(),\r\n  radius: Yup.number().optional()\r\n});\r\n\r\nexport const boatStatsSchema = Yup.object ({\r\n  weight:Yup.number().required()\r\n});\r\nconst raceIdSchema = Yup.object({\r\n  raceId: Yup.number().required(),\r\n  legNum: Yup.number().required(),\r\n\r\n});\r\nexport const raceSchema = Yup.object({\r\n  raceId: Yup.number().required(),\r\n  legNum: Yup.number().required(),\r\n  limitedAccess: Yup.boolean().optional(),\r\n  legName: Yup.string().required(),\r\n  estimatedTime: Yup.number().required(),\r\n  estimatedLength: Yup.number().required(),\r\n  status: Yup.string().oneOf(['opened', 'started', 'finished', 'ended']).required(),\r\n  startDate: Yup.number().required(),\r\n  start: locationSchema.required(),\r\n  end: locationSchema.required(),\r\n  raceName: Yup.string().required(),\r\n  raceType: Yup.string().required(),\r\n  boat: Yup.object({\r\n    polar_id: Yup.number().required(),\r\n    stats: boatStatsSchema.required()\r\n  }).required(),\r\n  vsrRank: Yup.number().optional(),\r\n  priceLevel: Yup.number().optional(),\r\n  freeCredits: Yup.number().optional(),\r\n  adStartCredits: Yup.number().optional(),\r\n  pilotBoatCredits: Yup.number().optional(),\r\n  lastUpdate: Yup.number().required(),\r\n  skinDiscount: Yup.number().optional(),\r\n  fineWinds: Yup.boolean().optional(),\r\n  nbTotalSkippers: Yup.number().required(),\r\n  boatsAtSea: Yup.number().required(),\r\n  arrived: Yup.number().required()\r\n});\r\n\r\nconst scriptDataSchema = Yup.object({\r\n  boatsAtSea: Yup.number().required(),\r\n  res: Yup.array().of(raceSchema).required()\r\n});\r\n\r\nexport const legListDataModel = Yup.object({\r\n  scriptData: scriptDataSchema.required(),\r\n  '@class': Yup.string().required(),\r\n  requestId: Yup.string().required()\r\n});\r\n\r\n\r\n","import * as Yup from 'yup';\r\n\r\nexport const latlonSchema = Yup.object({\r\n  lat: Yup.number().required(),\r\n  lon: Yup.number().required()\r\n});","import * as Yup from 'yup';\r\nimport {latlonSchema} from './datasModel.js';\r\nimport {boatStatsSchema} from './getLegList.js';\r\n\r\n\r\n\r\nconst checkpointSchema = Yup.object({\r\n  id: Yup.number().required(),\r\n  group: Yup.number().required(),\r\n  name: Yup.mixed().nullable(true), // string ou number ou vide\r\n  start: latlonSchema.required(),\r\n  end: latlonSchema.required(),\r\n  engine: Yup.boolean().required(),\r\n  display: Yup.string().required(),\r\n  ranking: Yup.boolean().required(),\r\n  side: Yup.string().oneOf(['port', 'stbd']).required()\r\n});\r\n\r\n\r\nconst restrictedAeraPointSchema = Yup.object({\r\n  name: Yup.string().optional(),\r\n  color: Yup.string().optional(),\r\n  bbox: Yup.array(Yup.number()).optional(),\r\n  vertices: Yup.array().of(latlonSchema).optional()\r\n});\r\n\r\nexport const legSchema = Yup.object({\r\n  _id: Yup.object({\r\n    race_id: Yup.number().required(),\r\n    num: Yup.number().required()\r\n  }).required(),\r\n  _updatedAt: Yup.string().required(), // ISO Date\r\n  boat: Yup.object({\r\n    polar_id: Yup.number().required(),\r\n    stats: boatStatsSchema.required()\r\n  }).required(),\r\n  checkpoints: Yup.array().of(checkpointSchema).required(),\r\n  course: Yup.array().of(latlonSchema).required(),\r\n  close: Yup.object({\r\n    date: Yup.number().required()\r\n  }).required(),\r\n  end: Yup.object({\r\n    date: Yup.number().required(),\r\n    lat: Yup.number().required(),\r\n    lon: Yup.number().required(),\r\n    name: Yup.string().required(),\r\n    radius: Yup.number().required(),\r\n    countryCode: Yup.string().required()\r\n  }).required(),\r\n  freeCredits: Yup.number().required(),\r\n  ice_limits: Yup.object({\r\n    maxLat: Yup.number().required(),\r\n    minLat: Yup.number().required(),\r\n    north: Yup.array().of(latlonSchema).required(),\r\n    south: Yup.array().of(latlonSchema).required()\r\n  }).required(),\r\n  lastUpdate: Yup.number().required(),\r\n  name: Yup.string().required(),\r\n  open: Yup.object({\r\n    date: Yup.number().required()\r\n  }).required(),\r\n  optionPrices: Yup.object().shape({}).required(), // clé dynamique, on valide tout objet\r\n  pilotBoatCredits: Yup.number().required(),\r\n  priceLevel: Yup.number().required(),\r\n  race: Yup.object({\r\n    name: Yup.string().required(),\r\n    type: Yup.string().required()\r\n  }).required(),\r\n  start: Yup.object({\r\n    date: Yup.number().required(),\r\n    heading: Yup.number().required(),\r\n    lat: Yup.number().required(),\r\n    lon: Yup.number().required(),\r\n    name: Yup.string().required(),\r\n    countryCode: Yup.string().required()\r\n  }).required(),\r\n  status: Yup.string().required(),\r\n  vsrLevel: Yup.number().required(),\r\n  estimatedLength: Yup.number().required(),\r\n  estimatedTime: Yup.number().required(),\r\n  fineWinds: Yup.boolean().required(),\r\n  restrictedZones: Yup.array().of(restrictedAeraPointSchema).optional()\r\n});\r\n\r\nexport const endLegPrepDataModel = Yup.object({\r\n  scriptData: Yup.object({\r\n    leg: legSchema.required()\r\n  }).required(),\r\n  '@class': Yup.string().required(),\r\n  requestId: Yup.string().required()\r\n});\r\n","import * as Yup from 'yup';\r\nimport {latlonSchema} from './datasModel.js';\r\nimport {legSchema} from './getEndLegPrep.js';\r\n\r\n\r\nexport const getBoatInfosRequestDataSchema = Yup.object({\r\n  infos: Yup.string().required(),\r\n  leg_num: Yup.number().required(),\r\n  race_id: Yup.number().required(),\r\n  user_id: Yup.string().required(),\r\n});\r\n\r\nexport const getBoatInfosResponseSchema = Yup.object({\r\n  res: Yup.object({\r\n    ba: Yup.mixed().notRequired().nullable(),\r\n    bs: Yup.mixed()\r\n      .notRequired()\r\n      .transform((value, originalValue) => {\r\n        if (originalValue == null) return undefined;\r\n        try {\r\n          return getBoatInfosBoatStateSchema.validateSync(originalValue, { stripUnknown: true });\r\n        } catch (e) {\r\n          throw new Yup.ValidationError(e.errors, originalValue, 'res.bs');\r\n        }\r\n      }),\r\n    engine: Yup.mixed()\r\n    .required()\r\n    .transform((value, originalValue) => {\r\n      if (originalValue == null) return undefined;\r\n      try {\r\n        return getBoatInfosBoatEngineSchema.validateSync(originalValue, { stripUnknown: true });\r\n      } catch (e) {\r\n        throw new Yup.ValidationError(e.errors, originalValue, 'res.engine');\r\n      }\r\n    }),\r\n    leg: Yup.mixed().notRequired()\r\n    .transform((value, originalValue) => {\r\n      if (originalValue == null) return undefined;\r\n      try {\r\n        return legSchema.validateSync(originalValue, { stripUnknown: true });\r\n      } catch (e) {\r\n        throw new Yup.ValidationError(e.errors, originalValue, 'res.leg');\r\n      }\r\n    }),\r\n    track: Yup.mixed().notRequired()\r\n    .transform((value, originalValue) => {\r\n      if (originalValue == null) return undefined;\r\n      try {\r\n        return getBoatInfosBoatTrackSchema.validateSync(originalValue, { stripUnknown: true });\r\n      } catch (e) {\r\n        throw new Yup.ValidationError(e.errors, originalValue, 'res.leg');\r\n      }\r\n    }),\r\n  }),\r\n});\r\n\r\nexport const getBoatInfosBoatStateSchema = Yup.object({\r\n  _id: Yup.object({\r\n    user_id: Yup.string().required(),\r\n    race_id: Yup.number().required(),\r\n    leg_num: Yup.number().required()\r\n  }).required(),\r\n  displayName: Yup.string().required(),\r\n  distanceFromStart: Yup.number().notRequired().nullable(),\r\n  distanceToEnd: Yup.number().notRequired().nullable(),\r\n  gateGroupCounters: Yup.array(Yup.number().required()).notRequired().nullable(),\r\n  hasPermanentAutoSails: Yup.boolean().notRequired().nullable(),\r\n  heading: Yup.number().required(),\r\n  lastCalcDate: Yup.number().notRequired().nullable(),\r\n  legStartDate: Yup.number().notRequired().nullable(),\r\n  pos: latlonSchema.required(),\r\n  rank: Yup.number().notRequired().nullable(),\r\n  sail: Yup.number().required(),\r\n  isRegulated: Yup.boolean().notRequired().nullable(),\r\n  speed: Yup.number().required(),\r\n  stamina: Yup.number().notRequired().nullable(),\r\n  startDate: Yup.number().notRequired().nullable(),\r\n  state: Yup.string().required(),\r\n  tsLastAction: Yup.number().notRequired().nullable(),\r\n  tsEndOfAutoSail: Yup.number().notRequired().nullable(),\r\n  tsEndOfSailChange: Yup.number().notRequired().nullable(),\r\n  tsEndOfGybe: Yup.number().notRequired().nullable(),\r\n  tsEndOfTack: Yup.number().notRequired().nullable(),\r\n  twa: Yup.number().notRequired().nullable(),\r\n  twaAuto: Yup.number().notRequired().nullable(),\r\n  twd: Yup.number().notRequired().nullable(),\r\n  tws: Yup.number().notRequired().nullable(),\r\n // type: Yup.string().required(),\r\n  aground: Yup.boolean().notRequired().nullable(),\r\n  badSail: Yup.boolean().notRequired().nullable(),\r\n  isFollowed : Yup.boolean().notRequired().nullable(),\r\n  followed : Yup.boolean().notRequired().nullable(),\r\n  team :  Yup.boolean().notRequired().nullable(),\r\n  fullOptions  : Yup.boolean().notRequired().nullable(),\r\n  options: Yup.array(Yup.string().required()).notRequired().nullable(),\r\n  branding : Yup.object({\r\n    name: Yup.string().notRequired().nullable()\r\n  }).notRequired().nullable(),\r\n  waypoints:Yup.array().of(latlonSchema).notRequired(),\r\n  nextWpIdx: Yup.number().notRequired().nullable(),\r\n  lastWpIdx: Yup.number().notRequired().nullable(),\r\n\r\n  stats: Yup\r\n    .object({\r\n      staminaMax: Yup.number().notRequired().nullable(),\r\n      staminaTemp: Yup\r\n        .array(\r\n          Yup.object({\r\n            exp: Yup.number().required(),\r\n            value: Yup.number().required(),\r\n          }),\r\n        )\r\n        .notRequired()\r\n        .nullable(),\r\n      staminaMaxEffects: Yup\r\n        .array(\r\n          Yup.object({\r\n            exp: Yup.number().required(),\r\n            value: Yup.number().required(),\r\n          }),\r\n        )\r\n        .notRequired()\r\n        .nullable(),\r\n    })\r\n    .notRequired()\r\n    .nullable(),\r\n});\r\n\r\nexport const getBoatInfosBoatEngineSchema = Yup.object({\r\n  lastCalc: Yup.number().required(),\r\n  lastFineWindUpdate: Yup.number().required(),\r\n  lastWindUpdate: Yup.number().required(),\r\n  nextCalc: Yup.number().required(),\r\n});\r\n\r\nexport const getBoatInfosBoatTrackSchema = Yup.object({\r\n  track: Yup.array(\r\n    Yup.object({\r\n      lat: Yup.number().required(),\r\n      lon: Yup.number().required(),\r\n      ts: Yup.number().required(),\r\n      tag: Yup.string().required(),\r\n    }),\r\n  ),\r\n});\r\n/*\r\nexport const toProg = ({\r\n  raceId,\r\n  userId,\r\n  data,\r\n  iterationTimestamp,\r\n}: {\r\n  raceId: string;\r\n  userId: string;\r\n  data: BoatAction[];\r\n  iterationTimestamp?: number;\r\n}): Prog => {\r\n  const prog: ProgWithoutSerial = {\r\n    raceId,\r\n    userId,\r\n    id: \"vr\",\r\n    label: \"Prog VR\",\r\n    iterationTimestamp,\r\n    data: {\r\n      progs: [],\r\n      wps: [],\r\n    },\r\n  };\r\n\r\n  for (const d of data) {\r\n    if (\"sail_id\" in d) {\r\n      prog.data.progs.push(\r\n        d.sail_id === 10\r\n          ? {\r\n              type: \"autoSail\",\r\n              timestamp: d._id.ts,\r\n            }\r\n          : {\r\n              type: \"sail\",\r\n              sailId: d.sail_id,\r\n              timestamp: d._id.ts,\r\n            },\r\n      );\r\n    } else if (\"pos\" in d) {\r\n      prog.data.wps = d.pos.map(\r\n        (p): ProgWp => ({\r\n          lat: p.lat,\r\n          lon: p.lon,\r\n          idx: p.idx,\r\n        }),\r\n      );\r\n    } else if (\"isProg\" in d) {\r\n      prog.data.progs.push({\r\n        type: \"heading\",\r\n        timestamp: d._id.ts,\r\n        deg: d.deg,\r\n        autoTwa: d.autoTwa,\r\n        isProg: d.isProg,\r\n      });\r\n    }\r\n  }\r\n\r\n  const progWithHash: Prog = {\r\n    ...prog,\r\n    serialized: JSON.stringify(prog.data),\r\n  };\r\n\r\n  return progWithHash;\r\n};\r\n*/","import * as Yup from 'yup';\r\n\r\nconst numberRecord = Yup.object()\r\n  .test('is-number-record', 'must be a record<number>', (val) =>\r\n    val != null &&\r\n    typeof val === 'object' &&\r\n    !Array.isArray(val) &&\r\n    Object.values(val).every((v) => typeof v === 'number')\r\n  );\r\n\r\nexport const gameSettingsSchema = Yup.object({\r\n  scriptData: Yup.object({\r\n    rc: Yup.string().oneOf(['ok']).required(),\r\n    settings: Yup.object({\r\n      lastUpdateTS: Yup.number().required(),\r\n\r\n      stamina: Yup.object({\r\n        recovery: Yup.object({\r\n          points: Yup.number().required(),\r\n          loWind: Yup.number().required(),\r\n          hiWind: Yup.number().required(),\r\n          loTime: Yup.number().required(),\r\n          hiTime: Yup.number().required(),\r\n        }).required(),\r\n\r\n        tiredness: Yup.array()\r\n          .of(Yup.number().required())\r\n          .length(2)\r\n          .required(),\r\n\r\n        consumption: Yup.object({\r\n          points: Yup.object({\r\n            tack: Yup.number().required(),\r\n            gybe: Yup.number().required(),\r\n            sail: Yup.number().required(),\r\n          }).required(),\r\n\r\n          // Dicts \"clé numérique (stringifiée) -> number\"\r\n          winds: numberRecord.required(),\r\n          boats: numberRecord.required(),\r\n        }).required(),\r\n\r\n        impact: numberRecord.required(),\r\n      }).required(),\r\n\r\n      inRaceConsumablesShop: Yup.array()\r\n        .of(\r\n          Yup.object({\r\n            id: Yup.string().required(),\r\n            name: Yup.string().required(),\r\n          }).required()\r\n        )\r\n        .required(),\r\n    }).required(),\r\n  }).required(),\r\n});\r\n\r\n\r\n","import * as Yup from 'yup';\r\n\r\n// export const mapAddBoatActionsToProg = ()\r\n\r\nexport const addBoatActionRequestData = Yup.object({\r\n  race_id: Yup.number().required(),\r\n  leg_num: Yup.number().required(),\r\n  ts: Yup.number().required(),\r\n  playerId: Yup.string().required(),\r\n});\r\n\r\nexport const boatActionStartSchema = Yup.object({\r\n  _id: Yup.object({\r\n    user_id: Yup.string().required(),\r\n    action: Yup.string().oneOf([\"start\"]).required(),\r\n    ts: Yup.number().required(),\r\n    race_id: Yup.number().required(),\r\n    leg_num: Yup.number().required(),\r\n  }),\r\n});\r\n\r\nexport const boatActionHeadingSchema = Yup.object({\r\n  autoTwa: Yup.boolean().required(),\r\n  deg: Yup.number().required(),\r\n  isProg: Yup.boolean().required(),\r\n  _id: Yup.object({\r\n    user_id: Yup.string().required(),\r\n    action: Yup.string().oneOf([\"heading\"]).required(),\r\n    ts: Yup.number().required(),\r\n    race_id: Yup.number().required(),\r\n    leg_num: Yup.number().required(),\r\n  }),\r\n});\r\n\r\nexport const boatActionSailSchema = Yup.object({\r\n  qty: Yup.number().required().notRequired(),\r\n  sail_id: Yup.number().required(),\r\n  _id: Yup.object({\r\n    user_id: Yup.string().required(),\r\n    action: Yup.string().oneOf([\"sail\"]).required(),\r\n    ts: Yup.number().required(),\r\n    race_id: Yup.number().required(),\r\n    leg_num: Yup.number().required(),\r\n  }),\r\n});\r\n\r\nexport const boatActionWpSchema = Yup.object({\r\n  pos: Yup.array(\r\n    Yup.object({\r\n      lat: Yup.number().required(),\r\n      lon: Yup.number().required(),\r\n      idx: Yup.number().required(),\r\n    }),\r\n  ),\r\n  _id: Yup.object({\r\n    user_id: Yup.string().required(),\r\n    race_id: Yup.number().required(),\r\n    leg_num: Yup.number().required(),\r\n    ts: Yup.number().required(),\r\n    action: Yup.string().oneOf([\"wp\"]).required(),\r\n  }),\r\n});\r\n\r\nconst boatActionSchema = Yup.mixed().test(\r\n  'is-valid-action',\r\n  'Invalid boat action format',\r\n  function (value) {\r\n    const schemas = [\r\n      boatActionHeadingSchema,\r\n      boatActionSailSchema,\r\n      boatActionWpSchema,\r\n      boatActionStartSchema,\r\n    ];\r\n\r\n    for (const schema of schemas) {\r\n      try {\r\n        schema.validateSync(value, { strict: true });\r\n        return true; // dès qu'un schéma valide : succès\r\n      } catch (_) {\r\n        // ignore\r\n      }\r\n    }\r\n\r\n    return this.createError({ message: 'Aucune des formes attendues pour boatAction n’est valide' });\r\n  }\r\n);\r\n\r\n// 👇 Tableau d’actions\r\nexport const boatActionsSchema = Yup.array().of(boatActionSchema);\r\n\r\nexport const boatActionResponseData = Yup.object({\r\n  scriptData: Yup.object({\r\n    actionTs: Yup.number().required(),\r\n    serverTs: Yup.number().required(),\r\n    boatActions: Yup.array(boatActionSchema),\r\n  }),\r\n});\r\n","import * as Yup from 'yup';\r\nimport {latlonSchema} from './datasModel.js';\r\n\r\n\r\nexport const getFleetRequestDataSchema = Yup.object({\r\n  filter: Yup.string().required(),\r\n  leg_num: Yup.number().required(),\r\n  race_id: Yup.number().required(),\r\n  user_id: Yup.string().required(),\r\n  vip: Yup.boolean().required(),\r\n  followed: Yup.array(Yup.string().required()).nullable(),\r\n  teamMembers: Yup.array(Yup.string().required()).nullable(),\r\n});\r\n\r\nexport const getFleetResponseSchema = Yup.object({\r\n  res: Yup.array(\r\n    Yup.object({\r\n      userId: Yup.string().required(),\r\n      displayName: Yup.string().notRequired(),\r\n      type: Yup.string().required(),\r\n      lastCalcDate: Yup.number().notRequired(),\r\n      pos: latlonSchema.required(),\r\n      heading: Yup.number().required(),\r\n      speed: Yup.number().required(),\r\n      state: Yup.string().required(),\r\n      tws: Yup.number().notRequired().nullable(),\r\n      twa: Yup.number().notRequired().nullable(),\r\n      twd: Yup.number().notRequired().nullable(),\r\n      sail: Yup.number().notRequired().nullable(),\r\n      rank: Yup.number().notRequired().nullable(),\r\n      state: Yup.string().required(),\r\n      isFollowed : Yup.boolean().notRequired().nullable(),\r\n      followed : Yup.boolean().notRequired().nullable(),\r\n      team : Yup.boolean().notRequired().nullable(),\r\n      type : Yup.string().notRequired()\r\n\r\n    }),\r\n  ),\r\n});\r\n","import * as Yup from 'Yup';\r\n\r\nexport const polarSchema = Yup.object({\r\n  _id: Yup.number().required(),\r\n  label: Yup.string().required(),\r\n  globalSpeedRatio: Yup.number().required(),\r\n  iceSpeedRatio: Yup.number().required(),\r\n  autoSailChangeTolerance: Yup.number().required(),\r\n  badSailTolerance: Yup.number().required(),\r\n  maxSpeed: Yup.number().required(),\r\n  weight:Yup.number().optional(),\r\n  foil: Yup.object({\r\n    speedRatio: Yup.number().required(),\r\n    twaMin: Yup.number().required(),\r\n    twaMax: Yup.number().required(),\r\n    twaMerge: Yup.number().required(),\r\n    twsMin: Yup.number().required(),\r\n    twsMax: Yup.number().required(),\r\n    twsMerge: Yup.number().required(),\r\n  }),\r\n  hull: Yup.object({\r\n    speedRatio: Yup.number().required(),\r\n  }),\r\n  winch: Yup.object({\r\n    tack: Yup.object({\r\n      std: Yup.object({\r\n        lw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n        hw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n      }),\r\n      pro: Yup.object({\r\n        lw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n        hw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n      }),\r\n    }),\r\n    gybe: Yup.object({\r\n      std: Yup.object({\r\n        lw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n        hw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n      }),\r\n      pro: Yup.object({\r\n        lw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n        hw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n      }),\r\n    }),\r\n    sailChange: Yup.object({\r\n      std: Yup.object({\r\n        lw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n        hw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n      }),\r\n      pro: Yup.object({\r\n        lw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n        hw: Yup.object({\r\n          ratio: Yup.number().required(),\r\n          timer: Yup.number().required(),\r\n        }),\r\n      }),\r\n    }),\r\n    lws: Yup.number().required(),\r\n    hws: Yup.number().required(),\r\n  }),\r\n  tws: Yup.array(Yup.number().required()),\r\n  twa: Yup.array(Yup.number().required()),\r\n  sail: Yup.array(\r\n    Yup.object({\r\n      id: Yup.number().required(),\r\n      name: Yup.string().required(),\r\n      speed: Yup.array(Yup.array(Yup.number().required())),\r\n    }),\r\n  ),\r\n  _updatedAt: Yup.string().required(),\r\n});\r\n\r\nexport const getPolarResponseSchema = Yup.object({\r\n  scriptData: Yup.object({\r\n    polar: polarSchema,\r\n  }),\r\n});\r\n","\r\nimport { accountDetailsDataModel } from './ingesterModels/accountDetails.js';\r\nimport { legListDataModel ,raceSchema} from './ingesterModels/getLegList.js';\r\nimport { endLegPrepDataModel } from './ingesterModels/getEndLegPrep.js';\r\nimport {processDBOperations,getData} from '../../common/dbOpes.js';\r\nimport {getBoatInfosRequestDataSchema,\r\n        getBoatInfosResponseSchema,\r\n        getBoatInfosBoatStateSchema,\r\n        getBoatInfosBoatEngineSchema,\r\n        getBoatInfosBoatTrackSchema} from './ingesterModels/getBoatInfos.js';\r\nimport {gameSettingsSchema } from './ingesterModels/getGameSettings.js'\r\nimport {boatActionResponseData } from './ingesterModels/boatAction.js'\r\n\r\n/* addBoatActionResponseData */ \r\nimport { getFleetRequestDataSchema, getFleetResponseSchema } from './ingesterModels/getFleet.js';\r\nimport { polarSchema} from './ingesterModels/polar.js';\r\nimport cfg from '@/config.json';\r\n\r\n\r\nexport function ingestPolars(msgBody)\r\n{\r\n  const polarsData = msgBody?.scriptData?.extendsData?.boatPolar;\r\n\r\n  if(!polarsData) return;\r\n  polarSchema.validate(polarsData,{stripUnknow:true})\r\n  .then(polar => {\r\n      const dbOpe = [\r\n          {\r\n              type : \"putOrUpdate\",\r\n              polars : [\r\n                  {\r\n                    id : polar._id,\r\n                    label: polar.label,\r\n                    globalSpeedRatio: polar.globalSpeedRatio,\r\n                    iceSpeedRatio: polar.iceSpeedRatio,\r\n                    autoSailChangeTolerance: polar.autoSailChangeTolerance,\r\n                    badSailTolerance: polar.badSailTolerance,\r\n                    maxSpeed: polar.maxSpeed,\r\n                    foil: polar.foil,\r\n                    hull: polar.hull,\r\n                    winch: polar.winch,\r\n                    tws: polar.tws,\r\n                    twa: polar.twa,\r\n                    sail: polar.sail,\r\n                    _updatedAt: polar._updatedAt\r\n                  }\r\n              ],\r\n              internal : [\r\n                {\r\n                  id : \"polarsUpdate\",\r\n                  ts : Date.now()\r\n                }\r\n              ]\r\n          }\r\n      ];\r\n      processDBOperations(dbOpe);\r\n    })\r\n    .catch(error => {\r\n        if(cfg.debugIngesterErr) console.error('Account Validation Error :', error);\r\n    });\r\n}\r\n\r\nexport async function ingestBoatInfos(boatData)\r\n{\r\n  const ope= [];\r\n  let rstTimer = false;\r\n  let raceId = null;\r\n  let legNum = null;\r\n  let userId = null;\r\n\r\n  try {\r\n    const boatInfos = await getBoatInfosResponseSchema.validate(boatData, {\r\n      stripUnknown: true,\r\n      abortEarly: false\r\n    });\r\n\r\n    let currendId = await getData('internal', 'lastLoggedUser');\r\n    currendId = currendId?.loggedUser;\r\n    if(boatInfos.res?.leg) {\r\n      const l = boatInfos.res.leg;\r\n      \r\n      raceId = l.race_id;\r\n      legNum = l.leg_num;\r\n\r\n      ope.push( {\r\n        type : \"putOrUpdate\",\r\n        legList: [\r\n          {\r\n  //          key:[l.race_id,l.leg_num], \r\n            id: `${l._id.race_id}-${l._id.num}`,\r\n            raceId: l._id.race_id,\r\n            legNum: l._id.num,\r\n            status: l.status,\r\n            legName: l.name,\r\n            raceName: l.race.name,\r\n            raceType: l.race.type,\r\n            vsrLevel: l.vsrLevel,\r\n            estimatedTime: l.estimatedTime,\r\n            estimatedLength: l.estimatedLength,\r\n            fineWinds: l.fineWinds,\r\n            start: l.start,\r\n            end: l.end,\r\n            close: l.close,\r\n            open: l.open,\r\n            polar_id: l.boat?.polar_id,\r\n            pilotBoatCredits: l.pilotBoatCredits,\r\n            priceLevel: l.priceLevel,\r\n            freeCredits: l.freeCredits,\r\n            lastUpdate: l.lastUpdate,\r\n            optionPrices: l.optionPrices,\r\n            checkpoints: l.checkpoints,\r\n            ice_limits: l.ice_limits,\r\n            fineWinds: l.fineWinds,\r\n            course: l.course,\r\n            restrictedZones : l.restrictedZones ?? null\r\n          },\r\n        ],\r\n        ...((l.boat?.stats?.weight && l.boat?.polar_id) && {\r\n          polars: [\r\n              {\r\n//                key: l.boat.polar_id,\r\n                id: l.boat.polar_id,\r\n                weight : l.boat.stats.weight\r\n              }\r\n          ]\r\n        }),\r\n        internal: [\r\n          {\r\n            id: \"legListUpdate\",\r\n            ts: Date.now(),\r\n          },\r\n          ...((l.boat?.stats?.weight && l.boat?.polar_id)\r\n            ? [{\r\n                id: \"polarsUpdate\",\r\n                ts: Date.now(),\r\n              }]\r\n            : [])\r\n        ]        \r\n      });\r\n    }\r\n\r\n    if(boatInfos.res?.bs && !boatInfos.res.bs.lastCalcDate) boatInfos.res.bs.lastCalcDate = Date.now();\r\n\r\n    if(boatInfos.res?.leg && boatInfos.res?.bs)\r\n    {\r\n      const bs = boatInfos.res.bs;\r\n      const l = boatInfos.res.leg;\r\n      \r\n      raceId = l.race_id;\r\n      legNum = l.leg_num;\r\n      userId = bs._id.user_id;\r\n      currendId = bs._id.user_id;\r\n      ope.push( {\r\n        type : \"putOrUpdate\",\r\n        internal : [\r\n          {\r\n            id : 'lastLoggedUser',\r\n            loggedUser : bs._id.user_id \r\n          },\r\n          { \r\n            id : 'lastOpennedRace',\r\n            lastOpennedRace : `${l._id.race_id}-${l._id.num}` ,\r\n            raceId : l._id.race_id,\r\n            legNum : l._id.num,\r\n          },\r\n          {\r\n            id: \"playersUpdate\",\r\n            ts: Date.now(),\r\n          },\r\n          {\r\n            id : 'state',\r\n            state : 'raceOpened'\r\n          },\r\n        ],\r\n        players : [\r\n          {                       \r\n//            key: bs._id.user_id,   \r\n            id : bs._id.user_id,\r\n            name : bs.displayName,\r\n            timestamp: Date.now(),\r\n//                  isVip : validAccount.scriptData.isVIP && validAccount.scriptData.userSettings?.noAds,\r\n//            credits : bs.currency1\r\n          }      \r\n        ],\r\n      });\r\n      \r\n    }\r\n    if(boatInfos.res?.bs) {\r\n      const bs = boatInfos.res.bs;\r\n      //todo manage player and track\r\n\r\n      raceId = bs._id.race_id;\r\n      legNum = bs._id.leg_num;\r\n      userId = bs._id.user_id;\r\n      if(bs._id.user_id == currendId)\r\n      {\r\n        rstTimer = true;\r\n        if(bs.fullOptions)\r\n        {\r\n          bs.options = [\"foil\",\"heavy\",\"hull\",\"light\",\"reach\",\r\n                        \"winch\",\"comfortLoungePug\",\"magicFurler\",\"vrtexJacket\"\r\n          ];\r\n        }\r\n        ope.push( {\r\n          type : \"putOrUpdate\",\r\n          legPlayersInfos : [\r\n            {\r\n//              key:[bs._id.race_id,bs._id.leg_num,bs._id.user_id,bs.lastCalcDate],   \r\n              id: bs._id.race_id+\"_\"+bs._id.leg_num+\"_\"+bs._id.user_id+\"_\"+bs.lastCalcDate,\r\n              userId: bs._id.user_id,\r\n              iteDate: bs.lastCalcDate,\r\n              raceId: bs._id.race_id,\r\n              legNum: bs._id.leg_num,\r\n              distanceFromStart: bs.distanceFromStart,\r\n              distanceToEnd: bs.distanceToEnd,\r\n              gateGroupCounters: bs.gateGroupCounters,\r\n              hasPermanentAutoSails: bs.hasPermanentAutoSails,\r\n              hdg: bs.heading,\r\n              legStartDate: bs.legStartDate,\r\n              pos: bs.pos,\r\n              rank: bs.rank,\r\n              sail: bs.sail,\r\n              isRegulated: bs.isRegulated ?? null,\r\n              speed: bs.speed,\r\n              stamina: bs.stamina,\r\n              startDate: bs.startDate,\r\n              state: bs.state,\r\n              tsEndOfAutoSail: bs.tsEndOfAutoSail ?? null,\r\n              tsEndOfSailChange: bs.tsEndOfSailChange ?? null,\r\n              tsEndOfGybe: bs.tsEndOfGybe ?? null,\r\n              tsEndOfTack: bs.tsEndOfTack ?? null,\r\n              twa: bs.twa,\r\n              twaAuto: bs.twaAuto ?? null,\r\n              twd: bs.twd,\r\n              tws: bs.tws,\r\n              aground: bs.aground,\r\n              badSail: bs.badSail ?? null,\r\n              waypoints: bs.waypoints ?? null,\r\n              nextWpIdx: bs.nextWpIdx ?? null,\r\n              lastWpIdx: bs.lastWpIdx ?? null,\r\n              stats: bs.stats,\r\n              choice : true,\r\n              branding : bs.branding\r\n            }\r\n          ],\r\n          ...((bs.options && bs.options.length >0) && {\r\n            legPlayersOptions: [\r\n                {\r\n                  raceId : bs._id.race_id,\r\n                  legNum : bs._id.leg_num,\r\n                  userId : bs._id.user_id,\r\n                  id: bs._id.race_id+\"_\"+bs._id.leg_num+\"_\"+bs._id.user_id+\"_\"+bs.lastCalcDate,\r\n                  options: {\r\n                    foil:  bs.options?.includes(\"foil\") ?? false,\r\n                    heavy: bs.options?.includes(\"heavy\") ?? false,\r\n                    hull:  bs.options?.includes(\"hull\") ?? false,\r\n                    light: bs.options?.includes(\"light\") ?? false,\r\n                    reach: bs.options?.includes(\"reach\") ?? false,\r\n                    winch: bs.options?.includes(\"winch\") ?? false,\r\n                    comfortLoungePug: bs.options?.includes(\"comfortLoungePug\") ?? false,\r\n                    magicFurler: bs.options?.includes(\"magicFurler\") ?? false,\r\n                    vrtexJacket: bs.options?.includes(\"vrtexJacket\") ?? false,\r\n                  },\r\n                  timestamp : bs.lastCalcDate\r\n                }\r\n            ]\r\n          }),\r\n          internal: [\r\n            {\r\n              id: \"legPlayersInfosUpdate\",\r\n              ts: Date.now(),\r\n            },\r\n            ...((bs.options && bs.options.length >0) \r\n              ? [{\r\n                  id: \"legPlayersOptionsUpdate\",\r\n                  ts: Date.now(),\r\n                }]\r\n              : [])\r\n          ]\r\n        });\r\n      } else\r\n      {\r\n        ope.push( {\r\n          type : \"putOrUpdate\",\r\n          legFleetInfos : [\r\n            {\r\n//              key:[bs._id.race_id,bs._id.leg_num,bs._id.user_id,bs.lastCalcDate],   \r\n              id: bs._id.race_id+\"_\"+bs._id.leg_num+\"_\"+bs._id.user_id+\"_\"+bs.lastCalcDate,\r\n              userId: bs._id.user_id,\r\n              iteDate: bs.lastCalcDate,\r\n              raceId: bs._id.race_id,\r\n              legNum: bs._id.leg_num,\r\n              distanceFromStart: bs.distanceFromStart,\r\n              distanceToEnd: bs.distanceToEnd,\r\n              hasPermanentAutoSails: bs.hasPermanentAutoSails,\r\n              hdg: bs.heading,\r\n              pos: bs.pos,\r\n              rank: bs.rank ?? null,\r\n              sail: bs.sail,\r\n              isRegulated: bs.isRegulated ?? null,\r\n              speed: bs.speed,\r\n              state: bs.state,\r\n              twa: bs.twa,\r\n              twaAuto: bs.twaAuto ?? null,\r\n              twd: bs.twd,\r\n              tws: bs.tws,\r\n              aground: bs.aground ?? null,\r\n              badSail: bs.badSail ?? null,\r\n              choice : true,\r\n              ...(bs.isFollowed ? { isFollowed: bs.isFollowed } : {}),\r\n              ...(bs.followed ? { followed: bs.followed } : {}),\r\n              ...(bs.team ? { team: bs.team } : {})\r\n            }\r\n          ],\r\n          players : [\r\n            { \r\n              id : bs._id.user_id,\r\n              name : bs.displayName,\r\n//                  teamId : validAccount.scriptData.team?.id?? null,\r\n              timestamp: Date.now(),\r\n//                  isVip : validAccount.scriptData.isVIP && validAccount.scriptData.userSettings?.noAds,\r\n//                  credits : validAccount.currency1\r\n            }      \r\n          ],\r\n          internal: [\r\n            {\r\n              id: \"legFleetInfosUpdate\",\r\n              ts: Date.now(),\r\n            },\r\n            {\r\n              id: \"playersUpdate\",\r\n              ts: Date.now(),\r\n            },\r\n          ]\r\n        });        \r\n      }\r\n      \r\n    }\r\n\r\n    processDBOperations(ope);\r\n    return {rstTimer: rstTimer,\r\n            raceId : raceId,\r\n            legNum : legNum,\r\n            userId : userId\r\n    };\r\n  } catch(error) {\r\n    if(cfg.debugIngesterErr) console.error('boat infos Validation Error :', error)\r\n    return {rstTimer: false,\r\n            raceId : null,\r\n            legNum : null,\r\n            userId : null\r\n};;\r\n  }\r\n}\r\nexport function ingestAccountDetails(account)\r\n{\r\n    accountDetailsDataModel.validate(account,{stripUnknow:true})\r\n    .then(validAccount => {\r\n        const dbOpe = [\r\n            {\r\n                type : \"putOrUpdate\",\r\n                internal: [\r\n                  {\r\n                    id : 'state',\r\n                    state : \"playerConnected\"\r\n                  },\r\n                  {\r\n                    id: \"playersUpdate\",\r\n                    ts: Date.now(),\r\n                  },\r\n                  {   \r\n//                        key: 'lastLoggedUser',\r\n                      id : 'lastLoggedUser',\r\n                      loggedUser : validAccount.userId \r\n                  },\r\n                  ...(validAccount.scriptData.team?.id\r\n                    ? [{\r\n                        id: \"teamsUpdate\",\r\n                        ts: Date.now(),\r\n                      }]\r\n                    : [])\r\n                ],\r\n                players : [\r\n                    { \r\n//                        key: validAccount.userId,  \r\n                        id : validAccount.userId,\r\n                        name : validAccount.displayName,\r\n                        teamId : validAccount.scriptData.team?.id?? null,\r\n                        timestamp: Date.now(),\r\n                        isVip : validAccount.scriptData.isVIP && validAccount.scriptData.userSettings?.noAds,\r\n                        credits : validAccount.currency1\r\n                    }      \r\n                ],\r\n                ...(validAccount.scriptData.team?.id && {\r\n                    teams: [\r\n                        {\r\n//                            key: validAccount.scriptData.team.id,  \r\n                            id: validAccount.scriptData.team.id,\r\n                            name: validAccount.scriptData.team.name // Ajoute d'autres propriétés si nécessaire\r\n                        }\r\n                    ]\r\n                })\r\n            }\r\n        ];\r\n        processDBOperations(dbOpe);\r\n        return true;\r\n    })\r\n    .catch(error => {\r\n        if(cfg.debugIngesterErr) console.error('Account Validation Error :', error);\r\n        return false;\r\n    });\r\n}\r\n\r\nexport function ingestEndLegPrep(endLegPrep)\r\n{\r\n    endLegPrepDataModel.validate(endLegPrep, { stripUnknown: true,  abortEarly: false  })\r\n    .then(validData => {\r\n    const l = validData.scriptData.leg;\r\n\r\n    const dbOpe = [\r\n        {\r\n        type: \"putOrUpdate\",\r\n        legList: [\r\n            {\r\n//            key : [l._id.race_id,l._id.num],\r\n            id: `${l._id.race_id}-${l._id.num}`,\r\n            raceId: l._id.race_id,\r\n            legNum: l._id.num,\r\n            status: l.status,\r\n            legName: l.name,\r\n            raceName: l.race.name,\r\n            raceType: l.race.type,\r\n            vsrLevel: l.vsrLevel,\r\n            estimatedTime: l.estimatedTime,\r\n            estimatedLength: l.estimatedLength,\r\n            fineWinds: l.fineWinds,\r\n            start: l.start,\r\n            end: l.end,\r\n            close: l.close,\r\n            open: l.open,\r\n            polar_id: l.boat?.polar_id,\r\n            pilotBoatCredits: l.pilotBoatCredits,\r\n            priceLevel: l.priceLevel,\r\n            freeCredits: l.freeCredits,\r\n            lastUpdate: l.lastUpdate,\r\n            optionPrices: l.optionPrices,\r\n            checkpoints: l.checkpoints,\r\n            ice_limits: l.ice_limits,\r\n            fineWinds: l.fineWinds,\r\n            course: l.course,\r\n            restrictedZones : l.restrictedZones\r\n\r\n            },\r\n            {\r\n//              key : 'update',\r\n              id: 'update',\r\n              update: new Date().toISOString()        \r\n            }\r\n        ],\r\n        ...((l.boat?.stats?.weight && l.boat?.polar_id) && {\r\n          polars: [\r\n              {\r\n//                key: l.boat.polar_id,\r\n                id: l.boat.polar_id,\r\n                weight : l.boat.stats.weight\r\n              }\r\n          ]\r\n        }),\r\n        internal: [\r\n          {\r\n            id: \"legListUpdate\",\r\n            ts: Date.now(),\r\n          },\r\n          ...((l.boat?.stats?.weight && l.boat?.polar_id)\r\n            ? [{\r\n                id: \"polarsUpdate\",\r\n                ts: Date.now(),\r\n              }]\r\n            : []),\r\n          { \r\n            id : 'lastOpennedRace',\r\n            lastOpennedRace : `${l._id.race_id}-${l._id.num}` ,\r\n            raceId : l._id.race_id,\r\n            legNum : l._id.num,\r\n          },\r\n          {\r\n            id : 'state',\r\n            state : 'raceOpened'\r\n          },\r\n            \r\n        ],\r\n      }\r\n    ];\r\n\r\n    processDBOperations(dbOpe);\r\n    })\r\n    .catch(err => {\r\n    if(cfg.debugIngesterErr) console.error(\"Validation failed:\", err.errors);\r\n    });\r\n}\r\n\r\nexport function ingestRaceList(legListData) {\r\n  try {\r\n    // ✅ Validation globale\r\n    const validData = legListDataModel.validateSync(legListData, {\r\n      stripUnknown: true,\r\n      abortEarly: false\r\n    });\r\n\r\n    const races = validData.scriptData?.res || [];\r\n    const legList = [];\r\n    const polars = [];\r\n    let validCount = 0;\r\n    let errorCount = 0;\r\n\r\n    for (const r of races) {\r\n      try {\r\n        // ✅ Validation individuelle de chaque race\r\n        const validated = raceSchema.validateSync(r, { stripUnknown: true });\r\n        const idInfo = validated._id || {};\r\n\r\n        legList.push({\r\n //         key : [validated._id.race_id,validated._id.num],\r\n          id: `${validated.raceId}-${validated.legNum}`,\r\n          raceId: validated.raceId,\r\n          legNum: validated.legNum,\r\n          raceName: validated.raceName,\r\n          legName: validated.legName,\r\n          estimatedTime: validated.estimatedTime,\r\n          estimatedLength: validated.estimatedLength,\r\n          status: validated.status,\r\n          vsrLevel: validated.vsrRank,\r\n          priceLevel: validated.priceLevel,\r\n          freeCredits: validated.freeCredits,\r\n          adStartCredits: validated.adStartCredits,\r\n          pilotBoatCredits: validated.pilotBoatCredits,\r\n          lastUpdate: validated.lastUpdate,\r\n          fineWinds: validated.fineWinds,\r\n          nbTotalSkippers: validated.nbTotalSkippers,\r\n          boatsAtSea: validated.boatsAtSea,\r\n          arrived: validated.arrived,\r\n          raceType: validated.raceType,\r\n          limitedAccess: validated.limitedAccess,\r\n          polar_id: validated.boat?.polar_id,\r\n          start: validated.start,\r\n          end: validated.end\r\n        });\r\n        if(validated.boat?.stats?.weight && validated.boat?.polar_id)\r\n        {\r\n          polars.push(\r\n            {\r\n//              key: validated.boat.polar_id,\r\n              id: validated.boat.polar_id,\r\n              weight : validated.boat.stats.weight\r\n            }\r\n          );\r\n        }\r\n\r\n        validCount++;\r\n      } catch (validationErr) {\r\n        if(cfg.debugIngester) console.warn(`❌ Validation failed for raceId=${r.raceId}, legNum=${r.legNum ?? '?'}`);\r\n        if(cfg.debugIngester) console.warn(validationErr.errors);\r\n        errorCount++;\r\n      }\r\n    }\r\n\r\n    if (legList.length > 1) {\r\n      const dbOpe = [\r\n        {\r\n          type: \"putOrUpdate\",\r\n          legList,\r\n          polars,\r\n          internal: [\r\n            {\r\n              id: \"legListUpdate\",\r\n              ts: Date.now(),\r\n            },\r\n            ...(polars.length > 1\r\n              ? [{\r\n                  id: \"polarsUpdate\",\r\n                  ts: Date.now(),\r\n                }]\r\n              : [])\r\n          ]\r\n        },\r\n      ];\r\n      processDBOperations(dbOpe);\r\n    }\r\n\r\n    if(cfg.debugIngester) console.log(`✅ ${validCount} race(s) ingérées, ❌ ${errorCount} erreur(s).`);\r\n  } catch (err) {\r\n    if(cfg.debugIngesterErr) console.error(\"❌ Erreur globale dans legListDataModel :\", err.errors);\r\n  }\r\n}\r\n\r\n\r\nexport async function ingestFleetData(request, response) {\r\n  try {\r\n    // ✅ Validation synchrone de la requête\r\n    const req = getFleetRequestDataSchema.validateSync(request, {\r\n      stripUnknown: true\r\n    });\r\n\r\n    const filteredResponse = {\r\n      ...response,\r\n      res: (response.res || [])\r\n        // 1️⃣ Exclure pilotBoat\r\n        .filter(p => p.userId !== \"pilotBoat\")\r\n        // 2️⃣ Corriger le state pour les bateaux \"real\"\r\n        .map(p => ({\r\n          ...p,\r\n          state: p.type === \"real\" && p.state === null ? \"racing\" : p.state\r\n        }))\r\n    };\r\n\r\n    // ✅ Validation synchrone de la réponse\r\n    const res = getFleetResponseSchema.validateSync(filteredResponse, {\r\n      stripUnknown: true\r\n    });\r\n\r\n    const connectedUserInfos = await getData(\"players\",req.user_id);\r\n    let currentTeamId = connectedUserInfos?.teamId?connectedUserInfos.teamId:null;\r\n\r\n    const legFleetInfos = res.res.map(p => ({  \r\n//      key:[req.race_id,req.leg_num,p.userId,p.lastCalcDate],   \r\n      id: `${req.race_id}-${req.leg_num}-${p.userId}-${p.lastCalcDate}`,\r\n      raceId: req.race_id,\r\n      legNum: req.leg_num,\r\n      userId: p.userId,\r\n      iteDate: p.lastCalcDate?p.lastCalcDate:Date.now(),\r\n      type: p.type,\r\n      hdg: p.heading,\r\n      speed: p.speed,\r\n      pos: p.pos,\r\n      tws: p.tws,\r\n      twa: p.twa,\r\n      twd: p.twd,\r\n      sail: p.sail ?? null,\r\n      rank: p.rank ?? null,\r\n      state : p.state,\r\n      type:p.type,\r\n      ...(p.isFollowed ? { isFollowed: p.isFollowed } : {}),\r\n      ...(p.followed ? { followed: p.followed } : {}),\r\n      ...(p.team ? { team: p.team } : {})\r\n    }));\r\n\r\n    const players = res.res.map(p => ({\r\n\r\n      id : p.userId,\r\n      name : p.displayName,\r\n      timestamp: Date.now(),\r\n      ...(p.team &&currentTeamId?{teamId:currentTeamId}:{})\r\n    }));\r\n\r\n    const dbOpe = [\r\n      {\r\n        type: \"putOrUpdate\",\r\n        legFleetInfos,\r\n        players,\r\n        internal: [\r\n          {\r\n            id: \"legFleetInfosUpdate\",\r\n            ts: Date.now(),\r\n          },\r\n          {\r\n            id: \"playersUpdate\",\r\n            ts: Date.now(),\r\n          },\r\n        ]\r\n      }\r\n    ];\r\n\r\n    processDBOperations(dbOpe);\r\n    if(cfg.debugIngester) console.log(`✅ Ingested ${legFleetInfos.length} fleet players for race ${req.race_id}, leg ${req.leg_num}`);\r\n\r\n  } catch (err) {\r\n    if(cfg.debugIngesterErr) console.error(\"❌ Fleet ingest failed:\", err.errors);\r\n  }\r\n}\r\n\r\n\r\nexport function ingestGameSetting(gameSetting) {\r\n  gameSettingsSchema.validate(gameSetting, { stripUnknown: true })\r\n  .then(validGameSetting => {\r\n    const stamina = validGameSetting.scriptData?.settings?.stamina;\r\n    const dbOpe = [\r\n      {\r\n        type: \"putOrUpdate\",\r\n        ...(stamina && {\r\n          internal: [\r\n            {\r\n//              key: \"paramStamina\",\r\n              id: \"paramStamina\",\r\n              paramStamina: stamina,\r\n            },\r\n            {\r\n              id: \"paramStaminaUpdate\",\r\n              ts: Date.now(),\r\n            }  \r\n          ],\r\n        }),\r\n      },\r\n    ];\r\n\r\n    processDBOperations(dbOpe);\r\n    return true;\r\n  })\r\n  .catch(error => {\r\n      if(cfg.debugIngesterErr) console.error('Account Validation Error :', error);\r\n      return false;\r\n  });\r\n}\r\n\r\nexport function ingestBoatAction(boatActionTxt)\r\n{\r\n  boatActionResponseData.validate(boatActionTxt, { stripUnknown: true })\r\n  .then(ValidboatActionTxt => {\r\n  const { boatActions } = ValidboatActionTxt.scriptData;\r\n  const raceId = boatActions[0]._id.race_id;\r\n  const legNum = boatActions[0]._id.leg_num;\r\n  const userId = boatActions[0]._id.user_id;\r\n\r\n  const userAction = {};\r\n  const prog = {\r\n    order : [],\r\n    wp :[]    \r\n  };\r\n  for (const action of boatActions) {\r\n    if ('sail_id' in action) {\r\n      userAction.sail = {\r\n        autoSails: action.sail_id >= 10 ? true : false,\r\n        sailId: action.sail_id,\r\n      };\r\n    } else if ('isProg' in action) {\r\n\r\n      const order = {\r\n        autoTwa: action.autoTwa,\r\n        deg: action.deg,\r\n        timestamp: action._id.ts,\r\n      } \r\n      if(!action.isProg)\r\n        userAction.heading = order;\r\n      else\r\n        prog.order.push(order)\r\n    } else if ('pos' in action) {\r\n      const order = {\r\n        lat: action.pos[0].lat,\r\n        lon: action.pos[0].lon,\r\n        idx: action.pos[0].idx,\r\n      };\r\n      prog.wp.push(order);\r\n    }\r\n  }\r\n\r\n  if (prog.wp.length) {\r\n    prog.wp.sort((a, b) => a.idx - b.idx);\r\n  }\r\n\r\n  if (prog.order) {\r\n    prog.order.sort((a, b) => a.timestamp - b.timestamp);\r\n  }\r\n  const dbOpe = [\r\n    {\r\n      type: \"putOrUpdate\",\r\n      legPlayersOrder : [\r\n        ...(('sail' in userAction)\r\n          ? [{\r\n              raceId : raceId,\r\n              legNum : legNum,\r\n              userId : userId,\r\n              serverTs : ValidboatActionTxt.scriptData.serverTs,\r\n              iteDate : ValidboatActionTxt.scriptData.actionTs,\r\n              action : {type : 'sail', action : userAction.sail}\r\n            }]\r\n          : []),\r\n        ...(('heading' in userAction )\r\n          ? [{\r\n              raceId : raceId,\r\n              legNum : legNum,\r\n              userId : userId,\r\n              serverTs : ValidboatActionTxt.scriptData.serverTs,\r\n              iteDate : ValidboatActionTxt.scriptData.actionTs,\r\n              action : {type : 'order', action : userAction.heading}\r\n            }]\r\n          : []),\r\n        ...((prog.order.length )\r\n          ? [{\r\n              raceId : raceId,\r\n              legNum : legNum,\r\n              userId : userId,\r\n              serverTs : ValidboatActionTxt.scriptData.serverTs,\r\n              iteDate : ValidboatActionTxt.scriptData.actionTs,\r\n              action : {type : 'prog', action : prog.order}\r\n            }]\r\n          : []),\r\n        ...((prog.wp.length )\r\n          ? [{\r\n              raceId : raceId,\r\n              legNum : legNum,\r\n              userId : userId,\r\n              serverTs : ValidboatActionTxt.scriptData.serverTs,\r\n              iteDate : ValidboatActionTxt.scriptData.actionTs,\r\n              action : {type : 'wp', action : prog.wp}\r\n            }]\r\n          : []),\r\n      ],\r\n      ...(('sail' in userAction || 'heading' in userAction\r\n        || prog.order.length || prog.wp.length ) && {\r\n          internal: [\r\n            {\r\n              id: \"legPlayersOrderUpdate\",\r\n              ts: Date.now(),\r\n            }  \r\n          ],\r\n        }),\r\n\r\n    }];\r\n//todo upate playerinfos and fleetInfos avec info userAction\r\n    processDBOperations(dbOpe);   \r\n     return true;\r\n  })\r\n  .catch(error => {\r\n      if(cfg.debugIngesterErr) console.error('boatAction Validation Error :', error);\r\n      return false;\r\n  });\r\n\r\n}","\r\nimport { roundTo } from './../common/utils.js';\r\n\r\nexport function  theoreticalSpeed(polar,options = [],tws,twa,sailId = null) {\r\n    if (polar == undefined || tws == undefined)\r\n        return undefined;\r\n    let foil = foilingFactor(options, tws, twa, polar.foil);\r\n    let foiling = (foil - 1.0) * 100 / (polar.foil.speedRatio - 1.0);\r\n    let hull = options?.hull ? 1.003 : 1.0;\r\n    let ratio = polar.globalSpeedRatio;\r\n    let twsLookup = fractionStep(tws, polar.tws);\r\n    let twaLookup = fractionStep(twa, polar.twa);\r\n    const maxSpd = maxSpeed(options, twsLookup, twaLookup, polar.sail);\r\n    const spd = (sailId!=null )?pSpeed(twaLookup,twsLookup,polar.sail[sailId].speed):0;\r\n    return {\r\n        \"speed\": (sailId!=null )?roundTo(spd * foil * hull * ratio, 3):roundTo(maxSpd.speed * foil * hull * ratio, 3),\r\n        \"sail\": (sailId!=null )?sailId:maxSpd.sail,\r\n        \"foiling\": foiling\r\n    };\r\n}\r\n\r\n\r\n\r\nfunction maxSpeed (options, iS, iA, sailDefs) {\r\n    let maxSpeed = 0;\r\n    let maxSail = \"\";\r\n    for (const sailDef of sailDefs) {\r\n        if (sailDef.id === 1\r\n            || sailDef.id === 2\r\n            || (sailDef.id === 3 && options?.heavy)\r\n            || (sailDef.id === 4 && options?.light)\r\n            || (sailDef.id === 5 && options?.reach)\r\n            || (sailDef.id === 6 && options?.heavy)\r\n            || (sailDef.id === 7 && options?.light)) {\r\n            let speed = pSpeed(iA, iS, sailDef.speed);\r\n            if (speed > maxSpeed) {\r\n                maxSpeed = speed;\r\n                maxSail = sailDef.id;\r\n            }\r\n        }\r\n    }\r\n    return {\r\n        speed: maxSpeed,\r\n        sail: maxSail\r\n    }\r\n}\r\n\r\n\r\nfunction pSpeed (iA, iS, speeds) {\r\n    return bilinear(iA.fraction, iS.fraction,\r\n        speeds[iA.index - 1][iS.index - 1],\r\n        speeds[iA.index][iS.index - 1],\r\n        speeds[iA.index - 1][iS.index],\r\n        speeds[iA.index][iS.index]);\r\n}\r\n\r\n\r\nexport function bilinear(x, y, f00, f10, f01, f11) {\r\n    return f00 * (1 - x) * (1 - y)\r\n        + f10 * x * (1 - y)\r\n        + f01 * (1 - x) * y\r\n        + f11 * x * y;\r\n}\r\n\r\n\r\nexport function foilingFactor(options, tws, twa, foil) {\r\n    let speedSteps = [0, foil.twsMin - foil.twsMerge, foil.twsMin, foil.twsMax, foil.twsMax + foil.twsMerge, Infinity];\r\n    let twaSteps = [0, foil.twaMin - foil.twaMerge, foil.twaMin, foil.twaMax, foil.twaMax + foil.twaMerge, Infinity];\r\n    let foilMat = [[1, 1, 1, 1, 1, 1],\r\n                   [1, 1, 1, 1, 1, 1],\r\n                   [1, 1, foil.speedRatio, foil.speedRatio, 1, 1],\r\n                   [1, 1, foil.speedRatio, foil.speedRatio, 1, 1],\r\n                   [1, 1, 1, 1, 1, 1],\r\n                   [1, 1, 1, 1, 1, 1]];\r\n\r\n    if (options?.foil) {\r\n        let iS = fractionStep(tws, speedSteps);\r\n        let iA = fractionStep(twa, twaSteps);\r\n        return bilinear(iA.fraction, iS.fraction,\r\n            foilMat[iA.index - 1][iS.index - 1],\r\n            foilMat[iA.index][iS.index - 1],\r\n            foilMat[iA.index - 1][iS.index],\r\n            foilMat[iA.index][iS.index]);\r\n    } else {\r\n        return 1.0;\r\n    }\r\n}\r\n\r\nexport function fractionStep (value, steps){\r\n    let absVal\t= Math.abs(value);\r\n    let index\t= 0;\r\n    while (index < steps.length && steps[index]<= absVal) {\r\n        index++;\r\n    }\r\n\r\n    if (index >= steps.length) {\r\n        return {\r\n            index\t: steps.length-1,\r\n            fraction: 1\r\n        };\r\n    }\r\n\r\n    return {\r\n        index\t: index,\r\n        fraction: (absVal - steps[index-1]) / (steps[index] - steps[index-1])\r\n    };\r\n}\r\n\r\n\r\nfunction isSailisInOptions(sailId,options)\r\n{\r\n    switch(sailId)\r\n    {\r\n        default :\r\n        case 1 : //JIB\r\n        case 2 : //SPI\r\n            return true;\r\n        case 3 : //STAYSAIL\r\n        case 6 : //HEAVY_GNK\r\n            return options?.heavy;\r\n        case 4 : //LIGHT_JIB\r\n        case 7 : //LIGHT_GNK\r\n            return options?.light;\r\n        case 5 : //CODE_0\r\n            return options?.reach;\r\n    }\r\n}\r\n\r\nexport const computeEnergyLoose = (polar, paramStamina, options = {}, tws) => {\r\n    if (!polar) {\r\n        return { gybe: null, tack: null, sail: null };\r\n    }\r\n\r\n    const { consumption = {} } = paramStamina ?? {};\r\n    const { points = {}, winds: windsCfg = {}, boats: boatsCfg = null } = consumption;\r\n\r\n    const computeStaminaLoose = (basePt, type = \"M\") => {\r\n        const getBoatCoefficient = (boatWeightKg) => {\r\n        if (!boatsCfg) return -1; // préserve le comportement d’origine\r\n        const keys = Object.keys(boatsCfg).map(Number).sort((a, b) => a - b);\r\n        if (!keys.length) return -1;\r\n\r\n        if (boatWeightKg <= keys[0]) return boatsCfg[keys[0]];\r\n        if (boatWeightKg >= keys[keys.length - 1]) return boatsCfg[keys[keys.length - 1]];\r\n\r\n        let lower = keys[0], upper = keys[0];\r\n        for (let i = 0; i < keys.length; i++) {\r\n            if (boatWeightKg >= keys[i]) lower = keys[i];\r\n            if (boatWeightKg < keys[i]) { upper = keys[i]; break; }\r\n        }\r\n        return boatsCfg[lower];\r\n        };\r\n\r\n        const getWindConsumptionFactor = (windSpeed) => {\r\n            const vrJacketWinds = { 0: 1, 10: 1, 20: 1.2, 30: 1.8 };\r\n            const windsTable = options?.vrtexJacket ? vrJacketWinds : windsCfg;\r\n\r\n            const keys = Object.keys(windsTable).map(Number).sort((a, b) => a - b);\r\n            if (!keys.length) return 1;\r\n\r\n            if (windSpeed <= keys[0]) return windsTable[keys[0]];\r\n            if (windSpeed >= keys[keys.length - 1]) return windsTable[keys[keys.length - 1]];\r\n\r\n            let lower = keys[0], upper = keys[0];\r\n            for (let i = 0; i < keys.length; i++) {\r\n                if (windSpeed >= keys[i]) lower = keys[i];\r\n                if (windSpeed < keys[i]) { upper = keys[i]; break; }\r\n            }\r\n            const ratio = (windSpeed - lower) / (upper - lower);\r\n            return windsTable[lower] + ratio * (windsTable[upper] - windsTable[lower]);\r\n        };\r\n\r\n        const boatCoeff = polar?.weight ? getBoatCoefficient(polar.weight / 1000) : 1;\r\n        let stamina = basePt * boatCoeff;\r\n\r\n        if (type === \"S\" && options?.magicFurler) {\r\n        stamina *= 0.8;\r\n        }\r\n\r\n        const factor = getWindConsumptionFactor(tws);\r\n        return (factor * stamina).toFixed(2); // conserve le type string comme l’original\r\n    };\r\n\r\n    return {\r\n        gybe: computeStaminaLoose(points.gybe),\r\n        tack: computeStaminaLoose(points.tack),\r\n        sail: computeStaminaLoose(points.sail, \"S\"),\r\n    };\r\n};\r\n\r\n  \r\nexport const computeEnergyRecovery = (pts,tws,paramStamina,options = {}) => {\r\n    if(!tws) return \"-\";\r\n    let ltws = paramStamina.recovery.loWind;\r\n    let htws = paramStamina.recovery.hiWind;\r\n    let lRecovery = paramStamina.recovery.loTime*60;\r\n    let hRecovery = paramStamina.recovery.hiTime*60;\r\n    let minByPt = 1;\r\n    if(tws<=ltws) {\r\n        minByPt = lRecovery;\r\n    } else  if(tws>=htws) {\r\n        minByPt = hRecovery;\r\n    } else {\r\n        let aFactor = (hRecovery+lRecovery)/2;\r\n        let bFactor = (hRecovery-lRecovery)/2;\r\n        minByPt = aFactor-Math.cos((tws-ltws)/(htws-ltws)*Math.PI)*bFactor;\r\n    }\r\n    if (options?.comfortLoungePug) minByPt *= 0.8;\r\n    return ((pts / Number(paramStamina.recovery.points)*minByPt)/60).toFixed(0); \r\n}        \r\n\r\nconst computeEnergyPenalitiesFactor = (stamina) => {\r\n    let coeff = stamina * -0.015 + 2;\r\n    return coeff?(coeff<0.5?0.5:coeff):1.0;\r\n}\r\nexport function manoeuveringPenalities(polar,ite,stamina,options)  {\r\n    if(!polar || !ite)\r\n        return {\r\n            \"gybe\" : null,\r\n            \"tack\" : null,\r\n            \"sail\" : null,\r\n            \"staminaFactor\" :null\r\n            };\r\n    const penalty = (speed, options, fraction, spec,boatcoeff,type=\"M\") => {\r\n        if(!spec)\r\n        {\r\n            return {\r\n                \"time\" : null,\r\n                \"dist\" : null,\r\n            };\r\n        }\r\n        if (options?.winch) {\r\n            spec = spec.pro;\r\n        } else {\r\n            spec = spec.std;\r\n        }\r\n        let time = (spec.lw.timer + (spec.hw.timer - spec.lw.timer) * fraction)*boatcoeff;\r\n        if(type==\"S\") {\r\n            if (options?.magicFurler) {\r\n                time *= 0.8;\r\n            }\r\n        }\r\n        let dist = speed * time / 3600;\r\n        return {\r\n            \"time\" : time.toFixed(),\r\n            \"dist\" : (dist * (1- spec.lw.ratio)).toFixed(3)\r\n        };\r\n    }\r\n    let winch = polar.winch;\r\n    let tws = ite.tws;\r\n    let speed = ite.speed;\r\n    //take account of penalities\r\n    let fraction;\r\n    if  ((winch.lws <= tws) && (tws <= winch.hws)) {\r\n        fraction = 0.5-Math.cos((tws-winch.lws)/(winch.hws-winch.lws)*Math.PI)*0.5;\r\n    } else if (tws < winch.lws) {\r\n        fraction = 0;\r\n    } else {\r\n        fraction = 1;\r\n    }\r\n\r\n    //take in account stamina, coeff is coming from impact value\r\n    let boatCoeff = 1.0;\r\n    if(stamina)\r\n    {\r\n         boatCoeff = computeEnergyPenalitiesFactor(stamina);\r\n    } \r\n\r\n    return {\r\n        gybe : penalty(speed, options, fraction, winch.gybe,boatCoeff),\r\n        tack : penalty(speed, options, fraction, winch.tack,boatCoeff),\r\n        sail : penalty(speed, options, fraction, winch.sailChange,boatCoeff,\"S\"),\r\n        staminaFactor : boatCoeff\r\n    };\r\n}\r\n\r\nexport function vmg(speed, twa){\r\n    let r = Math.abs(Math.cos(twa / 180 * Math.PI));\r\n    return speed * r;\r\n}\r\n\r\nexport function bestVMG(tws, polars, options, sailId, currTwa) {\r\n    const best = {\r\n        vmgUp: 0, twaUp: 0, sailUp: 0,\r\n        vmgDown: 0, twaDown: 0, sailDown: 0,\r\n        bspeed: 0, btwa: 0, sailBSpeed: 0,\r\n        sailTWAMin: 0, sailTWAMax: 0,\r\n        sailTWSMin: 0, sailTWSMax: 0,\r\n    };\r\n\r\n    // Garde simple\r\n    if (!polars?.tws?.length || !polars?.twa?.length || !polars?.sail?.length) return best;\r\n\r\n    // Helpers\r\n    const DEG2RAD = Math.PI / 180;\r\n    const tol = 0.014; // 1.4% de marge comme dans le code d’origine\r\n    const inOpts = (id) => isSailisInOptions(id, options);\r\n\r\n    // Sécurise les indices pour bilinear (qui attend i-1 et i)\r\n    const safeStep = (step, arrLen) => ({\r\n        index: Math.min(Math.max(step.index, 1), arrLen - 1),\r\n        fraction: Math.min(Math.max(step.fraction, 0), 1),\r\n    });\r\n\r\n    const hRatio = options?.hull ? (polars?.hull?.speedRatio ?? 1) : 1;\r\n\r\n    // ---- Balayage TWA pour un TWS fixé ----\r\n    const sStep = safeStep(fractionStep(tws, polars.tws), polars.tws.length);\r\n\r\n    let twaDetect = [];\r\n    for (let twaIndex = 250; twaIndex < 1800; twaIndex++) {\r\n        const aTWA = twaIndex / 10;\r\n        const aStepRaw = fractionStep(aTWA, polars.twa);\r\n        const aStep = safeStep(aStepRaw, polars.twa.length);\r\n\r\n        let actualSailSpd = 0;\r\n        let bestSpdAtThisTWA = 0;\r\n        let bestSpdSailAtThisTWA = null;\r\n\r\n        for (const sail of polars.sail) {\r\n        if (!inOpts(sail.id)) continue;\r\n\r\n        const f = foilingFactor(options, tws, polars.twa[aStep.index], polars.foil);\r\n        const rspeed = bilinear(\r\n            aStep.fraction, sStep.fraction,\r\n            sail.speed[aStep.index - 1][sStep.index - 1],\r\n            sail.speed[aStep.index][sStep.index - 1],\r\n            sail.speed[aStep.index - 1][sStep.index],\r\n            sail.speed[aStep.index][sStep.index]\r\n        );\r\n        const speed = rspeed * f * hRatio;\r\n        const vmg = speed * Math.cos(aTWA * DEG2RAD);\r\n\r\n        // Meilleurs VMG up/down\r\n        if (vmg > best.vmgUp) {\r\n            best.vmgUp = vmg;\r\n            best.twaUp = aTWA;\r\n            best.sailUp = sail.id;\r\n        } else if (vmg < best.vmgDown) {\r\n            best.vmgDown = vmg;\r\n            best.twaDown = aTWA;\r\n            best.sailDown = sail.id;\r\n        }\r\n\r\n        // Meilleure BS absolue (tous TWA)\r\n        if (speed > best.bspeed) {\r\n            best.bspeed = speed;\r\n            best.btwa = aTWA;\r\n            best.sailBSpeed = sail.id;\r\n        }\r\n\r\n        // Meilleure vitesse à ce TWA\r\n        if (speed > bestSpdAtThisTWA) {\r\n            bestSpdAtThisTWA = speed;\r\n            bestSpdSailAtThisTWA = sail.id;\r\n        }\r\n\r\n        if (sail.id === sailId) actualSailSpd = speed;\r\n        }\r\n\r\n        // Vérifie si la voile actuelle reste la meilleure à ce TWA\r\n        if (\r\n        (actualSailSpd >= bestSpdAtThisTWA && bestSpdSailAtThisTWA === sailId) ||\r\n        (actualSailSpd * (1 + tol) > bestSpdAtThisTWA && bestSpdSailAtThisTWA !== sailId)\r\n        ) {\r\n        twaDetect.push(aTWA);\r\n        }\r\n    }\r\n\r\n    if (twaDetect.length) {\r\n        best.sailTWAMin = twaDetect.reduce((m, v) => Math.min(m, v), +Infinity);\r\n        best.sailTWAMax = twaDetect.reduce((m, v) => Math.max(m, v), -Infinity);\r\n    }\r\n\r\n    // ---- Balayage TWS pour un TWA fixé ----\r\n    const aStep2 = safeStep(fractionStep(currTwa, polars.twa), polars.twa.length);\r\n    let twsDetect = [];\r\n\r\n    for (let twsIndex = 100; twsIndex < 4300; twsIndex++) {\r\n        const aTWS = twsIndex / 100;\r\n        const sStep2 = safeStep(fractionStep(aTWS, polars.tws), polars.tws.length);\r\n\r\n        let actualSailSpd = 0;\r\n        let bestSpdAtThisTWS = 0;\r\n        let bestSpdSailAtThisTWS = null;\r\n\r\n        for (const sail of polars.sail) {\r\n        if (!inOpts(sail.id)) continue;\r\n\r\n        const f = foilingFactor(options, aTWS, polars.twa[aStep2.index], polars.foil);\r\n        const rspeed = bilinear(\r\n            aStep2.fraction, sStep2.fraction,\r\n            sail.speed[aStep2.index - 1][sStep2.index - 1],\r\n            sail.speed[aStep2.index][sStep2.index - 1],\r\n            sail.speed[aStep2.index - 1][sStep2.index],\r\n            sail.speed[aStep2.index][sStep2.index]\r\n        );\r\n        const speed = rspeed * f * hRatio;\r\n\r\n        if (speed > bestSpdAtThisTWS) {\r\n            bestSpdAtThisTWS = speed;\r\n            bestSpdSailAtThisTWS = sail.id;\r\n        }\r\n        if (sail.id === sailId) actualSailSpd = speed;\r\n        }\r\n\r\n        // Vérifie si la voile actuelle reste la meilleure à ce TWS\r\n        if (\r\n        (actualSailSpd >= bestSpdAtThisTWS && bestSpdSailAtThisTWS === sailId) ||\r\n        (actualSailSpd * (1 + tol) > bestSpdAtThisTWS && bestSpdSailAtThisTWS !== sailId)\r\n        ) {\r\n        twsDetect.push(aTWS);\r\n        }\r\n    }\r\n\r\n    if (twsDetect.length) {\r\n        best.sailTWSMin = twsDetect.reduce((m, v) => Math.min(m, v), +Infinity);\r\n        best.sailTWSMax = twsDetect.reduce((m, v) => Math.max(m, v), -Infinity);\r\n    }\r\n\r\n    return best;\r\n}\r\n\r\n","\r\n\r\nimport {processDBOperations,getData,openDatabase,saveData,getLatestEntriesPerUser,getLatestAndPreviousByTriplet} from '../common/dbOpes.js';\r\nimport { gcDistance, \r\n    courseAngle, \r\n    angle, \r\n    toRad ,\r\n    toDeg,\r\n    roundTo,\r\n    isBitSet,\r\n    guessOptionBits,\r\n    calculateCOGLoxo\r\n} from './../common/utils.js';\r\nimport { theoreticalSpeed ,\r\n    bestVMG,\r\n    manoeuveringPenalities,\r\n    computeEnergyRecovery,\r\n    foilingFactor,\r\n    computeEnergyLoose\r\n} from './../polar/utils.js';\r\nimport cfg from '@/config.json';\r\n\r\n\r\n\r\nasync function computeFleetPlayerIte(legInfos, latest,playerOption,currentPlayerLatest , polar)\r\n{\r\n\r\n    if(!latest || !currentPlayerLatest || !polar) return;\r\n    \r\n    const metaDash = latest.metaDash?latest.metaDash:[];\r\n//    let metaDash = latest.metaDash;\r\n \r\n    const playerPos = latest.pos;\r\n    const currentPlayerPos = currentPlayerLatest.pos;\r\n    \r\n    metaDash.DTU = roundTo(gcDistance(currentPlayerPos, playerPos), 1);\r\n    metaDash.BFU = roundTo(courseAngle(currentPlayerPos.lat, currentPlayerPos.lon, playerPos.lat, playerPos.lon) * 180 / Math.PI, 1);\r\n    let ad = metaDash.BFU - currentPlayerLatest.hdg + 90;\r\n    if (ad < 0) ad += 360;\r\n    if (ad > 360) ad -= 360;\r\n    if (ad > 180) metaDash.DTU = -metaDash.DTU; // \"behind\" us\r\n\r\n    metaDash.dtf = latest.distanceToEnd;\r\n    metaDash.dtfC = legInfos.end?gcDistance(latest.pos, legInfos.end):null;\r\n    if (!metaDash.dtf || metaDash.dtf == null) {\r\n        metaDash.dtf = metaDash.dtfC;\r\n    }\r\n\r\n\r\n    metaDash.raceTime = null;\r\n    if(legInfos.type == \"record\")\r\n    {\r\n        if(latest.state == \"racing\" && latest.distanceToEnd)\r\n        {\r\n            try {\r\n                metaDash.raceTime = latest.dateIte - latest.startDate;\r\n                const estimatedSpeed = latest.distanceFromStart / (raceTime / 3600000);\r\n                const eTtF = (latest.distanceToEnd / estimatedSpeed) * 3600000;\r\n                metaDash.avgSpeed = estimatedSpeed;\r\n                metaDash.eRT = raceTime + eTtF;\r\n            } catch (e) {\r\n                metaDash.eRT = e.toString();\r\n            }\r\n        } else if(latest.startDate && latest.state === \"racing\" && latest.startDate!=\"-\") {\r\n                metaDash.raceTime = Date.now() - latest.startDate;\r\n        }\r\n    } else\r\n    {\r\n        let legS = 0;\r\n        if (legInfos.legStartDate != undefined && legInfos.legStartDate > 0) legS = legInfos.legStartDate;\r\n        if (legInfos.start?.date != undefined) legS = legInfos.start.date;\r\n        if (legS > 0) metaDash.raceTime = currentPlayerLatest.iteDate-legS;\r\n    }\r\n                    \r\n\r\n    let realFoilFactor = null;\r\n    let sailCoverage = 0;\r\n    let xplained = false;\r\n    let xfactor = 1.0;\r\n    playerOption.guessOptions = playerOption.guessOptions?playerOption.guessOptions:0;\r\n    const playerGuessOptionPrev = playerOption.guessOptions;\r\n\r\n    if (polar) {\r\n        const currentSail = latest.sail % 10;\r\n        let sailDef = polar.sail[currentSail - 1];\r\n            \r\n        \r\n        // \"Real\" boats have no sail info\r\n        // \"Waiting\" boats have no TWA\r\n        if (latest.state == \"racing\" && sailDef && latest.twa && latest.tws) {\r\n          //  let iA = fractionStep(latest.twa, polar.twa);\r\n          //  let iS = fractionStep(latest.tws, polar.tws);\r\n\r\n            // \"Plain\" speed\r\n            const speedTFull = theoreticalSpeed(polar,null,latest.tws, latest.twa, currentSail - 1)\r\n            let speedT = speedTFull.speed;\r\n            // Speedup factors\r\n            let foilFactor = foilingFactor({foil:true}, latest.tws, latest.twa, polar.foil);\r\n            let hullFactor = polar.hull.speedRatio;\r\n\r\n            const epsEqual = (a, b) => {\r\n                return Math.abs(b - a) < 0.00002;\r\n            }\r\n\r\n            const aroundV = (a, b) => {\r\n                return Math.abs(b - a) < 0.01;\r\n            } \r\n            \r\n            if(guessOptionBits[currentSail]) playerOption.guessOptions |= guessOptionBits[currentSail];\r\n\r\n            if (playerOption?.options?.foil)  {realFoilFactor = 0;}\r\n            \r\n            xfactor = latest.speed / speedT;\r\n            const foils = ((foilFactor - 1) * 100) / 4 * 100;\r\n            if (epsEqual(xfactor, 1.0)) {\r\n                // Speed agrees with \"plain\" speed.\r\n                // Explanation: 1. no hull and 2. foiling condition => no foils.\r\n                xplained = true;\r\n                playerOption.guessOptions |= guessOptionBits[\"hullDetected\"];\r\n                playerOption.guessOptions &= ~guessOptionBits[\"hull\"];                \r\n                if (foilFactor > 1.0) {\r\n                    realFoilFactor = null;\r\n                    playerOption.guessOptions |= guessOptionBits[\"foilDetected\"];\r\n                    playerOption.guessOptions &= ~guessOptionBits[\"foil\"];     \r\n                }\r\n            } else {\r\n                // Speed does not agree with plain speed.\r\n                // Check if hull, foil or hull+foil can explain the observed speed.\r\n                if (epsEqual(latest.speed, speedT * hullFactor)) {\r\n                    xplained = true;\r\n                    if (epsEqual(hullFactor, foilFactor)) {\r\n                        // Both hull and foil match.\r\n                        realFoilFactor = foils;\r\n                        playerOption.guessOptions |= guessOptionBits[\"foilActivated\"];\r\n                        playerOption.guessOptions |= guessOptionBits[\"hullDetected\"];\r\n                        playerOption.guessOptions &= ~guessOptionBits[\"hull\"];  \r\n                    } else {\r\n                        playerOption.guessOptions |= guessOptionBits[\"hullActivated\"];\r\n                        \r\n                        if (foilFactor > 1.0) {\r\n                            realFoilFactor = null;\r\n                            playerOption.guessOptions |= guessOptionBits[\"foilDetected\"];\r\n                            playerOption.guessOptions &= ~guessOptionBits[\"foil\"];                \r\n            \r\n                        }\r\n                    }\r\n                } else if (epsEqual(latest.speed, speedT * foilFactor)) {\r\n                    xplained = true;\r\n                    realFoilFactor = foils;\r\n                    playerOption.guessOptions |= guessOptionBits[\"foilActivated\"];\r\n                    playerOption.guessOptions |= guessOptionBits[\"hullDetected\"];\r\n                    playerOption.guessOptions &= ~guessOptionBits[\"hull\"];                \r\n                } else if (epsEqual(latest.speed, speedT * foilFactor * hullFactor)) {\r\n                    xplained = true;\r\n                    realFoilFactor = foils;\r\n                    playerOption.guessOptions |= guessOptionBits[\"foilActivated\"];\r\n                    playerOption.guessOptions |= guessOptionBits[\"hullActivated\"];\r\n                } else {\r\n                    if(playerOption?.options\r\n                        || (isBitSet(playerOption?.guessOptions,guessOptionBits[\"foilDetected\"])\r\n                         && isBitSet(playerOption?.guessOptions,guessOptionBits[\"hullDetected\"]))\r\n                      ) \r\n                    {\r\n                        let hullOpt = isBitSet(playerOption?.guessOptions,guessOptionBits[\"hull\"]);\r\n                        let foilOpt = isBitSet(playerOption?.guessOptions,guessOptionBits[\"foil\"]);\r\n                        if(playerOption?.options)\r\n                        {\r\n                            hullOpt = playerOption?.options.hull;\r\n                            foilOpt =  playerOption?.options.foil;   \r\n                        }\r\n                        xplained = true;\r\n                        \r\n                        if(foilOpt)\r\n                            realFoilFactor = foils;\r\n                        //    info.xoption_foils = roundTo(foils, 0) + \"%\";\r\n                        else\r\n                            realFoilFactor = null;\r\n                        //    info.xoption_foils = \"no\";\r\n                        \r\n                        //here check for overspeed due to sail\r\n                        //spd = speedT *ff* hf *sf\r\n                        //sf = spd /  speedT *ff* hf\r\n                        let sf = 1.0;\r\n                        if(foilOpt && hullOpt)\r\n                            sf = latest.speed / (speedT * foilFactor * hullFactor);\r\n                        else if(foilOpt)\r\n                            sf = latest.speed / (speedT * foilFactor);\r\n                        else if(hullOpt)\r\n                            sf = latest.speed / (speedT * hullFactor);\r\n                        else\r\n                            sf = latest.speed / (speedT);\r\n        \r\n                        if(sf >1.0 && sf <= 1.14) {\r\n                            sailCoverage = roundTo((sf-1.0)*100, 2);\r\n                        } else if(sf < 1.0) {\r\n                            let c = (1.0-sf)*100;\r\n                            sailCoverage = -roundTo((1.0-sf)*100, 2);\r\n                            if(aroundV(c,75) || aroundV(c,50))\r\n                            {\r\n                                playerOption.guessOptions |= guessOptionBits[\"winchDetected\"];\r\n                                playerOption.guessOptions &= ~guessOptionBits[\"winch\"];\r\n                            } else if(aroundV(c,30) || aroundV(c,51)) {\r\n                                playerOption.guessOptions |= guessOptionBits[\"winchActivated\"];\r\n                            }                    \r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        xplained = true;\r\n    }\r\n\r\n    metaDash.xplained = xplained\r\n    metaDash.sailCoverage = sailCoverage;\r\n    metaDash.realFoilFactor = realFoilFactor;\r\n    metaDash.xfactor = xfactor;\r\n\r\n    if (latest.twa !== 0) {\r\n        metaDash.twd = latest.twa + latest.hdg;\r\n        if (metaDash.twd < 0) {\r\n            metaDash.twd += 360;\r\n        } else if(metaDash.twd > 360)\r\n            metaDash.twd -=360; \r\n    } else {\r\n        metaDash.twd = 0;\r\n    }\r\n    \r\n    // Ajout - Calcul VMG\r\n    metaDash.vmg = Math.abs(latest.speed * Math.cos(toRad(latest.twa)));\r\n    if(!metaDash.bVmg) metaDash.bVmg = bestVMG(latest.tws, polar, playerOption.options, latest.sail % 10, latest.twa)\r\n  \r\n\r\n    // Ajout - type2 pour tri par catégories\r\n /* \r\n */       \r\n\r\n    if (latest.team) {\r\n        latest.type2 = \"team\";\r\n    } else if (latest.followed || latest.isFollowed) {\r\n        latest.type2 = \"followed\";\r\n    } else {\r\n        latest.type2 = latest.type;  \r\n    }\r\n\r\n    latest.metaDash = metaDash;\r\n\r\n    if(latest.userId == currentPlayerLatest.userId) {\r\n        await saveData('legPlayersInfos', latest,null,{ updateIfExists: true });\r\n        await saveData('legFleetInfos', latest,null,{ updateIfExists: true });\r\n    }\r\n    else\r\n        await saveData('legFleetInfos', latest,null,{ updateIfExists: true });\r\n    \r\n    if(playerOption.guessOptions != playerGuessOptionPrev)\r\n    {\r\n        latest.metaDash = metaDash;\r\n        const playerOptionRaceRecord = {\r\n            raceId : legInfos.raceId,\r\n            legNum : legInfos.legNum,\r\n            userId : latest.userId,\r\n            guessOptions :playerOption.guessOptions,                  \r\n            timestamp : Date.now()\r\n        };\r\n        await saveData('legPlayersOptions', playerOptionRaceRecord,null,{ updateIfExists: true });\r\n    } \r\n}\r\n\r\n  \r\nexport async function computeFleetIte(raceId, legNum) {\r\n\r\n    if(!raceId || !legNum) return;\r\n    const legInfos = await getData('legList', [raceId, legNum]); \r\n    if(!legInfos) return;\r\n    const polar = await getData('polars', legInfos.polar_id);\r\n    if(!polar) return;\r\n    const currentUserId = await getData('internal', 'lastLoggedUser');\r\n    if(!currentUserId) return;\r\n    const { latest, previous, meta1 } = await getLatestAndPreviousByTriplet(raceId, legNum, currentUserId.loggedUser , {storeName: 'legPlayersInfos'});\r\n    \r\n    const currentPlayerIte = latest;\r\n    if(!currentPlayerIte) return;\r\n\r\n\r\n    const now = Date.now();\r\n    const fifteenMinutesAgo = now - 15 * 60 * 1000;\r\n  \r\n    const { items, meta } = await getLatestEntriesPerUser(raceId, legNum, {\r\n      since: fifteenMinutesAgo,\r\n      until: now,\r\n      timeout: 4000,\r\n      storeName: 'legFleetInfos'\r\n    });\r\n    for (const [userId, entry] of Object.entries(items)) {\r\n        const playerOptionRace = (await getData('legPlayersOptions', [raceId, legNum, userId])) ?? {options:[],guessOptions:0};\r\n \r\n        await computeFleetPlayerIte(legInfos, entry,playerOptionRace,currentPlayerIte , polar)\r\n    }\r\n    await saveData('internal', {id: \"legFleetInfosDashUpdate\",ts:Date.now()},null,{ updateIfExists: true });\r\n}\r\n\r\nexport async function computeOwnIte(raceId, legNum, userId)\r\n{\r\n    if(!raceId || !legNum || !userId) return;\r\n    const { latest, previous, meta } = await getLatestAndPreviousByTriplet(raceId, legNum, userId , {storeName: 'legPlayersInfos'});\r\n    if(meta.timedOut || !latest) return;\r\n    const legInfos = await getData('legList', [raceId, legNum]); \r\n\r\n    if(!legInfos ) return;\r\n    const polar = await getData('polars', legInfos.polar_id);\r\n    if(!polar) return;\r\n\r\n    const playerOption = (await getData('legPlayersOptions', [raceId, legNum, userId])) ?? {options:[],guessOptions:0};\r\n    \r\n    const paramStamina = (await getData('internal', 'paramStamina'))?.paramStamina ?? null;\r\n\r\n    const metaDash = latest.metaDash?latest.metaDash:[];\r\n    metaDash.speedT = theoreticalSpeed(polar,playerOption.options,latest?.tws,latest?.twa); \r\n\r\n    if(previous)\r\n    {\r\n        const d = gcDistance(previous.pos, latest.pos);\r\n        const delta = courseAngle(previous.pos.lat, previous.pos.lon, latest.pos.lat, latest.pos.lon);\r\n        const alpha = Math.PI - angle(toRad(previous.hdg), delta);\r\n        const beta = Math.PI - angle(toRad(latest.hdg), delta);\r\n        const gamma = angle(toRad(latest.hdg), toRad(previous.hdg));\r\n        // Epoch timestamps are milliseconds since 00:00:00 UTC on 1 January 1970.\r\n        metaDash.deltaT = (latest.iteDate - previous.iteDate) / 1000;\r\n        if (metaDash.deltaT > 0\r\n            && Math.abs(toDeg(gamma) - 180) > 1\r\n            && toDeg(alpha) > 1\r\n            && toDeg(beta) > 1) {\r\n            metaDash.deltaD = d / Math.sin(gamma) * (Math.sin(beta) + Math.sin(alpha));\r\n        } else {\r\n            metaDash.deltaD = d;\r\n        }\r\n        metaDash.speedC = Math.abs(roundTo(metaDash.deltaD / metaDash.deltaT * 3600, 3));\r\n        // deltaD_T = Delta distance computed from speedT is only displayed when it deviates\r\n        if (metaDash.speedT) {\r\n            metaDash.deltaD_T = metaDash.deltaD / metaDash.speedC * metaDash.speedT.speed;\r\n        }\r\n        metaDash.previousItedate = previous.iteDate;\r\n    }\r\n\r\n    metaDash.bVmg = bestVMG(latest.tws, polar, playerOption.options, latest.sail % 10, latest.twa)\r\n  // Ajout - Calcul COG/VMC\r\n    metaDash.cog = null;\r\n    metaDash.vmc = null;\r\n    if(legInfos.checkpoints) {\r\n        var cp_status = false;\r\n        // Identify the next buoy to pass\r\n        // cp_status = false if all checkpoints are passed or no checkpoints are defined\r\n        for (var i = 0; i < legInfos.checkpoints.length; i++) {\r\n            var cp = legInfos.checkpoints[i];\r\n\r\n            if ((cp.display == \"none\") ||  (latest.gateGroupCounters && latest.gateGroupCounters[cp.group - 1])) {\r\n                continue;\r\n            }\r\n            if ((cp.display != \"none\") ||  (!latest.gateGroupCounters[cp.group - 1])) {\r\n                metaDash.cog = calculateCOGLoxo(latest.pos.lat, latest.pos.lon, cp.start.lat, cp.start.lon);\r\n                metaDash.vmc = latest.speed * Math.cos((latest.hdg - metaDash.cog) * (Math.PI / 180));\r\n                cp_status = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (cp_status == false) {\r\n            // if(cfg.debugIteRun) console.log(\"Finish Gate is at \" + Util.formatPosition(r.legdata.end.lat, r.legdata.end.lon));\r\n            metaDash.cog = calculateCOGLoxo(latest.pos.lat, latest.pos.lon, legInfos.end.lat, legInfos.end.lon);\r\n            metaDash.vmc = latest.speed * Math.cos((latest.hdg - metaDash.cog) * (Math.PI / 180));\r\n        }\r\n    }\r\n\r\n\r\n    metaDash.coffeeBoost = 0;\r\n    metaDash.coffeeExp = Date.now()+24*60*60*1000;\r\n    metaDash.chocoBoost = 0;\r\n    metaDash.chocoExp = Date.now()+24*60*60*1000;\r\n        \r\n    if(latest.stats)\r\n    {\r\n        if(latest.stats.staminaMaxEffects)\r\n            for (const coffee of latest.stats.staminaMaxEffects) {    \r\n                if(coffee.value > 0 && coffee.exp > Date.now())\r\n                {\r\n                    metaDash.coffeeBoost += coffee.value;\r\n                    if(coffee.exp < metaDash.coffeeExp) metaDash.coffeeExp = coffee.exp;\r\n                }\r\n            }\r\n        if(latest.stats.staminaTemp)\r\n            for (const choco of latest.stats.staminaTemp) {    \r\n                if(choco.value > 0 && choco.exp > Date.now())\r\n                {\r\n                    metaDash.chocoBoost += choco.value;\r\n                    if(choco.exp < metaDash.chocoExp) metaDash.chocoExp = choco.exp;\r\n                }\r\n            }\r\n    }\r\n    const maxStamina = 100 + metaDash.coffeeBoost;\r\n    let realStamina = latest.stamina + metaDash.coffeeBoost + metaDash.chocoBoost;\r\n\r\n    metaDash.realStamina = realStamina>maxStamina?maxStamina:realStamina;\r\n\r\n    const pena = manoeuveringPenalities(polar,latest,metaDash.realStamina,playerOption.options);\r\n    const energyLoose = computeEnergyLoose(polar, paramStamina, playerOption.options, latest.tws);\r\n    \r\n    const manoeuver = [];\r\n    manoeuver.gybe = {\r\n            pena : pena.gybe,\r\n            energyLoose : energyLoose.gybe,\r\n            energyRecovery : computeEnergyRecovery(energyLoose.gybe,latest.tws,paramStamina,playerOption.options)\r\n    };\r\n    manoeuver.tack = {\r\n            pena : pena.tack,\r\n            energyLoose : energyLoose.tack,\r\n            energyRecovery : computeEnergyRecovery(energyLoose.tack,latest.tws,paramStamina,playerOption.options)\r\n    };\r\n    manoeuver.sail = {\r\n            pena : pena.sail,\r\n            energyLoose : energyLoose.sail,\r\n            energyRecovery : computeEnergyRecovery(energyLoose.sail,latest.tws,paramStamina,playerOption.options)\r\n    };\r\n    metaDash.manoeuver = manoeuver;\r\n    metaDash.manoeuver.staminaFactor = pena.staminaFactor;\r\n    metaDash.manoeuvering = (latest.tsEndOfSailChange > latest.iteDate)\r\n        || (latest.tsEndOfGybe > latest.iteDate)\r\n        || (latest.tsEndOfTack > latest.iteDate);\r\n    metaDash.receivedTS = Date.now();\r\n\r\n\r\n    metaDash.deltaReceiveCompute = metaDash.receivedTS - latest.iteDate;\r\n\r\n\r\n    metaDash.isAutoSail = latest.hasPermanentAutoSails ||\r\n            (latest.tsEndOfAutoSail &&(latest.tsEndOfAutoSail - latest.lastCalcDate) > 0);\r\n    metaDash.autoSailTime = latest.hasPermanentAutoSails ?\"inf\" : (latest.tsEndOfAutoSail - latest.iteDate)\r\n    latest.metaDash = metaDash;\r\n    \r\n    await computeFleetPlayerIte(legInfos, latest,playerOption,latest , polar);\r\n    \r\n    //await saveData('legPlayersInfos', latest,null,{ updateIfExists: true });\r\n    await saveData('internal', {id: \"legPlayersInfosDashUpdate\",ts:Date.now()},null,{ updateIfExists: true });\r\n \r\n    //await saveData('internal', {id: \"legFleetInfosDashUpdate\",ts:Date.now()},null,{ updateIfExists: true });\r\n    \r\n}\r\n\r\n","import { \r\n    roundTo\r\n} from '../../common/utils.js';\r\nimport {formatHM,formatTimeNotif,infoSail,twaBackGround,getxFactorStyle,formatPosition,getBG} from './common.js'\r\nimport {sailNames} from \"./constant.js\"\r\nimport {getData,getLatestAndPreviousByTriplet} from '../../common/dbOpes.js';\r\n\r\n\r\nimport {getUserPrefs} from '../../common/userPrefs.js'\r\n\r\nlet buildEmbeddedToolbarContent  = {content:\"\",newTab:true,rid:null,theme:\"dark\",rstTimer:false,gameSize:100};\r\n\r\nexport async function buildEmbeddedToolbarHtml(raceId, legNum, connectedPlayerId)\r\n{\r\n\r\n    const userPrefs = getUserPrefs(); \r\n    const rid = raceId+\"-\"+legNum;\r\n\r\n    let embeddedToolbarHeader = '<tr>'\r\n        + '<th title=\"Call Router\">' + \"RT\" + '</th>'\r\n        + '<th title=\"Call Polars\">' + \"PL\" + '</th>'\r\n        + '<th>' + \"Time\" + '</th>'\r\n        + '<th title=\"True Wind Direction\">' + \"TWD\" + '</th>'\r\n        + '<th title=\"True Wind Speed\">' + \"TWS\" + '</th>'\r\n        + '<th title=\"True Wind Angle\">' + \"TWA\" + '</th>'\r\n        + '<th title=\"Heading\">' + \"HDG\" + '</th>'\r\n        + '<th title=\"Boat speed / Speed factor / Foils usage\">' + \"Speed\" + '</th>'\r\n        + '<th title=\"Auto Sail time remaining\">' + \"aSail\" + '</th>' \r\n        + '<th title=\"Boat VMG\">' + \"VMG\" + '</th>'       \r\n        + '<th title=\"Best VMG Up / Down\">' + \"Best VMG\" + '</th>'\r\n        + '<th title=\"Best speed angle (Sail) / Best speed\">' + \"Best speed\" + '</th>'\r\n        + '<th title=\"Stamina\">' + \"Stamina\" + '</th>'\r\n        + '<th title=\"Position\">' + \"Position\" + '</th>';\r\n    if(userPrefs.lang ==  \"fr\") {\r\n        embeddedToolbarHeader += '<th title=\"Temps restant changement de voile\">' + \"Voile\" + '</th>'\r\n            + '<th title=\"Temps restant empannage\">' + \"Emp.\" + '</th>'\r\n            + '<th title=\"Temps restant virement\">' + \"Vir.\" + '</th>';\r\n    } else\r\n    {\r\n        embeddedToolbarHeader += '<th title=\"Time remaining sail change\">' + \"Sail\" + '</th>'\r\n            + '<th title=\"Time remaining tack\">' + \"Tack\" + '</th>'\r\n            + '<th title=\"Time remaining gybe\">' + \"Gybe\" + '</th>';  \r\n    }\r\n\r\n    embeddedToolbarHeader += '</tr>';\r\n    \r\n    let embeddedToolbarLine = await buildEmbeddedToolbarLine(raceId, legNum, connectedPlayerId);\r\n    const embeddedToolBarTable =  '<table id=\"raceStatusTable\">'\r\n                    + '<thead>'\r\n                    + embeddedToolbarHeader\r\n                    + '</thead>'\r\n                    + '<tbody>'\r\n                    + embeddedToolbarLine\r\n                    + '</tbody>'\r\n                    + '</table>';\r\n    \r\n    buildEmbeddedToolbarContent = {\r\n        content:embeddedToolBarTable,\r\n        newTab:userPrefs.global.reuseTab,\r\n        rid:rid,\r\n        theme:userPrefs.theme,\r\n        rstTimer:false,\r\n        gameSize:userPrefs.drawing.fullScreen?userPrefs.drawing.ratio:0 };\r\n}\r\nexport function getbuildEmbeddedToolbarContent()\r\n{\r\n    return buildEmbeddedToolbarContent;\r\n}\r\n\r\nasync function buildEmbeddedToolbarLine(raceId ,legNum,connectedPlayerId)\r\n{\r\n\r\n    let dashState = await getData('internal', 'state'); \r\n    dashState = dashState?.state?dashState.state:'dashInstalled'\r\n    const playerInfo = (connectedPlayerId && connectedPlayerId!=\"\")?(await getData('players', connectedPlayerId)):null;\r\n    const userPrefs = getUserPrefs(); \r\n    let retVal = \"\";\r\n    if(dashState == 'dashInstalled' || !connectedPlayerId || connectedPlayerId==\"\") {\r\n        if(userPrefs.lang ==  \"fr\") {\r\n            retVal =\"<tr><td colspan='17'>❌ Joueur non détecté (<a href='https://www.virtualregatta.com/offshore-game/'>Relancer</a>)</td></tr>\";\r\n        } else {\r\n            retVal =\"<tr><td colspan='17'>❌ Player not detected (<a href='https://www.virtualregatta.com/en/offshore-game/'>Reload</a>)</td></tr>\";    \r\n        }\r\n        return retVal;\r\n    } else if(dashState == 'playerConnected' || !raceId || !legNum) {\r\n        if(userPrefs.lang ==  \"fr\") {\r\n            retVal ='<tr><td colspan=\"17\">❌ Aucune course chargée (Joueur détecté: '+ playerInfo.name +')</td></tr>';\r\n        } else\r\n        {\r\n            retVal ='<tr><td colspan=\"17\">❌ No race loaded (Player detected: '+ playerInfo.name +')</td></tr>';            \r\n        }\r\n        return retVal;\r\n    }\r\n\r\n    \r\n\r\n    const { latest, previous, meta } = await getLatestAndPreviousByTriplet(raceId, legNum, connectedPlayerId , {storeName: 'legPlayersInfos'});\r\n    if(meta.timedOut || !latest) return;\r\n    const raceIte = latest;\r\n    const legInfos = await getData('legList', [raceId, legNum]); \r\n    if(!legInfos || !raceIte || !raceIte.metaDash) return;\r\n\r\n\r\n\r\n    const best = raceIte.metaDash.bVmg;\r\n    \r\n    let bestVMGTxt = \"\";\r\n    let bspeedTxt = \"\";\r\n    if(best)\r\n    {\r\n        bestVMGTxt = \"<div>\" + '\\u2197  ' + best.twaUp + ' ('+sailNames[best.sailUp % 10]+')';\r\n        if(userPrefs.raceData.VMGSpeed)\r\n            bestVMGTxt += ' (' + roundTo(bestTwa.vmgUp, 3) + 'kts )';\r\n        bestVMGTxt += '</div>';\r\n        bestVMGTxt += \"<div>\" + '\\u2198  ' + best.twaDown + ' ('+sailNames[best.sailDown % 10]+')';\r\n        if(userPrefs.raceData.VMGSpeed)\r\n            bestVMGTxt += ' (' + roundTo(Math.abs(best.vmgDown), 3) + 'kts )';\r\n        bestVMGTxt += '</div>';\r\n\r\n        bspeedTxt += \"<div>\" + best.btwa + '° (' + sailNames[best.sailBSpeed % 10]+') </div>';\r\n        bspeedTxt += \"<div>\" + roundTo(best.bspeed, 3) + 'kts</div>';\r\n    }\r\n\r\n    let speedTxtBg = \"\";\r\n    if(raceIte.aground || raceIte.metaDash.manoeuvering)\r\n    {\r\n        speedTxtBg = 'style=\"background-color:' + userPrefs.theme =='dark'?\"darkred\":\"LightRed\" + ';';\r\n    }\r\n\r\n    const xfactorStyle = getxFactorStyle(raceIte);\r\n    let xfactorTxt = roundTo(raceIte.metaDash.xfactor, 4);\r\n    if(raceIte.metaDash.sailCoverage != 0 && raceIte.metaDash.xplained) {\r\n        xfactorTxt += \" \" + raceIte.metaDash.sailCoverage +\"%\";\r\n    }\r\n    let speedTxt = '<div>'+ roundTo(raceIte.speed, 3) + '</div>';\r\n    speedTxt += '<div class=\"xfactor\"' + xfactorStyle + '>' + xfactorTxt + '</div>';\r\n    speedTxt += '<div class=\"foil\">'\r\n    speedTxt += '<img \" class=\"foilImg\" src=\"'+ chrome.runtime.getURL('./img/foil.png') +'\" >'\r\n    speedTxt += raceIte.metaDash.realFoilFactor==null?\"no\":(raceIte.metaDash.realFoilFactor+\"%\");\r\n    speedTxt += '</div>';\r\n\r\n    let lastCalcStyle = \"\"\r\n    if(raceIte.metaDash.deltaReceiveCompute > 900000) {\r\n        lastCalcStyle = 'style=\"background-color: red;'\r\n        lastCalcStyle += (userPrefs.theme =='dark')?' color:black;\"':'\"';\r\n    }\r\n\r\n    const isTWAMode = raceIte.isRegulated;\r\n    const twaFG = (raceIte.twa < 0) ? \"red\" : \"green\";\r\n    const twaBold = isTWAMode ? \"font-weight: bold;\" : \"\";\r\n    let twaBG = \" \";\r\n    if(best)\r\n    {\r\n        twaBG = twaBackGround(raceIte.twa,best);\r\n    }\r\n    \r\n    let hdgFG = isTWAMode ? \"black\" : \"blue\";\r\n    const hdgBold = isTWAMode ? \"font-weight: normal;\" : \"font-weight: bold;\";\r\n    if(userPrefs.theme =='dark')\r\n        hdgFG = isTWAMode ? \"white\" : \"darkcyan\"; \r\n\r\n    let staminaStyle = \"\";\r\n    let staminaTxt = \"-\";\r\n    const stamina = raceIte.metaDash.realStamina;\r\n    const setting = await getData(\"internal\",\"paramStamina\") ;\r\n    const paramStamina = setting?.paramStamina;\r\n    const manoeuver = raceIte.metaDash.manoeuver;\r\n    if(stamina)\r\n    {\r\n        if (stamina < paramStamina?.tiredness[0]) \r\n            staminaStyle = 'style=\"color:red\"';\r\n        else if (stamina < paramStamina?.tiredness[1]) \r\n            staminaStyle = 'style=\"color:orange\"';\r\n        else \r\n            staminaStyle = 'style=\"color:green\"';   \r\n\r\n        staminaTxt = roundTo(stamina , 2) + \"%\";\r\n        staminaTxt += \" (x\" + roundTo(manoeuver.staminaFactor , 2)+\")\" ;\r\n    }\r\n\r\n    let fullStamina = '<td class=\"stamina\" ';\r\n\r\n    if(raceIte.metaDash.coffeeBoost != 0 || raceIte.metaDash.chocoBoost != 0)\r\n    {\r\n        \r\n        fullStamina += '><div class=\"textMini\">';\r\n        if(raceIte.metaDash.chocoBoost != 0) {\r\n            fullStamina += '🍫+'+ roundTo(raceIte.metaDash.chocoBoost, 2)+'%';\r\n            fullStamina += ' ⌚'+ formatHM(raceIte.metaDash.chocoExp-Date.now());\r\n        }\r\n        fullStamina += '</div>';\r\n\r\n        fullStamina += '<div ' + staminaStyle +'>';\r\n        fullStamina += staminaTxt;\r\n        fullStamina += '</div>';\r\n        fullStamina += '<div class=\"textMini\">';\r\n        if(raceIte.metaDash.coffeeBoost != 0) {\r\n            fullStamina += '☕+'+ roundTo(raceIte.metaDash.coffeeBoost, 2)+'%';\r\n            fullStamina += ' ⌚'+ formatHM(raceIte.metaDash.coffeeExp-Date.now());\r\n        }\r\n        fullStamina += '</div>';\r\n        fullStamina += '</td>';\r\n    \r\n        //🍴\r\n    } else\r\n    {\r\n        fullStamina += staminaStyle + '>' + staminaTxt  + '</td>';\r\n    }\r\n\r\n    let sailPenaTxt = '<td class=\"tack\">';\r\n    if(manoeuver?.sail)\r\n        sailPenaTxt += '<div>-' +  manoeuver.sail.pena.dist + 'nm | ' + manoeuver.sail.pena.time + 's</div>'\r\n    else\r\n        sailPenaTxt += '<div>-</div>';\r\n    if(raceIte.tsEndOfSailChange)\r\n        sailPenaTxt += '<div ' + getBG(raceIte.tsEndOfSailChange) + '>' + formatSeconds(raceIte.tsEndOfSailChange - raceIte.iteDate) + '</div>';\r\n    else\r\n        sailPenaTxt += '<div> - </div>';\r\n    sailPenaTxt += '</td>';\r\n    let tackPenaTxt = '<td class=\"tack\">';\r\n    if(manoeuver?.tack)\r\n        tackPenaTxt += '<div>-' +  manoeuver.tack.pena.dist + 'nm | ' + manoeuver.tack.pena.time + 's</div>'\r\n    else\r\n        tackPenaTxt += '<div>-</div>';\r\n    if(raceIte.tsEndOfTack)\r\n        tackPenaTxt += '<div ' + getBG(raceIte.tsEndOfTack) + '>' + formatSeconds(raceIte.tsEndOfTack - raceIte.iteDate) + '</div>';\r\n    else\r\n        tackPenaTxt += '<div> - </div>';\r\n    tackPenaTxt += '</td>';\r\n    let gybePenaTxt = '<td class=\"tack\">';\r\n    if(manoeuver?.tack)\r\n        gybePenaTxt += '<div>-' +  manoeuver.gybe.pena.dist + 'nm | ' + manoeuver.gybe.pena.time + 's</div>'\r\n    else\r\n        gybePenaTxt += '<div>-</div>';\r\n    if(raceIte.tsEndOfGybe)\r\n        gybePenaTxt += '<div ' + getBG(raceIte.tsEndOfGybe) + '>' + formatSeconds(raceIte.tsEndOfGybe - raceIte.iteDate) + '</div>';\r\n    else\r\n        gybePenaTxt += '<div> - </div>';\r\n    gybePenaTxt += '</td>';\r\n    \r\n    const timeLine = '<div>'+formatTimeNotif(raceIte.iteDate)+'</div><div id=\"dashIntegTime\" class=\"textMini\">'+'</div>';\r\n\r\n    const rid = legInfos.id+\"-\"+legInfos.legNum;\r\n    const zezoUrl = null; \r\n    \r\n    retVal = '<tr id=\"rs:' + rid + '\">';\r\n    retVal += '<td class=\"tdc\"><div>';\r\n    retVal += '<span id=\"vrz:' + rid + '\">&#x262F;</span>';\r\n    retVal += '</div><div>';\r\n    retVal += (zezoUrl ? ('<span class=\"zezoIcon\" id=\"rt:' + rid + '\">&#x2388;</span>') : '&nbsp;');\r\n    retVal += '</div></td>';\r\n    retVal += '<td class=\"tdc\"><div>';\r\n    retVal += '<span id=\"pl:' + rid + '\">&#x26F5;</span>';\r\n    retVal += '</div><div>';\r\n    retVal += '<span id=\"ityc:' + rid + '\">&#x2620;</span>';\r\n    retVal += '</div></td>';\r\n\r\n    retVal += '<td class=\"time\" ' + lastCalcStyle + '>' +  timeLine + '</td>'\r\n        + '<td class=\"twd\">' + roundTo(raceIte.twd, 3) + '</td>'\r\n        + '<td class=\"tws\">' + roundTo(raceIte.tws, 3) + '</td>'\r\n        + '<td class=\"twa\" style=\"color:' + twaFG + \";\" + twaBG + twaBold  + '\">' + roundTo(Math.abs(raceIte.twa), 3) + '</td>'\r\n        + '<td  class=\"hdg\" style=\"color:' + hdgFG + \";\" + hdgBold + '\">' + roundTo(raceIte.hdg, 3) + '</td>'\r\n        + '<td class=\"speed1\"'+ speedTxtBg + '>' + speedTxt + '</td>' \r\n        + infoSail(raceIte,true)\r\n        + '<td class=\"speed2\">' + roundTo(raceIte.metaDash.vmg, 3) + '</td>'\r\n        + '<td class=\"bvmg\">' + bestVMGTxt + '</td>'\r\n        + '<td class=\"bspeed\">' + bspeedTxt +'</td>'\r\n        + fullStamina\r\n        + '<td class=\"position\">' + (raceIte.pos ? formatPosition(raceIte.pos.lat, raceIte.pos.lon,true) : \"-\") + '</td>'\r\n        + sailPenaTxt + gybePenaTxt + tackPenaTxt\r\n        + '</tr>';\r\n    return retVal;\r\n    \r\n}","\r\n\r\nimport {getData,saveData} from '../common/dbOpes.js';\r\nexport async function manageDashState(nextState)\r\n{\r\n    const currentDashState = await getData('internal', 'state'); \r\n    let dashState = currentDashState?.state?currentDashState.state:'dashInstalled';\r\n\r\n    if(nextState == 'start') dashState.state = 'dashInstalled';\r\n    else\r\n        switch(dashState)\r\n        {\r\n            case 'dashInstalled' :\r\n                if(nextState == 'playerConnected' || nextState == 'raceOpened')\r\n                    dashState = nextState;\r\n                break;\r\n            case 'playerConnected' :\r\n                if(nextState == 'raceOpened')\r\n                    dashState = nextState;\r\n                break;\r\n            case 'raceOpened':\r\n                if(nextState == 'playerConnected')\r\n                    dashState = nextState;\r\n                break;\r\n        }\r\n    if(currentDashState != dashState)\r\n        await saveData('internal', {id: \"state\",state:dashState},null,{ updateIfExists: true });\r\n         \r\n}","// Copyright (c) 2012 The Chromium Authors. All rights reserved.\r\n// Use of this source code is governed by a BSD-style license that can be\r\n// found in the LICENSE file.\r\n\r\nimport * as msgInjest from './data/msgIngestDef.js';\r\nimport { ensureOffscreen } from './ensureOffscreen.js';\r\nimport { computeOwnIte ,computeFleetIte} from './iteRun.js';\r\nimport {createKeyChangeListener, getData,saveData} from '../common/dbOpes.js';\r\nimport {buildEmbeddedToolbarHtml,getbuildEmbeddedToolbarContent} from '../dashboard/ui/embeddedToolbar.js'\r\nimport {manageDashState} from './dashState.js'\r\n\r\nvar version = \"1.0\";\r\nvar debuggeeTab;\r\nvar dashboardTab;\r\n\r\nconst pending = new Map();\r\n\r\nsaveData('internal',{id:'state',state:'dashInstalled'});\r\n\r\nchrome.runtime.onMessage.addListener((msg, _sender, _sendResponse) => {\r\n  if (msg?.target !== 'bg') return;\r\n\r\n  if (msg.type === 'job:done' && pending.has(msg.id)) {\r\n    pending.get(msg.id).resolve(msg.summary); // petit récap, pas le gros buffer\r\n    pending.delete(msg.id);\r\n  }\r\n  if (msg.type === 'job:error' && pending.has(msg.id)) {\r\n    pending.get(msg.id).reject(new Error(msg.error || 'Offscreen/Worker error'));\r\n    pending.delete(msg.id);\r\n  }\r\n});\r\n\r\nexport async function runHeavyJob(descriptor) {\r\n  await ensureOffscreen();\r\n\r\n  const id = crypto.randomUUID();\r\n  const resP = new Promise((resolve, reject) => pending.set(id, { resolve, reject }));\r\n\r\n  // On envoie un descripteur léger (ex: { source: 'fetch', url: ... } ou { source: 'idb', key: ... })\r\n  await chrome.runtime.sendMessage({\r\n    target: 'offscreen',\r\n    type: 'job:start',\r\n    id,\r\n    descriptor\r\n  });\r\n\r\n  return resP;\r\n}\r\n\r\nchrome.action.onClicked.addListener( onStartDash );\r\nfunction onStartDash (tab) {\r\n    if (tab && tab.url.indexOf('virtualregatta.com') >= 0) {\r\n        debuggeeTab = tab;\r\n        onAttach(tab.id);\r\n    }\r\n}\r\nfunction autoReloadTab(tabs) {\r\n    tabs.forEach(tab => {\r\n        if (tab.url.indexOf(chrome.runtime.id+\"/dashboard.html\") >= 0) {     \r\n            dashboardTab = tab;\r\n            chrome.tabs.reload(tab.id);\r\n            console.log(\"autoreload: \" + tab.id + \" \" + tab.url);\r\n        }\r\n    });\r\n\r\n}\r\n\r\nchrome.tabs.onUpdated.addListener( checkForValidUrl );\r\nchrome.tabs.onActivated.addListener( function (activeInfo) {\r\n    chrome.tabs.get(activeInfo.tabId, function (tab) {\r\n        checkForValidUrl(activeInfo.tabId,null,tab);\r\n    });\r\n});\r\nfunction checkForValidUrl (tabId, changeInfo, tabInfo) {\r\n\r\n    try {\r\n        if (tabInfo && tabInfo.url.indexOf('virtualregatta.com') >= 0) {\r\n            if(!debuggeeTab) {\r\n                debuggeeTab = tabInfo;\r\n            }       \r\n            if(!dashboardTab) //may the browser has been closed with dash tab open \r\n            {\r\n                chrome.tabs.query({}).then(autoReloadTab);\r\n            }\r\n        }\r\n    } catch (e) {\r\n        console.log(\"Tab is gone: \" + tabId);\r\n    }\r\n};\r\n\r\n\r\nchrome.tabs.onRemoved.addListener( onTabRemoved );\r\nfunction onTabRemoved (tabId, removeInfo) {\r\n    if ( debuggeeTab && (tabId == debuggeeTab.id) ) {\r\n        try {\r\n            debuggeeTab = undefined;\r\n            \r\n            if(dashboardTab) chrome.tabs.remove(dashboardTab.id);\r\n            dashboardTab = undefined;\r\n        } catch (e) {\r\n            console.log(JSON.stringify(e));\r\n        }\r\n    } else if ( dashboardTab && (tabId == dashboardTab.id) ) {\r\n        dashboardTab = undefined;\r\n    }\r\n}\r\n\r\nfunction onAttach (tabId) {\r\n    if (chrome.runtime.lastError) {\r\n        alert(chrome.runtime.lastError.message);\r\n    } else {\r\n        if(!dashboardTab)\r\n            chrome.tabs.create({url: \"dashboard.html?\" + tabId, active: false},\r\n                            function (tab) {\r\n                                dashboardTab = tab;\r\n                            });\r\n    }\r\n}\r\n\r\n\r\n\r\nchrome.declarativeContent.onPageChanged.removeRules(async () => {\r\n    chrome.declarativeContent.onPageChanged.addRules([{\r\n      conditions: [\r\n        new chrome.declarativeContent.PageStateMatcher({\r\n          pageUrl: { hostPrefix: 'www.virtualregatta.',pathContains: '/offshore-' },\r\n        }),\r\n      ],\r\n      actions: [\r\n        new chrome.declarativeContent.SetIcon({\r\n          imageData: {\r\n            128: await loadImageData('icon.png')\r\n          },\r\n        }),\r\n        chrome.declarativeContent.ShowAction\r\n          ? new chrome.declarativeContent.ShowAction()\r\n          : new chrome.declarativeContent.ShowPageAction(),\r\n      ],\r\n    }]);\r\n  });\r\n  \r\n  async function loadImageData(url) {\r\n    const img = await createImageBitmap(await (await fetch(chrome.runtime.getURL(url))).blob());\r\n    const {width: w, height: h} = img;\r\n    const canvas = new OffscreenCanvas(w, h);\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.drawImage(img, 0, 0, w, h);\r\n    return ctx.getImageData(0, 0, w, h);\r\n  }\r\n  \r\nchrome.runtime.onInstalled.addListener(async ({ reason }) => {\r\n    if (reason === chrome.runtime.OnInstalledReason.INSTALL) {\r\n        try { const panelWindowInfo = chrome.windows.create({\r\n            url: chrome.runtime.getURL(\"popup.html\"),\r\n            type:\"popup\",\r\n            height: 150,\r\n            width: 300, });\r\n        } catch (error) { console.log(error); }\r\n    }\r\n  });\r\n\r\n  /*to listen from VR page in bg future usage*/\r\n  /*\r\n  chrome.runtime.onMessageExternal.addListener(\r\n    function(request, sender, sendResponse) {\r\n        var msg = request;\r\n        let rstTimer = false;\r\n        let sendResp = true;\r\n        console.log(\"bg R \" + msg.type);\r\n        void chrome.runtime.getPlatformInfo();\r\n        sendResponse({type:\"alive\",rstTimer:false});\r\n    }\r\n);\r\n\r\nchrome.runtime.onMessage.addListener(\r\n    function(request, sender, sendResponse) {\r\n        var msg = request;\r\n        let rstTimer = false;\r\n        let sendResp = true;\r\n        console.log(\"bg2 R \" + msg.type);\r\n        void chrome.runtime.getPlatformInfo();\r\n        sendResponse({type:\"alive\",rstTimer:false});\r\n    }\r\n);*/\r\n  \r\nchrome.runtime.onMessage.addListener((msg, sender, sendResponse) => {\r\n    let sendResp = false;\r\n    console.log(\"bg R2 \" + msg.type);\r\n\r\n    sendResponse({type:\"alive\",rstTimer:false,gameSize:80});\r\n \r\n\r\n  });\r\n  chrome.runtime.onMessageExternal.addListener(\r\n    async function(request, sender, sendResponse) {\r\n        var msg = request;\r\n        let rstTimer = false;\r\n        let sendResp = true;\r\n        console.log(\"bg R \" + msg.type);\r\n        if(msg.type==\"data\") {\r\n            if(msg.req.Accept) {sendResponse({type:\"dummy\"}); return;}  //json ranking request not supported\r\n            var postData = JSON.parse(msg.req);\r\n            var eventClass = postData['@class'];\r\n            var body = JSON.parse(msg.resp.replace(/\\bNaN\\b|\\bInfinity\\b/g, \"null\"));\r\n            if (eventClass == 'AccountDetailsRequest') {\r\n                await msgInjest.ingestAccountDetails(body);\r\n            }  else if (eventClass == 'LogEventRequest') {\r\n                var eventKey = postData.eventKey;\r\n                if (eventKey == 'Leg_GetList') {\r\n                    await msgInjest.ingestRaceList(body);\r\n                } else if (eventKey == 'Game_EndLegPrep') {\r\n                    await msgInjest.ingestEndLegPrep(body);\r\n//                } else if (eventKey == 'Meta_GetPolar') {\r\n//                    msgInjest.ingestPolars(body);\r\n                } else if (eventKey == \"Game_GetSettings\") {\r\n                    await msgInjest.ingestGameSetting(body);\r\n                } else if (eventKey == \"Race_SelectorData\") {\r\n                    await msgInjest.ingestPolars(body);\r\n                } else if (eventKey == \"Game_AddBoatAction\") {\r\n                    await msgInjest.ingestBoatAction(body);\r\n                }  \r\n                 \r\n\r\n                \r\n                /*\r\n  const sum = await runHeavyJob({\r\n    source: 'fetch',\r\n    url: 'https://example.com/huge-binary.bin', // Exemple: l’offscreen/worker fera le fetch lui-même\r\n    op: 'sumModulo10'\r\n  });\r\n  console.log('[SW] job summary:', sum);\r\n\r\n                */\r\n            }\r\n            else {\r\n                let event = msg.url.substring(msg.url.lastIndexOf('/') + 1);\r\n                if (event == 'getboatinfos') {\r\n                    const ret = await msgInjest.ingestBoatInfos(body);\r\n                    rstTimer = ret.rstTimer;\r\n                } else  if (event == 'getfleet') {\r\n                    await msgInjest.ingestFleetData(postData,body);\r\n                }\r\n            }\r\n\r\n            sendResp = false;\r\n        }\r\n\r\n        void chrome.runtime.getPlatformInfo();\r\n        const embeddedToolbar = getbuildEmbeddedToolbarContent();\r\n        embeddedToolbar.rstTimer =rstTimer;\r\n        sendResponse({...embeddedToolbar, type: \"update\" });\r\n    }\r\n);\r\nconst dashStateInfosListener = createKeyChangeListener('internal', 'state');\r\ndashStateInfosListener.start({\r\n    referenceValue: {state : \"\"},\r\n    onChange: async ( { oldValue, newValue }) => {\r\n        const currentId = await getData('internal', 'lastLoggedUser');\r\n        const currentRace = await getData('internal', 'lastOpennedRace');\r\n        \r\n        console.log(`cid  ${currentId} race ${currentRace}`)\r\n        await buildEmbeddedToolbarHtml(currentRace.raceId, currentRace.legNum, currentId.loggedUser);\r\n    }\r\n});\r\nconst legPlayersInfosListener = createKeyChangeListener('internal', 'legPlayersInfosUpdate');\r\nlegPlayersInfosListener.start({\r\n    referenceValue: {loggedUser : Date.now()},\r\n    onChange: async ( { oldValue, newValue }) => {\r\n        const currentId = await getData('internal', 'lastLoggedUser');\r\n        const currentRace = await getData('internal', 'lastOpennedRace');\r\n        if(!currentId || !currentRace) return;\r\n        await manageDashState('raceOpened');\r\n        await computeOwnIte(currentRace.raceId, currentRace.legNum, currentId.loggedUser);\r\n        await buildEmbeddedToolbarHtml(currentRace.raceId, currentRace.legNum, currentId.loggedUser);\r\n    }\r\n});\r\n\r\n\r\nconst legFleetInfosListener = createKeyChangeListener('internal', 'legFleetInfosUpdate');\r\nlegFleetInfosListener.start({\r\n    referenceValue: {loggedUser : Date.now()},\r\n    onChange: async ( { oldValue, newValue }) => {\r\n        const currentRace = await getData('internal', 'lastOpennedRace');\r\n        if(!currentRace) return;\r\n        await manageDashState('raceOpened');\r\n        await computeFleetIte(currentRace.raceId, currentRace.legNum);\r\n    }\r\n});\r\n\r\nconst connectedUserListener = createKeyChangeListener('internal', 'lastLoggedUser');\r\nconnectedUserListener.start({\r\n    referenceValue: {loggedUser : null},\r\n    onChange: async ({ oldValue, newValue }) => {\r\n        if(newValue.loggedUser) {\r\n            const currentRace = await getData('internal', 'lastOpennedRace');\r\n            await manageDashState('playerConnected');\r\n        await buildEmbeddedToolbarHtml(currentRace.raceId, currentRace.legNum, newValue.loggedUser); \r\n        }\r\n    }\r\n});\r\nconst connectedRaceListener = createKeyChangeListener('internal', 'lastOpennedRace');\r\nconnectedRaceListener.start({\r\n    referenceValue: {raceId: null,legNum: null},\r\n    onChange: async ({ oldValue, newValue }) => {\r\n        const currentId = await getData('internal', 'lastLoggedUser');\r\n        await manageDashState('raceOpened');\r\n        await buildEmbeddedToolbarHtml(newValue.raceId, newValue.legNum,  currentId.loggedUser); \r\n    },\r\n});"],"names":["toposortModule","i","value","result","getter","forEach","date","split","toposort","normalizePath","join","camelCase","snakeCase","Yup.object","Yup.string","Yup.number","Yup.boolean","Yup\r\n      .array","Yup\r\n      .object","Yup.array","Yup.mixed","Yup.ValidationError","Yup\r\n    .object","Yup\r\n        .array","maxSpeed","speed","options","fraction","msgInjest.ingestAccountDetails","msgInjest.ingestRaceList","msgInjest.ingestEndLegPrep","msgInjest.ingestGameSetting","msgInjest.ingestPolars","msgInjest.ingestBoatAction","msgInjest.ingestBoatInfos","msgInjest.ingestFleetData"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}