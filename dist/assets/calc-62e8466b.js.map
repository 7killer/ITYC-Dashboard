{"version":3,"file":"calc-62e8466b.js","sources":["../src/workers/calc.js"],"sourcesContent":["let port; // MessagePort dédié\r\n\r\nself.onmessage = (e) => {\r\n  const { data, ports } = e;\r\n  if (data?.type === 'initPort' && ports && ports[0]) {\r\n    port = ports[0];\r\n    port.onmessage = onPortMessage;\r\n    port.start();\r\n  }\r\n};\r\n\r\nfunction onPortMessage(evt) {\r\n  const { id, op, payload } = evt.data || {};\r\n\r\n  try {\r\n    if (!(payload instanceof ArrayBuffer)) {\r\n      throw new Error('payload must be ArrayBuffer');\r\n    }\r\n\r\n    // Exemple de “gros” calcul\r\n    const view = new Uint8Array(payload);\r\n    let sum = 0;\r\n    for (let i = 0; i < view.length; i++) {\r\n      sum = (sum + (view[i] % 10)) >>> 0;\r\n    }\r\n\r\n    // Résumé renvoyé (léger). Le payload d’origine a été TRANSFÉRÉ (perdu côté offscreen).\r\n    port.postMessage({ type: 'result', id, summary: { op, bytes: view.length, sum } });\r\n  } catch (err) {\r\n    port.postMessage({ type: 'error', id, error: String(err?.message || err) });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;AAAA,MAAI;AAEJ,OAAK,YAAY,CAAC,MAAM;AACtB,UAAM,EAAE,MAAM,MAAO,IAAG;AACxB,SAAI,6BAAM,UAAS,cAAc,SAAS,MAAM,CAAC,GAAG;AAClD,aAAO,MAAM,CAAC;AACd,WAAK,YAAY;AACjB,WAAK,MAAK;AAAA,IACX;AAAA,EACH;AAEA,WAAS,cAAc,KAAK;AAC1B,UAAM,EAAE,IAAI,IAAI,QAAS,IAAG,IAAI,QAAQ;AAExC,QAAI;AACF,UAAI,EAAE,mBAAmB,cAAc;AACrC,cAAM,IAAI,MAAM,6BAA6B;AAAA,MAC9C;AAGD,YAAM,OAAO,IAAI,WAAW,OAAO;AACnC,UAAI,MAAM;AACV,eAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACpC,cAAO,MAAO,KAAK,CAAC,IAAI,OAAS;AAAA,MAClC;AAGD,WAAK,YAAY,EAAE,MAAM,UAAU,IAAI,SAAS,EAAE,IAAI,OAAO,KAAK,QAAQ,IAAG,EAAI,CAAA;AAAA,IAClF,SAAQ,KAAK;AACZ,WAAK,YAAY,EAAE,MAAM,SAAS,IAAI,OAAO,QAAO,2BAAK,YAAW,GAAG,EAAG,CAAA;AAAA,IAC3E;AAAA,EACH;;"}